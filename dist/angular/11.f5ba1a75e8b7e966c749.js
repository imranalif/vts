(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{Bn1M:function(t,e){!function(t){function e(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(i){if("default"!==i){var o=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,o.get?o:{enumerable:!0,get:function(){return t[i]}})}})),e.default=t,e}var i=e(t);function o(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function s(t,e){return i.Util.extend(e,t.geocodingQueryParams)}function n(t,e){return i.Util.extend(e,t.reverseQueryParams)}var r=0,a=/[&<>"'`]/g,c=/[&<>"'`]/,l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};function u(t){return l[t]}function h(t,e,o,s,n){var a="_l_geocoder_"+r++;e[n||"callback"]=a,window[a]=i.Util.bind(o,s);var c=document.createElement("script");c.type="text/javascript",c.src=t+d(e),c.id=a,document.getElementsByTagName("head")[0].appendChild(c)}function p(t,e,i){var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4===o.readyState){var t;if(200!==o.status&&304!==o.status)t="";else if("string"==typeof o.response)try{t=JSON.parse(o.response)}catch(e){t=o.response}else t=o.response;i(t)}},o.open("GET",t+d(e),!0),o.responseType="json",o.setRequestHeader("Accept","application/json"),o.send(null)}function d(t,e,i){var o=[];for(var s in t){var n=encodeURIComponent(i?s.toUpperCase():s),r=t[s];if(Array.isArray(r))for(var a=0;a<r.length;a++)o.push(n+"="+encodeURIComponent(r[a]));else o.push(n+"="+encodeURIComponent(String(r)))}return(e&&-1!==e.indexOf("?")?"&":"?")+o.join("&")}var m=function(){function t(t){this.options={serviceUrl:"https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer",apiKey:""},i.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){var n=s(this.options,{token:this.options.apiKey,SingleLine:t,outFields:"Addr_Type",forStorage:!1,maxLocations:10,f:"json"});p(this.options.serviceUrl+"/findAddressCandidates",n,(function(t){var s=[];if(t.candidates&&t.candidates.length)for(var n=0;n<=t.candidates.length-1;n++){var r=t.candidates[n],a=i.latLng(r.location.y,r.location.x),c=i.latLngBounds(i.latLng(r.extent.ymax,r.extent.xmax),i.latLng(r.extent.ymin,r.extent.xmin));s[n]={name:r.address,bbox:c,center:a}}e.call(o,s)}))},e.suggest=function(t,e,i){return this.geocode(t,e,i)},e.reverse=function(t,e,o,s){var r=n(this.options,{location:t.lng+","+t.lat,distance:100,f:"json"});p(this.options.serviceUrl+"/reverseGeocode",r,(function(t){var e=[];if(t&&!t.error){var n=i.latLng(t.location.y,t.location.x),r=i.latLngBounds(n,n);e.push({name:t.address.Match_addr,center:n,bbox:r})}o.call(s,e)}))},t}(),f=function(){function t(t){this.options={serviceUrl:"https://dev.virtualearth.net/REST/v1/Locations"},i.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){var n=s(this.options,{query:t,key:this.options.apiKey});h(this.options.apiKey,n,(function(t){var s=[];if(t.resourceSets.length>0)for(var n=t.resourceSets[0].resources.length-1;n>=0;n--){var r=t.resourceSets[0].resources[n],a=r.bbox;s[n]={name:r.name,bbox:i.latLngBounds([a[0],a[1]],[a[2],a[3]]),center:i.latLng(r.point.coordinates)}}e.call(o,s)}),this,"jsonp")},e.reverse=function(t,e,o,s){var r=n(this.options,{key:this.options.apiKey});h(this.options.serviceUrl+t.lat+","+t.lng,r,(function(t){for(var e=[],n=t.resourceSets[0].resources.length-1;n>=0;n--){var r=t.resourceSets[0].resources[n],a=r.bbox;e[n]={name:r.name,bbox:i.latLngBounds([a[0],a[1]],[a[2],a[3]]),center:i.latLng(r.point.coordinates)}}o.call(s,e)}),this,"jsonp")},t}(),g=function(){function t(t){this.options={serviceUrl:"https://maps.googleapis.com/maps/api/geocode/json"},i.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){var n=s(this.options,{key:this.options.apiKey,address:t});p(this.options.serviceUrl,n,(function(t){var s=[];if(t.results&&t.results.length)for(var n=0;n<=t.results.length-1;n++){var r=t.results[n],a=i.latLng(r.geometry.location),c=i.latLngBounds(i.latLng(r.geometry.viewport.northeast),i.latLng(r.geometry.viewport.southwest));s[n]={name:r.formatted_address,bbox:c,center:a,properties:r.address_components}}e.call(o,s)}))},e.reverse=function(t,e,o,s){var r=n(this.options,{key:this.options.apiKey,latlng:t.lat+","+t.lng});p(this.options.serviceUrl,r,(function(t){var e=[];if(t.results&&t.results.length)for(var n=0;n<=t.results.length-1;n++){var r=t.results[n],a=i.latLng(r.geometry.location),c=i.latLngBounds(i.latLng(r.geometry.viewport.northeast),i.latLng(r.geometry.viewport.southwest));e[n]={name:r.formatted_address,bbox:c,center:a,properties:r.address_components}}o.call(s,e)}))},t}(),v=function(){function t(t){if(this.options={serviceUrl:"https://geocoder.api.here.com/6.2/",app_id:"",app_code:"",apiKey:"",maxResults:5},i.Util.setOptions(this,t),t.apiKey)throw Error("apiKey is not supported, use app_id/app_code instead!")}var e=t.prototype;return e.geocode=function(t,e,i){var o=s(this.options,{searchtext:t,gen:9,app_id:this.options.app_id,app_code:this.options.app_code,jsonattributes:1,maxresults:this.options.maxResults});this.getJSON(this.options.serviceUrl+"geocode.json",o,e,i)},e.reverse=function(t,e,i,o){var s=t.lat+","+t.lng;this.options.reverseGeocodeProxRadius&&(s+=","+this.options.reverseGeocodeProxRadius);var r=n(this.options,{prox:s,mode:"retrieveAddresses",app_id:this.options.app_id,app_code:this.options.app_code,gen:9,jsonattributes:1,maxresults:this.options.maxResults});this.getJSON(this.options.serviceUrl+"reversegeocode.json",r,i,o)},e.getJSON=function(t,e,o,s){p(t,e,(function(t){var e=[];if(t.response.view&&t.response.view.length)for(var n=0;n<=t.response.view[0].result.length-1;n++){var r=t.response.view[0].result[n].location,a=i.latLng(r.displayPosition.latitude,r.displayPosition.longitude),c=i.latLngBounds(i.latLng(r.mapView.topLeft.latitude,r.mapView.topLeft.longitude),i.latLng(r.mapView.bottomRight.latitude,r.mapView.bottomRight.longitude));e[n]={name:r.address.label,properties:r.address,bbox:c,center:a}}o.call(s,e)}))},t}(),y=function(){function t(t){this.options={serviceUrl:"https://geocode.search.hereapi.com/v1",apiKey:"",app_id:"",app_code:"",maxResults:10},i.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,i){var o=s(this.options,{q:t,apiKey:this.options.apiKey,limit:this.options.maxResults});if(!o.at&&!o.in)throw Error("at / in parameters not found. Please define coordinates (at=latitude,longitude) or other (in) in your geocodingQueryParams.");this.getJSON(this.options.serviceUrl+"/discover",o,e,i)},e.reverse=function(t,e,i,o){var s=n(this.options,{at:t.lat+","+t.lng,limit:this.options.reverseGeocodeProxRadius,apiKey:this.options.apiKey});this.getJSON(this.options.serviceUrl+"/revgeocode",s,i,o)},e.getJSON=function(t,e,o,s){p(t,e,(function(t){var e=[];if(t.items&&t.items.length)for(var n=0;n<=t.items.length-1;n++){var r,a=t.items[n],c=i.latLng(a.position.lat,a.position.lng);r=a.mapView?i.latLngBounds(i.latLng(a.mapView.south,a.mapView.west),i.latLng(a.mapView.north,a.mapView.east)):i.latLngBounds(i.latLng(a.position.lat,a.position.lng),i.latLng(a.position.lat,a.position.lng)),e[n]={name:a.address.label,properties:a.address,bbox:r,center:c}}o.call(s,e)}))},t}();function b(t){var e;return(e=t.match(/^([NS])\s*(\d{1,3}(?:\.\d*)?)\W*([EW])\s*(\d{1,3}(?:\.\d*)?)$/))?i.latLng((/N/i.test(e[1])?1:-1)*+e[2],(/E/i.test(e[3])?1:-1)*+e[4]):(e=t.match(/^(\d{1,3}(?:\.\d*)?)\s*([NS])\W*(\d{1,3}(?:\.\d*)?)\s*([EW])$/))?i.latLng((/N/i.test(e[2])?1:-1)*+e[1],(/E/i.test(e[4])?1:-1)*+e[3]):(e=t.match(/^([NS])\s*(\d{1,3})\xb0?\s*(\d{1,3}(?:\.\d*)?)?['\u2032]?\W*([EW])\s*(\d{1,3})\xb0?\s*(\d{1,3}(?:\.\d*)?)?['\u2032]?$/))?i.latLng((/N/i.test(e[1])?1:-1)*(+e[2]+ +e[3]/60),(/E/i.test(e[4])?1:-1)*(+e[5]+ +e[6]/60)):(e=t.match(/^(\d{1,3})\xb0?\s*(\d{1,3}(?:\.\d*)?)?['\u2032]?\s*([NS])\W*(\d{1,3})\xb0?\s*(\d{1,3}(?:\.\d*)?)?['\u2032]?\s*([EW])$/))?i.latLng((/N/i.test(e[3])?1:-1)*(+e[1]+ +e[2]/60),(/E/i.test(e[6])?1:-1)*(+e[4]+ +e[5]/60)):(e=t.match(/^([NS])\s*(\d{1,3})\xb0?\s*(\d{1,2})['\u2032]?\s*(\d{1,3}(?:\.\d*)?)?["\u2033]?\W*([EW])\s*(\d{1,3})\xb0?\s*(\d{1,2})['\u2032]?\s*(\d{1,3}(?:\.\d*)?)?["\u2033]?$/))?i.latLng((/N/i.test(e[1])?1:-1)*(+e[2]+ +e[3]/60+ +e[4]/3600),(/E/i.test(e[5])?1:-1)*(+e[6]+ +e[7]/60+ +e[8]/3600)):(e=t.match(/^(\d{1,3})\xb0?\s*(\d{1,2})['\u2032]?\s*(\d{1,3}(?:\.\d*)?)?["\u2033]\s*([NS])\W*(\d{1,3})\xb0?\s*(\d{1,2})['\u2032]?\s*(\d{1,3}(?:\.\d*)?)?["\u2033]?\s*([EW])$/))?i.latLng((/N/i.test(e[4])?1:-1)*(+e[1]+ +e[2]/60+ +e[3]/3600),(/E/i.test(e[8])?1:-1)*(+e[5]+ +e[6]/60+ +e[7]/3600)):(e=t.match(/^\s*([+-]?\d+(?:\.\d*)?)\s*[\s,]\s*([+-]?\d+(?:\.\d*)?)\s*$/))?i.latLng(+e[1],+e[2]):void 0}var _=function(){function t(t){this.options={next:void 0,sizeInMeters:1e4},i.Util.setOptions(this,t)}return t.prototype.geocode=function(t,e,i){var o=b(t);if(o){var s=[{name:t,center:o,bbox:o.toBounds(this.options.sizeInMeters)}];e.call(i,s)}else this.options.next&&this.options.next.geocode(t,e,i)},t}(),x=function(){function t(t){this.options={serviceUrl:"https://api.mapbox.com/geocoding/v5/mapbox.places/"},i.Util.setOptions(this,t)}var e=t.prototype;return e._getProperties=function(t){for(var e={text:t.text,address:t.address},i=0;i<(t.context||[]).length;i++)e[t.context[i].id.split(".")[0]]=t.context[i].text,t.context[i].short_code&&(e.countryShortCode=t.context[i].short_code);return e},e.geocode=function(t,e,o){var n=this,r=s(this.options,{access_token:this.options.apiKey});void 0!==r.proximity&&void 0!==r.proximity.lat&&void 0!==r.proximity.lng&&(r.proximity=r.proximity.lng+","+r.proximity.lat),p(this.options.serviceUrl+encodeURIComponent(t)+".json",r,(function(t){var s=[];if(t.features&&t.features.length)for(var r=0;r<=t.features.length-1;r++){var a,c=t.features[r],l=i.latLng(c.center.reverse());a=c.bbox?i.latLngBounds(i.latLng(c.bbox.slice(0,2).reverse()),i.latLng(c.bbox.slice(2,4).reverse())):i.latLngBounds(l,l),s[r]={name:c.place_name,bbox:a,center:l,properties:n._getProperties(c)}}e.call(o,s)}))},e.suggest=function(t,e,i){return this.geocode(t,e,i)},e.reverse=function(t,e,o,s){var r=this;p(this.options.serviceUrl+t.lng+","+t.lat+".json",n(this.options,{access_token:this.options.apiKey}),(function(t){var e=[];if(t.features&&t.features.length)for(var n=0;n<=t.features.length-1;n++){var a,c=t.features[n],l=i.latLng(c.center.reverse());a=c.bbox?i.latLngBounds(i.latLng(c.bbox.slice(0,2).reverse()),i.latLng(c.bbox.slice(2,4).reverse())):i.latLngBounds(l,l),e[n]={name:c.place_name,bbox:a,center:l,properties:r._getProperties(c)}}o.call(s,e)}))},t}(),L=function(){function t(t){this.options={serviceUrl:"https://www.mapquestapi.com/geocoding/v1"},i.Util.setOptions(this,t),this.options.apiKey=decodeURIComponent(this.options.apiKey)}var e=t.prototype;return e._formatName=function(){return[].slice.call(arguments).filter((function(t){return!!t})).join(", ")},e.geocode=function(t,e,o){var n=s(this.options,{key:this.options.apiKey,location:t,limit:5,outFormat:"json"});p(this.options.serviceUrl+"/address",n,i.Util.bind((function(t){var s=[];if(t.results&&t.results[0].locations)for(var n=t.results[0].locations.length-1;n>=0;n--){var r=t.results[0].locations[n],a=i.latLng(r.latLng);s[n]={name:this._formatName(r.street,r.adminArea4,r.adminArea3,r.adminArea1),bbox:i.latLngBounds(a,a),center:a}}e.call(o,s)}),this))},e.reverse=function(t,e,o,s){var r=n(this.options,{key:this.options.apiKey,location:t.lat+","+t.lng,outputFormat:"json"});p(this.options.serviceUrl+"/reverse",r,i.Util.bind((function(t){var e=[];if(t.results&&t.results[0].locations)for(var n=t.results[0].locations.length-1;n>=0;n--){var r=t.results[0].locations[n],a=i.latLng(r.latLng);e[n]={name:this._formatName(r.street,r.adminArea4,r.adminArea3,r.adminArea1),bbox:i.latLngBounds(a,a),center:a}}o.call(s,e)}),this))},t}(),C=function(){function t(t){this.options={userId:void 0,apiKey:void 0,serviceUrl:"https://neutrinoapi.com/"},i.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){var n=s(this.options,{apiKey:this.options.apiKey,userId:this.options.userId,address:t.split(/\s+/).join(".")});p(this.options.serviceUrl+"geocode-address",n,(function(t){var s=[];if(t.locations){t.geometry=t.locations[0];var n=i.latLng(t.geometry.latitude,t.geometry.longitude),r=i.latLngBounds(n,n);s[0]={name:t.geometry.address,bbox:r,center:n}}e.call(o,s)}))},e.suggest=function(t,e,i){return this.geocode(t,e,i)},e.reverse=function(t,e,o,s){var r=n(this.options,{apiKey:this.options.apiKey,userId:this.options.userId,latitude:t.lat,longitude:t.lng});p(this.options.serviceUrl+"geocode-reverse",r,(function(e){var n=[];if(200==e.status.status&&e.found){var r=i.latLng(t.lat,t.lng),a=i.latLngBounds(r,r);n[0]={name:e.address,bbox:a,center:r}}o.call(s,n)}))},t}(),S=function(){function t(t){this.options={serviceUrl:"https://nominatim.openstreetmap.org/",htmlTemplate:function(t){var e,i,o=t.address,s=[];return(o.road||o.building)&&s.push("{building} {road} {house_number}"),(o.city||o.town||o.village||o.hamlet)&&s.push('<span class="'+(s.length>0?"leaflet-control-geocoder-address-detail":"")+'">{postcode} {city} {town} {village} {hamlet}</span>'),(o.state||o.country)&&s.push('<span class="'+(s.length>0?"leaflet-control-geocoder-address-context":"")+'">{state} {country}</span>'),e=s.join("<br/>"),i=o,e.replace(/\{ *([\w_]+) *\}/g,(function(t,e){var o,s=i[e];return void 0===s?s="":"function"==typeof s&&(s=s(i)),null==(o=s)?"":o?c.test(o=""+o)?o.replace(a,u):o:o+""}))}},i.Util.setOptions(this,t||{})}var e=t.prototype;return e.geocode=function(t,e,o){var n=this,r=s(this.options,{q:t,limit:5,format:"json",addressdetails:1});p(this.options.serviceUrl+"search",r,(function(t){for(var s=[],r=t.length-1;r>=0;r--){for(var a=t[r].boundingbox,c=0;c<4;c++)a[c]=+a[c];s[r]={icon:t[r].icon,name:t[r].display_name,html:n.options.htmlTemplate?n.options.htmlTemplate(t[r]):void 0,bbox:i.latLngBounds([a[0],a[2]],[a[1],a[3]]),center:i.latLng(t[r].lat,t[r].lon),properties:t[r]}}e.call(o,s)}))},e.reverse=function(t,e,o,s){var r=this,a=n(this.options,{lat:t.lat,lon:t.lng,zoom:Math.round(Math.log(e/256)/Math.log(2)),addressdetails:1,format:"json"});p(this.options.serviceUrl+"reverse",a,(function(t){var e=[];if(t&&t.lat&&t.lon){var n=i.latLng(t.lat,t.lon),a=i.latLngBounds(n,n);e.push({name:t.display_name,html:r.options.htmlTemplate?r.options.htmlTemplate(t):void 0,center:n,bbox:a,properties:t})}o.call(s,e)}))},t}(),w=function(){function t(t){i.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){try{var s=this.options.OpenLocationCode.decode(t),n={name:t,center:i.latLng(s.latitudeCenter,s.longitudeCenter),bbox:i.latLngBounds(i.latLng(s.latitudeLo,s.longitudeLo),i.latLng(s.latitudeHi,s.longitudeHi))};e.call(o,[n])}catch(r){console.warn(r),e.call(o,[])}},e.reverse=function(t,e,o,s){try{var n={name:this.options.OpenLocationCode.encode(t.lat,t.lng,this.options.codeLength),center:i.latLng(t.lat,t.lng),bbox:i.latLngBounds(i.latLng(t.lat,t.lng),i.latLng(t.lat,t.lng))};o.call(s,[n])}catch(r){console.warn(r),o.call(s,[])}},t}(),O=function(){function t(t){this.options={serviceUrl:"https://api.opencagedata.com/geocode/v1/json"},i.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){var n=s(this.options,{key:this.options.apiKey,q:t});p(this.options.serviceUrl,n,(function(t){var s=[];if(t.results&&t.results.length)for(var n=0;n<t.results.length;n++){var r,a=t.results[n],c=i.latLng(a.geometry);r=a.annotations&&a.annotations.bounds?i.latLngBounds(i.latLng(a.annotations.bounds.northeast),i.latLng(a.annotations.bounds.southwest)):i.latLngBounds(c,c),s.push({name:a.formatted,bbox:r,center:c})}e.call(o,s)}))},e.suggest=function(t,e,i){return this.geocode(t,e,i)},e.reverse=function(t,e,o,s){var r=n(this.options,{key:this.options.apiKey,q:[t.lat,t.lng].join(",")});p(this.options.serviceUrl,r,(function(t){var e=[];if(t.results&&t.results.length)for(var n=0;n<t.results.length;n++){var r,a=t.results[n],c=i.latLng(a.geometry);r=a.annotations&&a.annotations.bounds?i.latLngBounds(i.latLng(a.annotations.bounds.northeast),i.latLng(a.annotations.bounds.southwest)):i.latLngBounds(c,c),e.push({name:a.formatted,bbox:r,center:c})}o.call(s,e)}))},t}(),I=function(){function t(t){this.options={serviceUrl:"https://api.geocode.earth/v1"},this._lastSuggest=0,i.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,i){var o=this,n=s(this.options,{api_key:this.options.apiKey,text:t});p(this.options.serviceUrl+"/search",n,(function(t){e.call(i,o._parseResults(t,"bbox"))}))},e.suggest=function(t,e,i){var o=this,n=s(this.options,{api_key:this.options.apiKey,text:t});p(this.options.serviceUrl+"/autocomplete",n,(function(t){t.geocoding.timestamp>o._lastSuggest&&(o._lastSuggest=t.geocoding.timestamp,e.call(i,o._parseResults(t,"bbox")))}))},e.reverse=function(t,e,i,o){var s=this,r=n(this.options,{api_key:this.options.apiKey,"point.lat":t.lat,"point.lon":t.lng});p(this.options.serviceUrl+"/reverse",r,(function(t){i.call(o,s._parseResults(t,"bounds"))}))},e._parseResults=function(t,e){var o=[];return i.geoJSON(t,{pointToLayer:function(t,e){return i.circleMarker(e)},onEachFeature:function(t,s){var n,r,a={};s.getBounds?r=(n=s.getBounds()).getCenter():s.feature.bbox?(r=s.getLatLng(),n=i.latLngBounds(i.GeoJSON.coordsToLatLng(s.feature.bbox.slice(0,2)),i.GeoJSON.coordsToLatLng(s.feature.bbox.slice(2,4)))):(r=s.getLatLng(),n=i.latLngBounds(r,r)),a.name=s.feature.properties.label,a.center=r,a[e]=n,a.properties=s.feature.properties,o.push(a)}}),o},t}();function k(t){return new I(t)}var T=I,P=k,D=I,M=k,A=function(t){function e(e){return t.call(this,i.Util.extend({serviceUrl:"https://api.openrouteservice.org/geocode"},e))||this}return o(e,t),e}(I),U=function(){function t(t){this.options={serviceUrl:"https://photon.komoot.io/api/",reverseUrl:"https://photon.komoot.io/reverse/",nameProperties:["name","street","suburb","hamlet","town","city","state","country"]},i.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){var n=s(this.options,{q:t});p(this.options.serviceUrl,n,i.Util.bind((function(t){e.call(o,this._decodeFeatures(t))}),this))},e.suggest=function(t,e,i){return this.geocode(t,e,i)},e.reverse=function(t,e,o,s){var r=n(this.options,{lat:t.lat,lon:t.lng});p(this.options.reverseUrl,r,i.Util.bind((function(t){o.call(s,this._decodeFeatures(t))}),this))},e._decodeFeatures=function(t){var e=[];if(t&&t.features)for(var o=0;o<t.features.length;o++){var s=t.features[o],n=s.geometry.coordinates,r=i.latLng(n[1],n[0]),a=s.properties.extent,c=a?i.latLngBounds([a[1],a[0]],[a[3],a[2]]):i.latLngBounds(r,r);e.push({name:this._decodeFeatureName(s),html:this.options.htmlTemplate?this.options.htmlTemplate(s):void 0,center:r,bbox:c,properties:s.properties})}return e},e._decodeFeatureName=function(t){return(this.options.nameProperties||[]).map((function(e){return t.properties[e]})).filter((function(t){return!!t})).join(", ")},t}(),R=function(){function t(t){this.options={serviceUrl:"https://api.what3words.com/v2/"},i.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){p(this.options.serviceUrl+"forward",s(this.options,{key:this.options.apiKey,addr:t.split(/\s+/).join(".")}),(function(t){var s=[];if(t.geometry){var n=i.latLng(t.geometry.lat,t.geometry.lng),r=i.latLngBounds(n,n);s[0]={name:t.words,bbox:r,center:n}}e.call(o,s)}))},e.suggest=function(t,e,i){return this.geocode(t,e,i)},e.reverse=function(t,e,o,s){p(this.options.serviceUrl+"reverse",n(this.options,{key:this.options.apiKey,coords:[t.lat,t.lng].join(",")}),(function(t){var e=[];if(200==t.status.status){var n=i.latLng(t.geometry.lat,t.geometry.lng),r=i.latLngBounds(n,n);e[0]={name:t.words,bbox:r,center:n}}o.call(s,e)}))},t}(),F={__proto__:null,geocodingParams:s,reverseParams:n,ArcGis:m,arcgis:function(t){return new m(t)},Bing:f,bing:function(t){return new f(t)},Google:g,google:function(t){return new g(t)},HERE:v,HEREv2:y,here:function(t){return t.apiKey?new y(t):new v(t)},parseLatLng:b,LatLng:_,latLng:function(t){return new _(t)},Mapbox:x,mapbox:function(t){return new x(t)},MapQuest:L,mapQuest:function(t){return new L(t)},Neutrino:C,neutrino:function(t){return new C(t)},Nominatim:S,nominatim:function(t){return new S(t)},OpenLocationCode:w,openLocationCode:function(t){return new w(t)},OpenCage:O,opencage:function(t){return new O(t)},Pelias:I,pelias:k,GeocodeEarth:T,geocodeEarth:P,Mapzen:D,mapzen:M,Openrouteservice:A,openrouteservice:function(t){return new A(t)},Photon:U,photon:function(t){return new U(t)},What3Words:R,what3words:function(t){return new R(t)}},E=function(){};i.Util.extend(E.prototype,i.Control.prototype),i.Util.extend(E.prototype,i.Evented.prototype);var B=function(t){function e(e){var o;return(o=t.call(this,e)||this).options={showUniqueResult:!0,showResultIcons:!1,collapsed:!0,expand:"touch",position:"topright",placeholder:"Search...",errorMessage:"Nothing found.",iconLabel:"Initiate a new search",query:"",queryMinLength:1,suggestMinLength:3,suggestTimeout:250,defaultMarkGeocode:!0},o._requestCount=0,i.Util.setOptions(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(o),e),o.options.geocoder||(o.options.geocoder=new S),o}o(e,t);var s=e.prototype;return s.addThrobberClass=function(){i.DomUtil.addClass(this._container,"leaflet-control-geocoder-throbber")},s.removeThrobberClass=function(){i.DomUtil.removeClass(this._container,"leaflet-control-geocoder-throbber")},s.onAdd=function(t){var e=this,o="leaflet-control-geocoder",s=i.DomUtil.create("div",o+" leaflet-bar"),n=i.DomUtil.create("button",o+"-icon",s),r=this._form=i.DomUtil.create("div",o+"-form",s);this._map=t,this._container=s,n.innerHTML="&nbsp;",n.type="button",n.setAttribute("aria-label",this.options.iconLabel);var a=this._input=i.DomUtil.create("input","",r);return a.type="text",a.value=this.options.query,a.placeholder=this.options.placeholder,i.DomEvent.disableClickPropagation(a),this._errorElement=i.DomUtil.create("div",o+"-form-no-error",s),this._errorElement.innerHTML=this.options.errorMessage,this._alts=i.DomUtil.create("ul",o+"-alternatives leaflet-control-geocoder-alternatives-minimized",s),i.DomEvent.disableClickPropagation(this._alts),i.DomEvent.addListener(a,"keydown",this._keydown,this),this.options.geocoder.suggest&&i.DomEvent.addListener(a,"input",this._change,this),i.DomEvent.addListener(a,"blur",(function(){e.options.collapsed&&!e._preventBlurCollapse&&e._collapse(),e._preventBlurCollapse=!1})),this.options.collapsed?"click"===this.options.expand?i.DomEvent.addListener(s,"click",(function(t){0===t.button&&2!==t.detail&&e._toggle()})):"touch"===this.options.expand?i.DomEvent.addListener(s,i.Browser.touch?"touchstart mousedown":"mousedown",(function(t){e._toggle(),t.preventDefault(),t.stopPropagation()}),this):(i.DomEvent.addListener(s,"mouseover",this._expand,this),i.DomEvent.addListener(s,"mouseout",this._collapse,this),this._map.on("movestart",this._collapse,this)):(this._expand(),i.DomEvent.addListener(s,i.Browser.touch?"touchstart":"click",(function(){return e._geocode()}))),this.options.defaultMarkGeocode&&this.on("markgeocode",this.markGeocode,this),this.on("startgeocode",this.addThrobberClass,this),this.on("finishgeocode",this.removeThrobberClass,this),this.on("startsuggest",this.addThrobberClass,this),this.on("finishsuggest",this.removeThrobberClass,this),i.DomEvent.disableClickPropagation(s),s},s.setQuery=function(t){return this._input.value=t,this},s._geocodeResult=function(t,e){if(!e&&this.options.showUniqueResult&&1===t.length)this._geocodeResultSelected(t[0]);else if(t.length>0){this._alts.innerHTML="",this._results=t,i.DomUtil.removeClass(this._alts,"leaflet-control-geocoder-alternatives-minimized"),i.DomUtil.addClass(this._container,"leaflet-control-geocoder-options-open");for(var o=0;o<t.length;o++)this._alts.appendChild(this._createAlt(t[o],o))}else i.DomUtil.addClass(this._container,"leaflet-control-geocoder-options-error"),i.DomUtil.addClass(this._errorElement,"leaflet-control-geocoder-error")},s.markGeocode=function(t){var e=t.geocode;return this._map.fitBounds(e.bbox),this._geocodeMarker&&this._map.removeLayer(this._geocodeMarker),this._geocodeMarker=new i.Marker(e.center).bindPopup(e.html||e.name).addTo(this._map).openPopup(),this},s._geocode=function(t){var e=this,i=this._input.value;if(t||!(i.length<this.options.queryMinLength)){var o=++this._requestCount,s=function(s){o===e._requestCount&&(e.fire(t?"finishsuggest":"finishgeocode",{input:i,results:s}),e._geocodeResult(s,t))};this._lastGeocode=i,t||this._clearResults(),this.fire(t?"startsuggest":"startgeocode",{input:i}),t?this.options.geocoder.suggest(i,s):this.options.geocoder.geocode(i,s)}},s._geocodeResultSelected=function(t){this.fire("markgeocode",{geocode:t})},s._toggle=function(){i.DomUtil.hasClass(this._container,"leaflet-control-geocoder-expanded")?this._collapse():this._expand()},s._expand=function(){i.DomUtil.addClass(this._container,"leaflet-control-geocoder-expanded"),this._input.select(),this.fire("expand")},s._collapse=function(){i.DomUtil.removeClass(this._container,"leaflet-control-geocoder-expanded"),i.DomUtil.addClass(this._alts,"leaflet-control-geocoder-alternatives-minimized"),i.DomUtil.removeClass(this._errorElement,"leaflet-control-geocoder-error"),i.DomUtil.removeClass(this._container,"leaflet-control-geocoder-options-open"),i.DomUtil.removeClass(this._container,"leaflet-control-geocoder-options-error"),this._input.blur(),this.fire("collapse")},s._clearResults=function(){i.DomUtil.addClass(this._alts,"leaflet-control-geocoder-alternatives-minimized"),this._selection=null,i.DomUtil.removeClass(this._errorElement,"leaflet-control-geocoder-error"),i.DomUtil.removeClass(this._container,"leaflet-control-geocoder-options-open"),i.DomUtil.removeClass(this._container,"leaflet-control-geocoder-options-error")},s._createAlt=function(t,e){var o=this,s=i.DomUtil.create("li",""),n=i.DomUtil.create("a","",s),r=this.options.showResultIcons&&t.icon?i.DomUtil.create("img","",n):null,a=t.html?void 0:document.createTextNode(t.name);return r&&(r.src=t.icon),s.setAttribute("data-result-index",String(e)),t.html?n.innerHTML=n.innerHTML+t.html:a&&n.appendChild(a),i.DomEvent.addListener(s,"mousedown touchstart",(function(e){o._preventBlurCollapse=!0,i.DomEvent.stop(e),o._geocodeResultSelected(t),i.DomEvent.on(s,"click touchend",(function(){o.options.collapsed?o._collapse():o._clearResults()}))}),this),s},s._keydown=function(t){var e=this,o=function(t){e._selection&&(i.DomUtil.removeClass(e._selection,"leaflet-control-geocoder-selected"),e._selection=e._selection[t>0?"nextSibling":"previousSibling"]),e._selection||(e._selection=e._alts[t>0?"firstChild":"lastChild"]),e._selection&&i.DomUtil.addClass(e._selection,"leaflet-control-geocoder-selected")};switch(t.keyCode){case 27:this.options.collapsed?this._collapse():this._clearResults();break;case 38:o(-1);break;case 40:o(1);break;case 13:if(this._selection){var s=parseInt(this._selection.getAttribute("data-result-index"),10);this._geocodeResultSelected(this._results[s]),this._clearResults()}else this._geocode();break;default:return}i.DomEvent.preventDefault(t)},s._change=function(){var t=this,e=this._input.value;e!==this._lastGeocode&&(clearTimeout(this._suggestTimeout),e.length>=this.options.suggestMinLength?this._suggestTimeout=setTimeout((function(){return t._geocode(!0)}),this.options.suggestTimeout):this._clearResults())},e}(E);i.Util.extend(B,F),i.Util.extend(i.Control,{Geocoder:B,geocoder:function(t){return new B(t)}})}(L)},M9GK:function(t,e,i){!function(t,e,i){"use strict";var o="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer/",s=i.Task.extend({path:"findAddressCandidates",params:{outSr:4326,forStorage:!1,outFields:"*",maxLocations:20},setters:{address:"address",neighborhood:"neighborhood",city:"city",subregion:"subregion",region:"region",postal:"postal",country:"country",text:"singleLine",category:"category",token:"token",apikey:"apikey",key:"magicKey",fields:"outFields",forStorage:"forStorage",maxLocations:"maxLocations",countries:"sourceCountry"},initialize:function(t){(t=t||{}).url=t.url||o,i.Task.prototype.initialize.call(this,t)},within:function(t){return t=e.latLngBounds(t),this.params.searchExtent=i.Util.boundsToExtent(t),this},nearby:function(t,i){var o=e.latLng(t);return this.params.location=o.lng+","+o.lat,i&&(this.params.distance=Math.min(Math.max(i,2e3),5e4)),this},run:function(t,e){return this.options.token&&(this.params.token=this.options.token),this.options.apikey&&(this.params.token=this.options.apikey),this.options.customParam&&(this.params[this.options.customParam]=this.params.singleLine,delete this.params.singleLine),this.request((function(i,o){var s=i?void 0:(0,this._processGeocoderResponse)(o);t.call(e,i,{results:s},o)}),this)},_processGeocoderResponse:function(t){for(var o=[],s=0;s<t.candidates.length;s++){var n=t.candidates[s];if(n.extent)var r=i.Util.extentToBounds(n.extent);o.push({text:n.address,bounds:r,score:n.score,latlng:e.latLng(n.location.y,n.location.x),properties:n.attributes})}return o}});function n(t){return new s(t)}var r=i.Task.extend({path:"reverseGeocode",params:{outSR:4326,returnIntersection:!1},setters:{distance:"distance",language:"langCode",intersection:"returnIntersection"},initialize:function(t){(t=t||{}).url=t.url||o,i.Task.prototype.initialize.call(this,t)},latlng:function(t){var i=e.latLng(t);return this.params.location=i.lng+","+i.lat,this},run:function(t,i){return this.request((function(o,s){var n;n=o?void 0:{latlng:e.latLng(s.location.y,s.location.x),address:s.address},t.call(i,o,n,s)}),this)}});function a(t){return new r(t)}var c=i.Task.extend({path:"suggest",params:{},setters:{text:"text",category:"category",countries:"countryCode",maxSuggestions:"maxSuggestions"},initialize:function(t){(t=t||{}).url||(t.url=o,t.supportsSuggest=!0),i.Task.prototype.initialize.call(this,t)},within:function(t){var o=(t=e.latLngBounds(t)).getCenter(),s=t.getNorthWest();return this.params.location=o.lng+","+o.lat,this.params.distance=Math.min(Math.max(o.distanceTo(s),2e3),5e4),this.params.searchExtent=i.Util.boundsToExtent(t),this},nearby:function(t,i){var o=e.latLng(t);return this.params.location=o.lng+","+o.lat,i&&(this.params.distance=Math.min(Math.max(i,2e3),5e4)),this},run:function(t,e){if(this.options.supportsSuggest)return this.request((function(i,o){t.call(e,i,o,o)}),this);console.warn("this geocoding service does not support asking for suggestions")}});function l(t){return new c(t)}var u=i.Service.extend({initialize:function(t){(t=t||{}).apikey&&(t.token=t.apikey),t.url?(i.Service.prototype.initialize.call(this,t),this._confirmSuggestSupport()):(t.url=o,t.supportsSuggest=!0,i.Service.prototype.initialize.call(this,t))},geocode:function(){return n(this)},reverse:function(){return a(this)},suggest:function(){return l(this)},_confirmSuggestSupport:function(){this.metadata((function(t,e){t||(this.options.supportsSuggest=!!e.capabilities&&e.capabilities.indexOf("Suggest")>-1,this.options.customParam=e.singleLineAddressField.name)}),this)}}),h=e.Evented.extend({options:{zoomToResult:!0,useMapBounds:12,searchBounds:null},initialize:function(t,i){if(e.Util.setOptions(this,i),this._control=t,!i||!i.providers||!i.providers.length)throw new Error("You must specify at least one provider");this._providers=i.providers},_geocode:function(t,i,o){var s,n=0,r=[],a=e.Util.bind((function(e,i){n--,e||(i&&(r=r.concat(i)),n<=0&&(s=this._boundsFromResults(r),this.fire("results",{results:r,bounds:s,latlng:s?s.getCenter():void 0,text:t},!0),this.options.zoomToResult&&s&&this._control._map.fitBounds(s),this.fire("load")))}),this);if(i)n++,o.results(t,i,this._searchBounds(),a);else for(var c=0;c<this._providers.length;c++)n++,this._providers[c].results(t,i,this._searchBounds(),a)},_suggest:function(t){var i=this._providers.length,o=0,s=e.Util.bind((function(t,s){return e.Util.bind((function(e,n){if(i-=1,o+=n.length,e)return this._control._clearProviderSuggestions(s),void this._control._finalizeSuggestions(i,o);if(n.length)for(var r=0;r<n.length;r++)n[r].provider=s;else this._control._renderSuggestions(n);s._lastRender!==t&&this._control._clearProviderSuggestions(s),n.length&&this._control._input.value===t&&(s._lastRender=t,this._control._renderSuggestions(n)),this._control._finalizeSuggestions(i,o)}),this)}),this);this._pendingSuggestions=[];for(var n=0;n<this._providers.length;n++){var r=this._providers[n],a=r.suggestions(t,this._searchBounds(),s(t,r));this._pendingSuggestions.push(a)}},_searchBounds:function(){return null!==this.options.searchBounds?this.options.searchBounds:!1===this.options.useMapBounds?null:!0===this.options.useMapBounds||this.options.useMapBounds<=this._control._map.getZoom()?this._control._map.getBounds():null},_boundsFromResults:function(t){if(t.length){for(var i=e.latLngBounds([0,0],[0,0]),o=[],s=[],n=t.length-1;n>=0;n--){var r=t[n];s.push(r.latlng),r.bounds&&r.bounds.isValid()&&!r.bounds.equals(i)&&o.push(r.bounds)}for(var a=e.latLngBounds(s),c=0;c<o.length;c++)a.extend(o[c]);return a}},_getAttribution:function(){for(var t=[],e=this._providers,i=0;i<e.length;i++)e[i].options.attribution&&t.push(e[i].options.attribution);return t.join(", ")}});function p(t,e){return new h(t,e)}var d=u.extend({options:{label:"Places and Addresses",maxResults:5},suggestions:function(t,e,i){var o=this.suggest().text(t);return e&&o.within(e),this.options.nearby&&o.nearby(this.options.nearby),this.options.countries&&o.countries(this.options.countries),this.options.categories&&o.category(this.options.categories),o.maxSuggestions(this.options.maxResults),o.run((function(t,e,o){var s=[];if(!t)for(;o.suggestions.length&&s.length<=this.options.maxResults-1;){var n=o.suggestions.shift();n.isCollection||s.push({text:n.text,unformattedText:n.text,magicKey:n.magicKey})}i(t,s)}),this)},results:function(t,e,i,o){var s=this.geocode().text(t);return e&&s.key(e),s.maxLocations(this.options.maxResults),i&&s.within(i),this.options.forStorage&&s.forStorage(!0),this.options.nearby&&s.nearby(this.options.nearby),this.options.countries&&s.countries(this.options.countries),this.options.categories&&s.category(this.options.categories),s.run((function(t,e){o(t,e.results)}),this)}});function m(t){return new d(t)}var f=e.Control.extend({includes:e.Evented.prototype,options:{position:"topleft",collapseAfterResult:!0,expanded:!1,allowMultipleResults:!0,placeholder:"Search for places or addresses",title:"Location Search"},initialize:function(t){e.Util.setOptions(this,t),t&&t.providers&&t.providers.length||(t||(t={}),t.providers=[m()]),this._geosearchCore=p(this,t),this._geosearchCore._providers=t.providers,this._geosearchCore.addEventParent(this);for(var i=0;i<this._geosearchCore._providers.length;i++)this._geosearchCore._providers[i].addEventParent(this);this._geosearchCore._pendingSuggestions=[],e.Control.prototype.initialize.call(this,t)},_renderSuggestions:function(t){var i,o,s;t.length>0&&(this._suggestions.style.display="block");for(var n=[],r=0;r<t.length;r++){var a=t[r];if(!s&&this._geosearchCore._providers.length>1&&i!==a.provider.options.label&&((s=e.DomUtil.create("div","geocoder-control-header",a.provider._contentsElement)).textContent=a.provider.options.label,s.innerText=a.provider.options.label,i=a.provider.options.label),o||(o=e.DomUtil.create("ul","geocoder-control-list",a.provider._contentsElement)),-1===n.indexOf(a.text)){var c=e.DomUtil.create("li","geocoder-control-suggestion",o);c.innerHTML=a.text,c.provider=a.provider,c["data-magic-key"]=a.magicKey,c.unformattedText=a.unformattedText}else for(var l=0;l<o.childNodes.length;l++)o.childNodes[l].innerHTML===a.text&&(o.childNodes[l]["data-magic-key"]+=","+a.magicKey);n.push(a.text)}this.getPosition().indexOf("top")>-1&&(this._suggestions.style.maxHeight=this._map.getSize().y-this._suggestions.offsetTop-this._wrapper.offsetTop-10+"px"),this.getPosition().indexOf("bottom")>-1&&this._setSuggestionsBottomPosition()},_setSuggestionsBottomPosition:function(){this._suggestions.style.maxHeight=this._map.getSize().y-this._map._controlCorners[this.getPosition()].offsetHeight-this._wrapper.offsetHeight+"px",this._suggestions.style.top=-this._suggestions.offsetHeight-this._wrapper.offsetHeight+20+"px"},_boundsFromResults:function(t){if(t.length){for(var i=e.latLngBounds([0,0],[0,0]),o=[],s=[],n=t.length-1;n>=0;n--){var r=t[n];s.push(r.latlng),r.bounds&&r.bounds.isValid()&&!r.bounds.equals(i)&&o.push(r.bounds)}for(var a=e.latLngBounds(s),c=0;c<o.length;c++)a.extend(o[c]);return a}},clear:function(){this._clearAllSuggestions(),this.options.collapseAfterResult&&(this._input.value="",this._lastValue="",this._input.placeholder="",e.DomUtil.removeClass(this._wrapper,"geocoder-control-expanded")),!this._map.scrollWheelZoom.enabled()&&this._map.options.scrollWheelZoom&&this._map.scrollWheelZoom.enable()},_clearAllSuggestions:function(){this._suggestions.style.display="none";for(var t=0;t<this.options.providers.length;t++)this._clearProviderSuggestions(this.options.providers[t])},_clearProviderSuggestions:function(t){t._contentsElement.innerHTML=""},_finalizeSuggestions:function(t,i){t||(e.DomUtil.removeClass(this._input,"geocoder-control-loading"),this.getPosition().indexOf("bottom")>-1&&this._setSuggestionsBottomPosition(),i||this._clearAllSuggestions())},_setupClick:function(){e.DomUtil.addClass(this._wrapper,"geocoder-control-expanded"),this._input.focus()},disable:function(){this._input.disabled=!0,e.DomUtil.addClass(this._input,"geocoder-control-input-disabled"),e.DomEvent.removeListener(this._wrapper,"click",this._setupClick,this)},enable:function(){this._input.disabled=!1,e.DomUtil.removeClass(this._input,"geocoder-control-input-disabled"),e.DomEvent.addListener(this._wrapper,"click",this._setupClick,this)},getAttribution:function(){for(var t=[],e=0;e<this._providers.length;e++)this._providers[e].options.attribution&&t.push(this._providers[e].options.attribution);return t.join(", ")},geocodeSuggestion:function(t){var e=t.target||t.srcElement;e.classList.contains("geocoder-control-suggestions")||e.classList.contains("geocoder-control-header")||(e.classList.length<1&&(e=e.parentNode),this._geosearchCore._geocode(e.unformattedText,e["data-magic-key"],e.provider),this.clear())},onAdd:function(t){i.Util.setEsriAttribution(t),this._map=t,this._wrapper=e.DomUtil.create("div","geocoder-control"),this._input=e.DomUtil.create("input","geocoder-control-input leaflet-bar",this._wrapper),this._input.title=this.options.title,this.options.expanded&&(e.DomUtil.addClass(this._wrapper,"geocoder-control-expanded"),this._input.placeholder=this.options.placeholder),this._suggestions=e.DomUtil.create("div","geocoder-control-suggestions leaflet-bar",this._wrapper);for(var o=0;o<this.options.providers.length;o++)this.options.providers[o]._contentsElement=e.DomUtil.create("div",null,this._suggestions);var s=this._geosearchCore._getAttribution();return t.attributionControl&&t.attributionControl.addAttribution(s),e.DomEvent.addListener(this._input,"focus",(function(t){this._input.placeholder=this.options.placeholder,e.DomUtil.addClass(this._wrapper,"geocoder-control-expanded")}),this),e.DomEvent.addListener(this._wrapper,"click",this._setupClick,this),e.DomEvent.addListener(this._suggestions,"mousedown",this.geocodeSuggestion,this),e.DomEvent.addListener(this._input,"blur",(function(t){this.clear()}),this),e.DomEvent.addListener(this._input,"keydown",(function(t){var i=(t.target||t.srcElement).value;e.DomUtil.addClass(this._wrapper,"geocoder-control-expanded");for(var o,s=this._suggestions.querySelectorAll(".geocoder-control-suggestion"),n=this._suggestions.querySelectorAll(".geocoder-control-selected")[0],r=0;r<s.length;r++)if(s[r]===n){o=r;break}switch(t.keyCode){case 13:n?(this._input.value=n.innerText,this._geosearchCore._geocode(n.unformattedText,n["data-magic-key"],n.provider),this.clear()):this.options.allowMultipleResults&&i.length>=2?(this._geosearchCore._geocode(this._input.value,void 0),this.clear()):1===s.length?(e.DomUtil.addClass(s[0],"geocoder-control-selected"),this._geosearchCore._geocode(s[0].innerHTML,s[0]["data-magic-key"],s[0].provider)):(this.clear(),this._input.blur()),e.DomEvent.preventDefault(t);break;case 38:n&&e.DomUtil.removeClass(n,"geocoder-control-selected");var a=s[o-1];e.DomUtil.addClass(n&&a?a:s[s.length-1],"geocoder-control-selected"),e.DomEvent.preventDefault(t);break;case 40:n&&e.DomUtil.removeClass(n,"geocoder-control-selected");var c=s[o+1];e.DomUtil.addClass(n&&c?c:s[0],"geocoder-control-selected"),e.DomEvent.preventDefault(t);break;default:for(var l=0;l<this._geosearchCore._pendingSuggestions.length;l++){var u=this._geosearchCore._pendingSuggestions[l];u&&u.abort&&!u.id&&u.abort()}}}),this),e.DomEvent.addListener(this._input,"keyup",e.Util.throttle((function(t){var i=t.which||t.keyCode,o=(t.target||t.srcElement).value;if(o.length<2)return this._lastValue=this._input.value,this._clearAllSuggestions(),void e.DomUtil.removeClass(this._input,"geocoder-control-loading");27!==i?13!==i&&38!==i&&40!==i&&this._input.value!==this._lastValue&&(this._lastValue=this._input.value,e.DomUtil.addClass(this._input,"geocoder-control-loading"),this._geosearchCore._suggest(o)):this._clearAllSuggestions()}),50,this),this),e.DomEvent.disableClickPropagation(this._wrapper),e.DomEvent.addListener(this._suggestions,"mouseover",(function(e){t.scrollWheelZoom.enabled()&&t.options.scrollWheelZoom&&t.scrollWheelZoom.disable()})),e.DomEvent.addListener(this._suggestions,"mouseout",(function(e){!t.scrollWheelZoom.enabled()&&t.options.scrollWheelZoom&&t.scrollWheelZoom.enable()})),this._geosearchCore.on("load",(function(t){e.DomUtil.removeClass(this._input,"geocoder-control-loading"),this.clear(),this._input.blur()}),this),this._wrapper}}),g=i.FeatureLayerService.extend({options:{label:"Feature Layer",maxResults:5,bufferRadius:1e3,searchMode:"contain",formatSuggestion:function(t){return t.properties[this.options.searchFields[0]]}},initialize:function(t){t.apikey&&(t.token=t.apikey),i.FeatureLayerService.prototype.initialize.call(this,t),"string"==typeof this.options.searchFields&&(this.options.searchFields=[this.options.searchFields]),this._suggestionsQuery=this.query(),this._resultsQuery=this.query()},suggestions:function(t,e,i){var o=this._suggestionsQuery.where(this._buildQuery(t)).returnGeometry(!1);return e&&o.intersects(e),this.options.idField&&o.fields([this.options.idField].concat(this.options.searchFields)),o.run((function(t,e,o){if(t)i(t,[]);else{this.options.idField=o.objectIdFieldName;for(var s=[],n=e.features.length-1;n>=0;n--){var r=e.features[n];s.push({text:this.options.formatSuggestion.call(this,r),unformattedText:r.properties[this.options.searchFields[0]],magicKey:r.id})}i(t,s.slice(0,this.options.maxResults))}}),this)},results:function(t,i,o,s){var n=this._resultsQuery;return i?(delete n.params.where,n.featureIds([i])):n.where(this._buildQuery(t)),o&&n.within(o),n.run(e.Util.bind((function(t,e){for(var i=[],o=0;o<e.features.length;o++){var n=e.features[o];if(n){var r=this._featureBounds(n),a={latlng:r.getCenter(),bounds:r,text:this.options.formatSuggestion.call(this,n),properties:n.properties,geojson:n};i.push(a),delete this._resultsQuery.params.objectIds}}s(t,i)}),this))},orderBy:function(t,e){this._suggestionsQuery.orderBy(t,e)},_buildQuery:function(t){for(var e=[],i=this.options.searchFields.length-1;i>=0;i--){var o='upper("'+this.options.searchFields[i]+'")';if("contain"===this.options.searchMode)e.push(o+" LIKE upper('%"+t+"%')");else if("startWith"===this.options.searchMode)e.push(o+" LIKE upper('"+t+"%')");else if("endWith"===this.options.searchMode)e.push(o+" LIKE upper('%"+t+"')");else{if("strict"!==this.options.searchMode)throw new Error('L.esri.Geocoding.featureLayerProvider: Invalid parameter for "searchMode". Use one of "contain", "startWith", "endWith", or "strict"');e.push(o+" LIKE upper('"+t+"')")}}return this.options.where?this.options.where+" AND ("+e.join(" OR ")+")":e.join(" OR ")},_featureBounds:function(t){var i=e.geoJson(t);if("Point"===t.geometry.type){var o=i.getBounds().getCenter(),s=this.options.bufferRadius/40075017*360/Math.cos(180/Math.PI*o.lat),n=this.options.bufferRadius/40075017*360;return e.latLngBounds([o.lat-n,o.lng-s],[o.lat+n,o.lng+s])}return i.getBounds()}}),v=i.MapService.extend({options:{layers:[0],label:"Map Service",bufferRadius:1e3,maxResults:5,formatSuggestion:function(t){return t.properties[t.displayFieldName]+" <small>"+t.layerName+"</small>"}},initialize:function(t){t.apikey&&(t.token=t.apikey),i.MapService.prototype.initialize.call(this,t),this._getIdFields()},suggestions:function(t,e,i){return this.find().text(t).fields(this.options.searchFields).returnGeometry(!1).layers(this.options.layers).run((function(t,e,o){var s=[];if(!t){var n=Math.min(this.options.maxResults,e.features.length);o.results=o.results.reverse();for(var r=0;r<n;r++){var a=e.features[r],c=o.results[r],l=c.layerId,u=this._idFields[l];a.layerId=l,a.layerName=this._layerNames[l],a.displayFieldName=this._displayFields[l],u&&s.push({text:this.options.formatSuggestion.call(this,a),unformattedText:a.properties[a.displayFieldName],magicKey:c.attributes[u]+":"+l})}}i(t,s.reverse())}),this)},results:function(t,e,i,o){var s,n=[];if(e&&!e.includes(",")){var r=e.split(":")[0],a=e.split(":")[1];s=this.query().layer(a).featureIds(r)}else s=this.find().text(t).fields(this.options.searchFields).layers(this.options.layers);return s.run((function(t,e,i){if(!t){i.results&&(i.results=i.results.reverse());for(var s=0;s<e.features.length;s++){var r=e.features[s];if(a=a||i.results[s].layerId,r&&void 0!==a){var c=this._featureBounds(r);r.layerId=a,r.layerName=this._layerNames[a],r.displayFieldName=this._displayFields[a];var l={latlng:c.getCenter(),bounds:c,text:this.options.formatSuggestion.call(this,r),properties:r.properties,geojson:r};n.push(l)}}}o(t,n.reverse())}),this)},_featureBounds:function(t){var i=e.geoJson(t);if("Point"===t.geometry.type){var o=i.getBounds().getCenter(),s=this.options.bufferRadius/40075017*360/Math.cos(180/Math.PI*o.lat),n=this.options.bufferRadius/40075017*360;return e.latLngBounds([o.lat-n,o.lng-s],[o.lat+n,o.lng+s])}return i.getBounds()},_layerMetadataCallback:function(t){return e.Util.bind((function(e,i){if(!e){this._displayFields[t]=i.displayField,this._layerNames[t]=i.name;for(var o=0;o<i.fields.length;o++){var s=i.fields[o];if("esriFieldTypeOID"===s.type){this._idFields[t]=s.name;break}}}}),this)},_getIdFields:function(){this._idFields={},this._displayFields={},this._layerNames={};for(var t=0;t<this.options.layers.length;t++){var e=this.options.layers[t];this.get(e,{},this._layerMetadataCallback(e))}}}),y=u.extend({options:{label:"Geocode Server",maxResults:5},suggestions:function(t,e,i){if(this.options.supportsSuggest){var o=this.suggest().text(t);return e&&o.within(e),o.run((function(t,e,o){var s=[];if(!t)for(;o.suggestions.length&&s.length<=this.options.maxResults-1;){var n=o.suggestions.shift();n.isCollection||s.push({text:n.text,unformattedText:n.text,magicKey:n.magicKey})}i(t,s)}),this)}return i(void 0,[]),!1},results:function(t,e,i,o){var s=this.geocode().text(t);return e&&s.key(e),s.maxLocations(this.options.maxResults),i&&s.within(i),s.run((function(t,e){o(t,e.results)}),this)}});t.ArcgisOnlineProvider=d,t.FeatureLayerProvider=g,t.Geocode=s,t.GeocodeService=u,t.GeocodeServiceProvider=y,t.Geosearch=f,t.GeosearchCore=h,t.MapServiceProvider=v,t.ReverseGeocode=r,t.Suggest=c,t.VERSION="3.1.1",t.WorldGeocodingServiceUrl=o,t.arcgisOnlineProvider=m,t.featureLayerProvider=function(t){return new g(t)},t.geocode=n,t.geocodeService=function(t){return new u(t)},t.geocodeServiceProvider=function(t){return new y(t)},t.geosearch=function(t){return new f(t)},t.geosearchCore=p,t.mapServiceProvider=function(t){return new v(t)},t.reverseGeocode=a,t.suggest=l,Object.defineProperty(t,"__esModule",{value:!0})}(e,i("4R65"),i("MCPi"))},MCPi:function(t,e,i){"use strict";i.r(e),i.d(e,"VERSION",(function(){return Rt})),i.d(e,"Support",(function(){return r})),i.d(e,"options",(function(){return a})),i.d(e,"Util",(function(){return Z})),i.d(e,"get",(function(){return g})),i.d(e,"post",(function(){return p})),i.d(e,"request",(function(){return m})),i.d(e,"Task",(function(){return Q})),i.d(e,"task",(function(){return W})),i.d(e,"Query",(function(){return H})),i.d(e,"query",(function(){return K})),i.d(e,"Find",(function(){return V})),i.d(e,"find",(function(){return X})),i.d(e,"Identify",(function(){return Y})),i.d(e,"identify",(function(){return tt})),i.d(e,"IdentifyFeatures",(function(){return et})),i.d(e,"identifyFeatures",(function(){return it})),i.d(e,"IdentifyImage",(function(){return st})),i.d(e,"identifyImage",(function(){return nt})),i.d(e,"Service",(function(){return at})),i.d(e,"service",(function(){return ct})),i.d(e,"MapService",(function(){return lt})),i.d(e,"mapService",(function(){return ut})),i.d(e,"ImageService",(function(){return pt})),i.d(e,"imageService",(function(){return dt})),i.d(e,"FeatureLayerService",(function(){return ft})),i.d(e,"featureLayerService",(function(){return gt})),i.d(e,"BasemapLayer",(function(){return bt})),i.d(e,"basemapLayer",(function(){return _t})),i.d(e,"TiledMapLayer",(function(){return xt})),i.d(e,"tiledMapLayer",(function(){return Lt})),i.d(e,"RasterLayer",(function(){return St})),i.d(e,"ImageMapLayer",(function(){return wt})),i.d(e,"imageMapLayer",(function(){return Ot})),i.d(e,"DynamicMapLayer",(function(){return It})),i.d(e,"dynamicMapLayer",(function(){return kt})),i.d(e,"FeatureManager",(function(){return Mt})),i.d(e,"FeatureLayer",(function(){return At})),i.d(e,"featureLayer",(function(){return Ut}));var o=i("aAg2"),s=window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,n=""===document.documentElement.style.pointerEvents,r={cors:s,pointerEvents:n},a={attributionWidthOffset:55},c=i("4R65"),l=0;function u(t){var e="";for(var i in t.f=t.f||"json",t)if(t.hasOwnProperty(i)){var o,s=t[i],n=Object.prototype.toString.call(s);e.length&&(e+="&"),o="[object Array]"===n?"[object Object]"===Object.prototype.toString.call(s[0])?JSON.stringify(s):s.join(","):"[object Object]"===n?JSON.stringify(s):"[object Date]"===n?s.valueOf():s,e+=encodeURIComponent(i)+"="+encodeURIComponent(o)}return e}function h(t,e){var i=new window.XMLHttpRequest;return i.onerror=function(o){i.onreadystatechange=c.Util.falseFn,t.call(e,{error:{code:500,message:"XMLHttpRequest error"}},null)},i.onreadystatechange=function(){var o,s;if(4===i.readyState){try{o=JSON.parse(i.responseText)}catch(n){o=null,s={code:500,message:"Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."}}!s&&o.error&&(s=o.error,o=null),i.onerror=c.Util.falseFn,t.call(e,s,o)}},i.ontimeout=function(){this.onerror()},i}function p(t,e,i,o){var s=h(i,o);return s.open("POST",t),null!=o&&void 0!==o.options&&(s.timeout=o.options.timeout),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),s.send(u(e)),s}function d(t,e,i,o){var s=h(i,o);return s.open("GET",t+"?"+u(e),!0),null!=o&&void 0!==o.options&&(s.timeout=o.options.timeout,o.options.withCredentials&&(s.withCredentials=!0)),s.send(null),s}function m(t,e,i,o){var s=u(e),n=h(i,o),a=(t+"?"+s).length;if(a<=2e3&&r.cors?n.open("GET",t+"?"+s):a>2e3&&r.cors&&(n.open("POST",t),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8")),null!=o&&void 0!==o.options&&(n.timeout=o.options.timeout,o.options.withCredentials&&(n.withCredentials=!0)),a<=2e3&&r.cors)n.send(null);else{if(!(a>2e3&&r.cors))return a<=2e3&&!r.cors?f(t,e,i,o):void v("a request to "+t+" was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy http://esri.github.io/esri-leaflet/api-reference/request.html");n.send(s)}return n}function f(t,e,i,o){window._EsriLeafletCallbacks=window._EsriLeafletCallbacks||{};var s="c"+l;e.callback="window._EsriLeafletCallbacks."+s,window._EsriLeafletCallbacks[s]=function(t){if(!0!==window._EsriLeafletCallbacks[s]){var e,n=Object.prototype.toString.call(t);"[object Object]"!==n&&"[object Array]"!==n&&(e={error:{code:500,message:"Expected array or object as JSONP response"}},t=null),!e&&t.error&&(e=t,t=null),i.call(o,e,t),window._EsriLeafletCallbacks[s]=!0}};var n=c.DomUtil.create("script",null,document.body);return n.type="text/javascript",n.src=t+"?"+u(e),n.id=s,n.onerror=function(t){t&&!0!==window._EsriLeafletCallbacks[s]&&(i.call(o,{error:{code:500,message:"An unknown error occurred"}}),window._EsriLeafletCallbacks[s]=!0)},c.DomUtil.addClass(n,"esri-leaflet-jsonp"),l++,{id:s,url:n.src,abort:function(){window._EsriLeafletCallbacks._callback[s]({code:0,message:"Request aborted."})}}}var g=r.cors?d:f;function v(){console&&console.warn&&console.warn.apply(console,arguments)}g.CORS=d,g.JSONP=f;var y={request:m,get:g,post:p},b=function(t,e,i,o){var s=(o[1]-i[1])*(e[0]-t[0])-(o[0]-i[0])*(e[1]-t[1]);if(0!==s){var n=((o[0]-i[0])*(t[1]-i[1])-(o[1]-i[1])*(t[0]-i[0]))/s,r=((e[0]-t[0])*(t[1]-i[1])-(e[1]-t[1])*(t[0]-i[0]))/s;if(n>=0&&n<=1&&r>=0&&r<=1)return!0}return!1},_=function(t,e){for(var i=0;i<t.length-1;i++)for(var o=0;o<e.length-1;o++)if(b(t[i],t[i+1],e[o],e[o+1]))return!0;return!1},x=function(t){return function(t,e){for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}(t[0],t[t.length-1])||t.push(t[0]),t},L=function(t){for(var e,i=0,o=0,s=t.length,n=t[o];o<s-1;o++)i+=((e=t[o+1])[0]-n[0])*(e[1]+n[1]),n=e;return i>=0},C=function(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},S=function(t,e){var i=_(t,e),o=function(t,e){for(var i=!1,o=-1,s=t.length,n=s-1;++o<s;n=o)(t[o][1]<=e[1]&&e[1]<t[n][1]||t[n][1]<=e[1]&&e[1]<t[o][1])&&e[0]<(t[n][0]-t[o][0])*(e[1]-t[o][1])/(t[n][1]-t[o][1])+t[o][0]&&(i=!i);return i}(t,e[0]);return!(i||!o)},w=function(t){var e=[],i=t.slice(0),o=x(i.shift().slice(0));if(o.length>=4){L(o)||o.reverse(),e.push(o);for(var s=0;s<i.length;s++){var n=x(i[s].slice(0));n.length>=4&&(L(n)&&n.reverse(),e.push(n))}}return e};function O(t,e){return function t(e,i){i=i||"OBJECTID";var o,s={wkid:4326},n={};switch(e.type){case"Point":n.x=e.coordinates[0],n.y=e.coordinates[1],e.coordinates[2]&&(n.z=e.coordinates[2]),n.spatialReference=s;break;case"MultiPoint":n.points=e.coordinates.slice(0),e.coordinates[0][2]&&(n.hasZ=!0),n.spatialReference=s;break;case"LineString":n.paths=[e.coordinates.slice(0)],e.coordinates[0][2]&&(n.hasZ=!0),n.spatialReference=s;break;case"MultiLineString":n.paths=e.coordinates.slice(0),e.coordinates[0][0][2]&&(n.hasZ=!0),n.spatialReference=s;break;case"Polygon":n.rings=w(e.coordinates.slice(0)),e.coordinates[0][0][2]&&(n.hasZ=!0),n.spatialReference=s;break;case"MultiPolygon":n.rings=function(t){for(var e=[],i=0;i<t.length;i++)for(var o=w(t[i]),s=o.length-1;s>=0;s--){var n=o[s].slice(0);e.push(n)}return e}(e.coordinates.slice(0)),e.coordinates[0][0][0][2]&&(n.hasZ=!0),n.spatialReference=s;break;case"Feature":e.geometry&&(n.geometry=t(e.geometry,i)),n.attributes=e.properties?C(e.properties):{},e.id&&(n.attributes[i]=e.id);break;case"FeatureCollection":for(n=[],o=0;o<e.features.length;o++)n.push(t(e.features[o],i));break;case"GeometryCollection":for(n=[],o=0;o<e.geometries.length;o++)n.push(t(e.geometries[o],i))}return n}(t,e)}function I(t,e){return function t(e,i){var o={};if(e.features){o.type="FeatureCollection",o.features=[];for(var s=0;s<e.features.length;s++)o.features.push(t(e.features[s],i))}if("number"==typeof e.x&&"number"==typeof e.y&&(o.type="Point",o.coordinates=[e.x,e.y],"number"==typeof e.z&&o.coordinates.push(e.z)),e.points&&(o.type="MultiPoint",o.coordinates=e.points.slice(0)),e.paths&&(1===e.paths.length?(o.type="LineString",o.coordinates=e.paths[0].slice(0)):(o.type="MultiLineString",o.coordinates=e.paths.slice(0))),e.rings&&(o=function(t){for(var e,i,o=[],s=[],n=0;n<t.length;n++){var r=x(t[n].slice(0));if(!(r.length<4))if(L(r)){var a=[r.slice().reverse()];o.push(a)}else s.push(r.slice().reverse())}for(var c=[];s.length;){i=s.pop();var l=!1;for(e=o.length-1;e>=0;e--)if(S(o[e][0],i)){o[e].push(i),l=!0;break}l||c.push(i)}for(;c.length;){i=c.pop();var u=!1;for(e=o.length-1;e>=0;e--)if(_(o[e][0],i)){o[e].push(i),u=!0;break}u||o.push([i.reverse()])}return 1===o.length?{type:"Polygon",coordinates:o[0]}:{type:"MultiPolygon",coordinates:o}}(e.rings.slice(0))),"number"==typeof e.xmin&&"number"==typeof e.ymin&&"number"==typeof e.xmax&&"number"==typeof e.ymax&&(o.type="Polygon",o.coordinates=[[[e.xmax,e.ymax],[e.xmin,e.ymax],[e.xmin,e.ymin],[e.xmax,e.ymin],[e.xmax,e.ymax]]]),(e.geometry||e.attributes)&&(o.type="Feature",o.geometry=e.geometry?t(e.geometry):null,o.properties=e.attributes?C(e.attributes):null,e.attributes))try{o.id=function(t,e){for(var i=e?[e,"OBJECTID","FID"]:["OBJECTID","FID"],o=0;o<i.length;o++){var s=i[o];if(s in t&&("string"==typeof t[s]||"number"==typeof t[s]))return t[s]}throw Error("No valid id attribute found")}(e.attributes,i)}catch(n){}return JSON.stringify(o.geometry)===JSON.stringify({})&&(o.geometry=null),e.spatialReference&&e.spatialReference.wkid&&4326!==e.spatialReference.wkid&&console.warn("Object converted in non-standard crs - "+JSON.stringify(e.spatialReference)),o}(t,e)}function k(t){if("NaN"!==t.xmin&&"NaN"!==t.ymin&&"NaN"!==t.xmax&&"NaN"!==t.ymax){var e=Object(c.latLng)(t.ymin,t.xmin),i=Object(c.latLng)(t.ymax,t.xmax);return Object(c.latLngBounds)(e,i)}return null}function T(t){return{xmin:(t=Object(c.latLngBounds)(t)).getSouthWest().lng,ymin:t.getSouthWest().lat,xmax:t.getNorthEast().lng,ymax:t.getNorthEast().lat,spatialReference:{wkid:4326}}}var P=/^(OBJECTID|FID|OID|ID)$/i;function D(t){var e;if(t.objectIdFieldName)e=t.objectIdFieldName;else if(t.fields){for(var i=0;i<=t.fields.length-1;i++)if("esriFieldTypeOID"===t.fields[i].type){e=t.fields[i].name;break}if(!e)for(i=0;i<=t.fields.length-1;i++)if(t.fields[i].name.match(P)){e=t.fields[i].name;break}}return e}function M(t){for(var e in t.attributes)if(e.match(P))return e}function A(t,e){var i,o=t.features||t.results,s=o&&o.length;i=e||D(t);var n={type:"FeatureCollection",features:[]};if(s)for(var r=o.length-1;r>=0;r--){var a=I(o[r],i||M(o[r]));n.features.push(a)}return n}function U(t){return"/"!==(t=c.Util.trim(t))[t.length-1]&&(t+="/"),t}function R(t){if(-1!==t.url.indexOf("?")){t.requestParams=t.requestParams||{};var e=t.url.substring(t.url.indexOf("?")+1);t.url=t.url.split("?")[0],t.requestParams=JSON.parse('{"'+decodeURI(e).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')}return t.url=U(t.url.split("?")[0]),t}function F(t){return/^(?!.*utility\.arcgis\.com).*\.arcgis\.com.*FeatureServer/i.test(t)}function E(t){var e;switch(t){case"Point":e="esriGeometryPoint";break;case"MultiPoint":e="esriGeometryMultipoint";break;case"LineString":case"MultiLineString":e="esriGeometryPolyline";break;case"Polygon":case"MultiPolygon":e="esriGeometryPolygon"}return e}function B(t){return t.getSize().x-a.attributionWidthOffset+"px"}function G(t){if(t.attributionControl){if(t.attributionControl._esriAttributionLayerCount||(t.attributionControl._esriAttributionLayerCount=0),0===t.attributionControl._esriAttributionLayerCount){if(!t.attributionControl._esriAttributionAddedOnce){var e=document.createElement("style");e.type="text/css",e.innerHTML=".esri-truncated-attribution:hover {white-space: normal;}",document.getElementsByTagName("head")[0].appendChild(e);var i=document.createElement("style");i.type="text/css",i.innerHTML=".esri-truncated-attribution {vertical-align: -3px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;display: inline-block;transition: 0s white-space;transition-delay: 1s;max-width: "+B(t)+";}",document.getElementsByTagName("head")[0].appendChild(i),t.on("resize",(function(e){t.attributionControl&&(t.attributionControl._container.style.maxWidth=B(e.target))})),t.attributionControl._esriAttributionAddedOnce=!0}t.attributionControl.setPrefix('<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a> | Powered by <a href="https://www.esri.com">Esri</a>'),c.DomUtil.addClass(t.attributionControl._container,"esri-truncated-attribution:hover"),c.DomUtil.addClass(t.attributionControl._container,"esri-truncated-attribution")}t.attributionControl._esriAttributionLayerCount=t.attributionControl._esriAttributionLayerCount+1}}function z(t){t.attributionControl&&(t.attributionControl._esriAttributionLayerCount&&1===t.attributionControl._esriAttributionLayerCount&&(t.attributionControl.setPrefix('<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'),c.DomUtil.removeClass(t.attributionControl._container,"esri-truncated-attribution:hover"),c.DomUtil.removeClass(t.attributionControl._container,"esri-truncated-attribution")),t.attributionControl._esriAttributionLayerCount=t.attributionControl._esriAttributionLayerCount-1)}function j(t){var e={geometry:null,geometryType:null};return t instanceof c.LatLngBounds?(e.geometry=T(t),e.geometryType="esriGeometryEnvelope",e):(t.getLatLng&&(t=t.getLatLng()),t instanceof c.LatLng&&(t={type:"Point",coordinates:[t.lng,t.lat]}),t instanceof c.GeoJSON&&(t=t.getLayers()[0].feature.geometry,e.geometry=O(t),e.geometryType=E(t.type)),t.toGeoJSON&&(t=t.toGeoJSON()),"Feature"===t.type&&(t=t.geometry),"Point"===t.type||"LineString"===t.type||"Polygon"===t.type||"MultiPolygon"===t.type?(e.geometry=O(t),e.geometryType=E(t.type),e):void v("invalid geometry passed to spatial query. Should be L.LatLng, L.LatLngBounds, L.Marker or a GeoJSON Point, Line, Polygon or MultiPolygon object"))}function N(t,e){r.cors&&m(t,{},c.Util.bind((function(t,i){if(!t){e._esriAttributions=[];for(var o=0;o<i.contributors.length;o++)for(var s=i.contributors[o],n=0;n<s.coverageAreas.length;n++){var r=s.coverageAreas[n],a=Object(c.latLng)(r.bbox[0],r.bbox[1]),l=Object(c.latLng)(r.bbox[2],r.bbox[3]);e._esriAttributions.push({attribution:s.attribution,score:r.score,bounds:Object(c.latLngBounds)(a,l),minZoom:r.zoomMin,maxZoom:r.zoomMax})}e._esriAttributions.sort((function(t,e){return e.score-t.score})),q({target:e})}}),this))}function q(t){var e=t.target,i=e._esriAttributions;if(e&&e.attributionControl){var o=e.attributionControl._container.querySelector(".esri-dynamic-attribution");if(o&&i){for(var s="",n=e.getBounds(),r=Object(c.latLngBounds)(n.getSouthWest().wrap(),n.getNorthEast().wrap()),a=e.getZoom(),l=0;l<i.length;l++){var u=i[l],h=u.attribution;!s.match(h)&&u.bounds.intersects(r)&&a>=u.minZoom&&a<=u.maxZoom&&(s+=", "+h)}s=s.substr(2),o.innerHTML=s,o.style.maxWidth=B(e),e.fire("attributionupdated",{attribution:s})}}}var Z={warn:v,cleanUrl:U,getUrlParams:R,isArcgisOnline:F,geojsonTypeToArcGIS:E,responseToFeatureCollection:A,geojsonToArcGIS:O,arcgisToGeoJSON:I,boundsToExtent:T,extentToBounds:k,calcAttributionWidth:B,setEsriAttribution:G,_setGeometry:j,_getAttributionData:N,_updateMapAttribution:q,_findIdAttributeFromFeature:M,_findIdAttributeFromResponse:D},Q=c.Class.extend({options:{proxy:!1,useCors:s},generateSetter:function(t,e){return c.Util.bind((function(e){return this.params[t]=e,this}),e)},initialize:function(t){if(t.request&&t.options?(this._service=t,c.Util.setOptions(this,t.options)):(c.Util.setOptions(this,t),this.options.url=U(t.url)),this.params=c.Util.extend({},this.params||{}),this.setters)for(var e in this.setters)this[e]=this.generateSetter(this.setters[e],this)},token:function(t){return this._service?this._service.authenticate(t):this.params.token=t,this},apikey:function(t){return this.token(t)},format:function(t){return this.params.returnUnformattedValues=!t,this},request:function(t,e){return this.options.requestParams&&c.Util.extend(this.params,this.options.requestParams),this._service?this._service.request(this.path,this.params,t,e):this._request("request",this.path,this.params,t,e)},_request:function(t,e,i,o,s){var n=this.options.proxy?this.options.proxy+"?"+this.options.url+e:this.options.url+e;return"get"!==t&&"request"!==t||this.options.useCors?y[t](n,i,o,s):y.get.JSONP(n,i,o,s)}});function W(t){return t=R(t),new Q(t)}var H=Q.extend({setters:{offset:"resultOffset",limit:"resultRecordCount",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",returnM:"returnM",transform:"datumTransformation",token:"token"},path:"query",params:{returnGeometry:!0,where:"1=1",outSR:4326,outFields:"*"},within:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelContains",this},intersects:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelIntersects",this},contains:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelWithin",this},crosses:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelCrosses",this},touches:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelTouches",this},overlaps:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelOverlaps",this},bboxIntersects:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelEnvelopeIntersects",this},indexIntersects:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelIndexIntersects",this},nearby:function(t,e){return t=Object(c.latLng)(t),this.params.geometry=[t.lng,t.lat],this.params.geometryType="esriGeometryPoint",this.params.spatialRel="esriSpatialRelIntersects",this.params.units="esriSRUnit_Meter",this.params.distance=e,this.params.inSR=4326,this},where:function(t){return this.params.where=t,this},between:function(t,e){return this.params.time=[t.valueOf(),e.valueOf()],this},simplify:function(t,e){var i=Math.abs(t.getBounds().getWest()-t.getBounds().getEast());return this.params.maxAllowableOffset=i/t.getSize().y*e,this},orderBy:function(t,e){return e=e||"ASC",this.params.orderByFields=this.params.orderByFields?this.params.orderByFields+",":"",this.params.orderByFields+=[t,e].join(" "),this},run:function(t,e){return this._cleanParams(),this.options.isModern||F(this.options.url)&&void 0===this.options.isModern?(this.params.f="geojson",this.request((function(i,o){this._trapSQLerrors(i),t.call(e,i,o,o)}),this)):this.request((function(i,o){this._trapSQLerrors(i),t.call(e,i,o&&A(o),o)}),this)},count:function(t,e){return this._cleanParams(),this.params.returnCountOnly=!0,this.request((function(e,i){t.call(this,e,i&&i.count,i)}),e)},ids:function(t,e){return this._cleanParams(),this.params.returnIdsOnly=!0,this.request((function(e,i){t.call(this,e,i&&i.objectIds,i)}),e)},bounds:function(t,e){return this._cleanParams(),this.params.returnExtentOnly=!0,this.request((function(i,o){o&&o.extent&&k(o.extent)?t.call(e,i,k(o.extent),o):t.call(e,i={message:"Invalid Bounds"},null,o)}),e)},distinct:function(){return this.params.returnGeometry=!1,this.params.returnDistinctValues=!0,this},pixelSize:function(t){var e=Object(c.point)(t);return this.params.pixelSize=[e.x,e.y],this},layer:function(t){return this.path=t+"/query",this},_trapSQLerrors:function(t){t&&"400"===t.code&&v("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")},_cleanParams:function(){delete this.params.returnIdsOnly,delete this.params.returnExtentOnly,delete this.params.returnCountOnly},_setGeometryParams:function(t){this.params.inSR=4326;var e=j(t);this.params.geometry=e.geometry,this.params.geometryType=e.geometryType}});function K(t){return new H(t)}var J=K,V=Q.extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs:function(t,e){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[t,e].join(":"),this},simplify:function(t,e){var i=Math.abs(t.getBounds().getWest()-t.getBounds().getEast());return this.params.maxAllowableOffset=i/t.getSize().y*e,this},run:function(t,e){return this.request((function(i,o){t.call(e,i,o&&A(o),o)}),e)}});function X(t){return new V(t)}var $=X,Y=Q.extend({path:"identify",between:function(t,e){return this.params.time=[t.valueOf(),e.valueOf()],this}});function tt(t){return new Y(t)}var et=Y.extend({setters:{layers:"layers",precision:"geometryPrecision",tolerance:"tolerance",returnGeometry:"returnGeometry"},params:{sr:4326,layers:"all",tolerance:3,returnGeometry:!0},on:function(t){var e=T(t.getBounds()),i=t.getSize();return this.params.imageDisplay=[i.x,i.y,96],this.params.mapExtent=[e.xmin,e.ymin,e.xmax,e.ymax],this},at:function(t){return 2===t.length&&(t=Object(c.latLng)(t)),this._setGeometryParams(t),this},layerDef:function(t,e){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[t,e].join(":"),this},simplify:function(t,e){var i=Math.abs(t.getBounds().getWest()-t.getBounds().getEast());return this.params.maxAllowableOffset=i/t.getSize().y*e,this},run:function(t,e){return this.request((function(i,o){if(i)t.call(e,i,void 0,o);else{var s=A(o);o.results=o.results.reverse();for(var n=0;n<s.features.length;n++)s.features[n].layerId=o.results[n].layerId;t.call(e,void 0,s,o)}}))},_setGeometryParams:function(t){var e=j(t);this.params.geometry=e.geometry,this.params.geometryType=e.geometryType}});function it(t){return new et(t)}var ot=it,st=Y.extend({setters:{setMosaicRule:"mosaicRule",setRenderingRule:"renderingRule",setPixelSize:"pixelSize",returnCatalogItems:"returnCatalogItems",returnGeometry:"returnGeometry"},params:{returnGeometry:!1},at:function(t){return t=Object(c.latLng)(t),this.params.geometry=JSON.stringify({x:t.lng,y:t.lat,spatialReference:{wkid:4326}}),this.params.geometryType="esriGeometryPoint",this},getMosaicRule:function(){return this.params.mosaicRule},getRenderingRule:function(){return this.params.renderingRule},getPixelSize:function(){return this.params.pixelSize},run:function(t,e){return this.request((function(i,o){t.call(e,i,o&&this._responseToGeoJSON(o),o)}),this)},_responseToGeoJSON:function(t){var e=t.location,i=t.catalogItems,o=t.catalogItemVisibilities,s={pixel:{type:"Feature",geometry:{type:"Point",coordinates:[e.x,e.y]},crs:{type:"EPSG",properties:{code:e.spatialReference.wkid}},properties:{OBJECTID:t.objectId,name:t.name,value:t.value},id:t.objectId}};if(t.properties&&t.properties.Values&&(s.pixel.properties.values=t.properties.Values),i&&i.features&&(s.catalogItems=A(i),o&&o.length===s.catalogItems.features.length))for(var n=o.length-1;n>=0;n--)s.catalogItems.features[n].properties.catalogItemVisibility=o[n];return s}});function nt(t){return new st(t)}var rt=nt,at=c.Evented.extend({options:{proxy:!1,useCors:s,timeout:0},initialize:function(t){t=t||{},this._requestQueue=[],this._authenticating=!1,c.Util.setOptions(this,t),this.options.url=U(this.options.url)},get:function(t,e,i,o){return this._request("get",t,e,i,o)},post:function(t,e,i,o){return this._request("post",t,e,i,o)},request:function(t,e,i,o){return this._request("request",t,e,i,o)},metadata:function(t,e){return this._request("get","",{},t,e)},authenticate:function(t){return this._authenticating=!1,this.options.token=t,this._runQueue(),this},getTimeout:function(){return this.options.timeout},setTimeout:function(t){this.options.timeout=t},_request:function(t,e,i,o,s){this.fire("requeststart",{url:this.options.url+e,params:i,method:t},!0);var n=this._createServiceCallback(t,e,i,o,s);if(this.options.token&&(i.token=this.options.token),this.options.requestParams&&c.Util.extend(i,this.options.requestParams),!this._authenticating){var r=this.options.proxy?this.options.proxy+"?"+this.options.url+e:this.options.url+e;return"get"!==t&&"request"!==t||this.options.useCors?y[t](r,i,n,s):y.get.JSONP(r,i,n,s)}this._requestQueue.push([t,e,i,o,s])},_createServiceCallback:function(t,e,i,o,s){return c.Util.bind((function(n,r){!n||499!==n.code&&498!==n.code||(this._authenticating=!0,this._requestQueue.push([t,e,i,o,s]),this.fire("authenticationrequired",{authenticate:c.Util.bind(this.authenticate,this)},!0),n.authenticate=c.Util.bind(this.authenticate,this)),o.call(s,n,r),n?this.fire("requesterror",{url:this.options.url+e,params:i,message:n.message,code:n.code,method:t},!0):this.fire("requestsuccess",{url:this.options.url+e,params:i,response:r,method:t},!0),this.fire("requestend",{url:this.options.url+e,params:i,method:t},!0)}),this)},_runQueue:function(){for(var t=this._requestQueue.length-1;t>=0;t--){var e=this._requestQueue[t];this[e.shift()].apply(this,e)}this._requestQueue=[]}});function ct(t){return t=R(t),new at(t)}var lt=at.extend({identify:function(){return ot(this)},find:function(){return $(this)},query:function(){return J(this)}});function ut(t){return new lt(t)}var ht=ut,pt=at.extend({query:function(){return J(this)},identify:function(){return rt(this)}});function dt(t){return new pt(t)}var mt=dt,ft=at.extend({options:{idAttribute:"OBJECTID"},query:function(){return J(this)},addFeature:function(t,e,i){this.addFeatures(t,e,i)},addFeatures:function(t,e,i){for(var o=t.features?t.features:[t],s=o.length-1;s>=0;s--)delete o[s].id;return t=O(t),this.post("addFeatures",{features:t=o.length>1?t:[t]},(function(t,o){e&&e.call(i,t||o.addResults[0].error,o&&o.addResults?o.addResults.length>1?o.addResults:o.addResults[0]:void 0)}),i)},updateFeature:function(t,e,i){this.updateFeatures(t,e,i)},updateFeatures:function(t,e,i){var o=t.features?t.features:[t];return t=O(t,this.options.idAttribute),this.post("updateFeatures",{features:t=o.length>1?t:[t]},(function(t,o){e&&e.call(i,t||o.updateResults[0].error,o&&o.updateResults?o.updateResults.length>1?o.updateResults:o.updateResults[0]:void 0)}),i)},deleteFeature:function(t,e,i){this.deleteFeatures(t,e,i)},deleteFeatures:function(t,e,i){return this.post("deleteFeatures",{objectIds:t},(function(t,o){e&&e.call(i,t||o.deleteResults[0].error,o&&o.deleteResults?o.deleteResults.length>1?o.deleteResults:o.deleteResults[0]:void 0)}),i)}});function gt(t){return new ft(t)}var vt=gt,yt="https:"!==window.location.protocol?"http:":"https:",bt=c.TileLayer.extend({statics:{TILES:{Streets:{urlTemplate:yt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Street_Map"}},Topographic:{urlTemplate:yt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Topo_Map"}},Oceans:{urlTemplate:yt+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/Ocean_Basemap"}},OceansLabels:{urlTemplate:yt+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:n?"esri-labels":"tilePane",attribution:""}},NationalGeographic:{urlTemplate:yt+"//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"National Geographic, DeLorme, HERE, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, increment P Corp."}},DarkGray:{urlTemplate:yt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},DarkGrayLabels:{urlTemplate:yt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:n?"esri-labels":"tilePane",attribution:""}},Gray:{urlTemplate:yt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},GrayLabels:{urlTemplate:yt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:n?"esri-labels":"tilePane",attribution:""}},Imagery:{urlTemplate:yt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}},ImageryLabels:{urlTemplate:yt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:n?"esri-labels":"tilePane",attribution:""}},ImageryTransportation:{urlTemplate:yt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:n?"esri-labels":"tilePane",attribution:""}},ShadedRelief:{urlTemplate:yt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS"}},ShadedReliefLabels:{urlTemplate:yt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:12,subdomains:["server","services"],pane:n?"esri-labels":"tilePane",attribution:""}},Terrain:{urlTemplate:yt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS, NOAA"}},TerrainLabels:{urlTemplate:yt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],pane:n?"esri-labels":"tilePane",attribution:""}},USATopo:{urlTemplate:yt+"//{s}.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:15,subdomains:["server","services"],attribution:"USGS, National Geographic Society, i-cubed"}},ImageryClarity:{urlTemplate:yt+"//clarity.maptiles.arcgis.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community"}},Physical:{urlTemplate:yt+"//{s}.arcgisonline.com/arcgis/rest/services/World_Physical_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:8,subdomains:["server","services"],attribution:"U.S. National Park Service"}},ImageryFirefly:{urlTemplate:yt+"//fly.maptiles.arcgis.com/arcgis/rest/services/World_Imagery_Firefly/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}}}},initialize:function(t,e){var i;if("object"==typeof t&&t.urlTemplate&&t.options)i=t;else{if("string"!=typeof t||!bt.TILES[t])throw new Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Physical", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ImageryClarity", "ImageryFirefly", ShadedRelief", "ShadedReliefLabels", "Terrain", "TerrainLabels" or "USATopo"');i=bt.TILES[t]}var o=c.Util.extend(i.options,e);c.Util.setOptions(this,o),this.options.token&&-1===i.urlTemplate.indexOf("token=")&&(i.urlTemplate+="?token="+this.options.token),this.options.proxy&&(i.urlTemplate=this.options.proxy+"?"+i.urlTemplate),c.TileLayer.prototype.initialize.call(this,i.urlTemplate,o)},onAdd:function(t){G(t),"esri-labels"===this.options.pane&&this._initPane(),this.options.attributionUrl&&N((this.options.proxy?this.options.proxy+"?":"")+this.options.attributionUrl,t),t.on("moveend",q),c.TileLayer.prototype.onAdd.call(this,t)},onRemove:function(t){z(t),t.off("moveend",q),c.TileLayer.prototype.onRemove.call(this,t)},_initPane:function(){if(!this._map.getPane(this.options.pane)){var t=this._map.createPane(this.options.pane);t.style.pointerEvents="none",t.style.zIndex=500}},getAttribution:function(){if(this.options.attribution)var t='<span class="esri-dynamic-attribution">'+this.options.attribution+"</span>";return t}});function _t(t,e){return new bt(t,e)}var xt=c.TileLayer.extend({options:{zoomOffsetAllowance:.1,errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAA1BMVEUzNDVszlHHAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAAAAAAAAAB6mUWpAAAADZJREFUeJztwQEBAAAAgiD/r25IQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7waBAAABw08RwAAAAABJRU5ErkJggg=="},statics:{MercatorZoomLevels:{0:156543.033928,1:78271.5169639999,2:39135.7584820001,3:19567.8792409999,4:9783.93962049996,5:4891.96981024998,6:2445.98490512499,7:1222.99245256249,8:611.49622628138,9:305.748113140558,10:152.874056570411,11:76.4370282850732,12:38.2185141425366,13:19.1092570712683,14:9.55462853563415,15:4.77731426794937,16:2.38865713397468,17:1.19432856685505,18:.597164283559817,19:.298582141647617,20:.14929107082381,21:.07464553541191,22:.0373227677059525,23:.0186613838529763}},initialize:function(t){t=R(t=c.Util.setOptions(this,t)),this.tileUrl=(t.proxy?t.proxy+"?":"")+t.url+"tile/{z}/{y}/{x}"+(t.requestParams&&Object.keys(t.requestParams).length>0?c.Util.getParamString(t.requestParams):""),-1!==t.url.indexOf("{s}")&&t.subdomains&&(t.url=t.url.replace("{s}",t.subdomains[0])),this.service=ht(t),this.service.addEventParent(this),new RegExp(/tiles.arcgis(online)?\.com/g).test(t.url)&&(this.tileUrl=this.tileUrl.replace("://tiles","://tiles{s}"),t.subdomains=["1","2","3","4"]),this.options.token&&(this.tileUrl+="?token="+this.options.token),c.TileLayer.prototype.initialize.call(this,this.tileUrl,t)},getTileUrl:function(t){var e=this._getZoomForUrl();return c.Util.template(this.tileUrl,c.Util.extend({s:this._getSubdomain(t),x:t.x,y:t.y,z:this._lodMap&&this._lodMap[e]?this._lodMap[e]:e},this.options))},createTile:function(t,e){var i=document.createElement("img");return c.DomEvent.on(i,"load",c.Util.bind(this._tileOnLoad,this,e,i)),c.DomEvent.on(i,"error",c.Util.bind(this._tileOnError,this,e,i)),this.options.crossOrigin&&(i.crossOrigin=""),i.alt="",!this._lodMap||this._lodMap&&this._lodMap[this._getZoomForUrl()]?i.src=this.getTileUrl(t):this.once("lodmap",(function(){i.src=this.getTileUrl(t)}),this),i},onAdd:function(t){G(t),this._lodMap||this.metadata((function(e,i){if(!e&&i.spatialReference){var o=i.spatialReference.latestWkid||i.spatialReference.wkid;if(!this.options.attribution&&t.attributionControl&&i.copyrightText&&(this.options.attribution=i.copyrightText,t.attributionControl.addAttribution(this.getAttribution())),t.options.crs!==c.CRS.EPSG3857||102100!==o&&3857!==o)t.options.crs&&t.options.crs.code&&t.options.crs.code.indexOf(o)>-1||v("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet http://esri.github.io/esri-leaflet/examples/non-mercator-projection.html");else{this._lodMap={};for(var s=i.tileInfo.lods,n=xt.MercatorZoomLevels,r=0;r<s.length;r++){var a=s[r];for(var l in n)if(this._withinPercentage(a.resolution,n[l],this.options.zoomOffsetAllowance)){this._lodMap[l]=a.level;break}}this.fire("lodmap")}}}),this),c.TileLayer.prototype.onAdd.call(this,t)},onRemove:function(t){z(t),c.TileLayer.prototype.onRemove.call(this,t)},metadata:function(t,e){return this.service.metadata(t,e),this},identify:function(){return this.service.identify()},find:function(){return this.service.find()},query:function(){return this.service.query()},authenticate:function(t){var e="?token="+t;return this.tileUrl=this.options.token?this.tileUrl.replace(/\?token=(.+)/g,e):this.tileUrl+e,this.options.token=t,this.service.authenticate(t),this},_withinPercentage:function(t,e,i){return Math.abs(t/e-1)<i}});function Lt(t,e){return new xt(t,e)}var Ct=c.ImageOverlay.extend({onAdd:function(t){this._topLeft=t.getPixelBounds().min,c.ImageOverlay.prototype.onAdd.call(this,t)},_reset:function(){this._map.options.crs===c.CRS.EPSG3857?c.ImageOverlay.prototype._reset.call(this):c.DomUtil.setPosition(this._image,this._topLeft.subtract(this._map.getPixelOrigin()))}}),St=c.Layer.extend({options:{opacity:1,position:"front",f:"image",useCors:s,attribution:null,interactive:!1,alt:""},onAdd:function(t){G(t),this.options.zIndex&&(this.options.position=null),this._update=c.Util.throttle(this._update,this.options.updateInterval,this),t.on("moveend",this._update,this),this._currentImage&&this._currentImage._bounds.equals(this._map.getBounds())?t.addLayer(this._currentImage):this._currentImage&&(this._map.removeLayer(this._currentImage),this._currentImage=null),this._update(),this._popup&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this.metadata((function(e,i){!e&&!this.options.attribution&&t.attributionControl&&i.copyrightText&&(this.options.attribution=i.copyrightText,t.attributionControl.addAttribution(this.getAttribution()))}),this)},onRemove:function(t){z(t),this._currentImage&&this._map.removeLayer(this._currentImage),this._popup&&(this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._map.off("moveend",this._update,this)},bindPopup:function(t,e){return this._shouldRenderPopup=!1,this._lastClick=!1,this._popup=Object(c.popup)(e),this._popupFunction=t,this._map&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this},unbindPopup:function(){return this._map&&(this._map.closePopup(this._popup),this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._popup=!1,this},bringToFront:function(){return this.options.position="front",this._currentImage&&(this._currentImage.bringToFront(),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this.options.position="back",this._currentImage&&(this._currentImage.bringToBack(),this._setAutoZIndex(Math.min)),this},setZIndex:function(t){return this.options.zIndex=t,this._currentImage&&this._currentImage.setZIndex(t),this},_setAutoZIndex:function(t){if(this._currentImage){for(var e,i=this._currentImage.getPane().children,o=-t(-1/0,1/0),s=0,n=i.length;s<n;s++)e=i[s].style.zIndex,i[s]!==this._currentImage._image&&e&&(o=t(o,+e));isFinite(o)&&(this.options.zIndex=o+t(-1,1),this.setZIndex(this.options.zIndex))}},getAttribution:function(){return this.options.attribution},getOpacity:function(){return this.options.opacity},setOpacity:function(t){return this.options.opacity=t,this._currentImage&&this._currentImage.setOpacity(t),this},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(t,e){return this.options.from=t,this.options.to=e,this._update(),this},metadata:function(t,e){return this.service.metadata(t,e),this},authenticate:function(t){return this.service.authenticate(t),this},redraw:function(){this._update()},_renderImage:function(t,e,i){if(this._map){if(i&&(t="data:"+i+";base64,"+t),!t)return;var o=new Ct(t,e,{opacity:0,crossOrigin:this.options.withCredentials?"use-credentials":this.options.useCors,alt:this.options.alt,pane:this.options.pane||this.getPane(),interactive:this.options.interactive}).addTo(this._map),s=function(t){if(o.off("error",s,this),this._map){var i=t.target,n=this._currentImage;i._bounds.equals(e)&&i._bounds.equals(this._map.getBounds())?(this._currentImage=i,"front"===this.options.position?this.bringToFront():"back"===this.options.position&&this.bringToBack(),this.options.zIndex&&this.setZIndex(this.options.zIndex),this._map&&this._currentImage._map?this._currentImage.setOpacity(this.options.opacity):this._currentImage._map.removeLayer(this._currentImage),n&&this._map&&this._map.removeLayer(n),n&&n._map&&n._map.removeLayer(n)):this._map.removeLayer(i)}this.fire("load",{bounds:e})};o.once("error",(function(){this._map.removeLayer(o),this.fire("error"),o.off("load",s,this)}),this),o.once("load",s,this)}},_update:function(){if(this._map){var t=this._map.getZoom(),e=this._map.getBounds();if(!(this._animatingZoom||this._map._panTransition&&this._map._panTransition._inProgress))if(t>this.options.maxZoom||t<this.options.minZoom)this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null);else{var i=this._buildExportParams();c.Util.extend(i,this.options.requestParams),i?(this._requestExport(i,e),this.fire("loading",{bounds:e})):this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null)}}},_renderPopup:function(t,e,i,o){if(t=Object(c.latLng)(t),this._shouldRenderPopup&&this._lastClick.equals(t)){var s=this._popupFunction(e,i,o);s&&this._popup.setLatLng(t).setContent(s).openOn(this._map)}},_resetPopupState:function(t){this._shouldRenderPopup=!1,this._lastClick=t.latlng},_calculateBbox:function(){var t=this._map.getPixelBounds(),e=this._map.unproject(t.getBottomLeft()),i=this._map.unproject(t.getTopRight()),o=this._map.options.crs.project(i),s=this._map.options.crs.project(e),n=Object(c.bounds)(o,s);return[n.getBottomLeft().x,n.getBottomLeft().y,n.getTopRight().x,n.getTopRight().y].join(",")},_calculateImageSize:function(){var t=this._map.getPixelBounds(),e=this._map.getSize(),i=this._map.unproject(t.getBottomLeft()),o=this._map.unproject(t.getTopRight()),s=this._map.latLngToLayerPoint(o).y,n=this._map.latLngToLayerPoint(i).y;return(s>0||n<e.y)&&(e.y=n-s),e.x+","+e.y}}),wt=St.extend({options:{updateInterval:150,format:"jpgpng",transparent:!0,f:"image"},query:function(){return this.service.query()},identify:function(){return this.service.identify()},initialize:function(t){t=R(t),this.service=mt(t),this.service.addEventParent(this),c.Util.setOptions(this,t)},setPixelType:function(t){return this.options.pixelType=t,this._update(),this},getPixelType:function(){return this.options.pixelType},setBandIds:function(t){return this.options.bandIds=c.Util.isArray(t)?t.join(","):t.toString(),this._update(),this},getBandIds:function(){return this.options.bandIds},setNoData:function(t,e){return this.options.noData=c.Util.isArray(t)?t.join(","):t.toString(),e&&(this.options.noDataInterpretation=e),this._update(),this},getNoData:function(){return this.options.noData},getNoDataInterpretation:function(){return this.options.noDataInterpretation},setRenderingRule:function(t){this.options.renderingRule=t,this._update()},getRenderingRule:function(){return this.options.renderingRule},setMosaicRule:function(t){this.options.mosaicRule=t,this._update()},getMosaicRule:function(){return this.options.mosaicRule},_getPopupData:function(t){var e=c.Util.bind((function(e,i,o){e||setTimeout(c.Util.bind((function(){this._renderPopup(t.latlng,e,i,o)}),this),300)}),this),i=this.identify().at(t.latlng);this.options.mosaicRule&&i.setMosaicRule(this.options.mosaicRule),i.run(e),this._shouldRenderPopup=!0,this._lastClick=t.latlng},_buildExportParams:function(){var t=parseInt(this._map.options.crs.code.split(":")[1],10),e={bbox:this._calculateBbox(),size:this._calculateImageSize(),format:this.options.format,transparent:this.options.transparent,bboxSR:t,imageSR:t};return this.options.from&&this.options.to&&(e.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.options.pixelType&&(e.pixelType=this.options.pixelType),this.options.interpolation&&(e.interpolation=this.options.interpolation),this.options.compressionQuality&&(e.compressionQuality=this.options.compressionQuality),this.options.bandIds&&(e.bandIds=this.options.bandIds),(0===this.options.noData||this.options.noData)&&(e.noData=this.options.noData),this.options.noDataInterpretation&&(e.noDataInterpretation=this.options.noDataInterpretation),this.service.options.token&&(e.token=this.service.options.token),this.options.renderingRule&&(e.renderingRule=JSON.stringify(this.options.renderingRule)),this.options.mosaicRule&&(e.mosaicRule=JSON.stringify(this.options.mosaicRule)),e},_requestExport:function(t,e){if("json"===this.options.f)this.service.request("exportImage",t,(function(t,i){t||(this.options.token&&(i.href+="?token="+this.options.token),this.options.proxy&&(i.href=this.options.proxy+"?"+i.href),this._renderImage(i.href,e))}),this);else{t.f="image";var i=this.options.url+"exportImage"+c.Util.getParamString(t);this.options.proxy&&(i=this.options.proxy+"?"+i),this._renderImage(i,e)}}});function Ot(t,e){return new wt(t,e)}var It=St.extend({options:{updateInterval:150,layers:!1,layerDefs:!1,timeOptions:!1,format:"png32",transparent:!0,f:"json"},initialize:function(t){t=R(t),this.service=ht(t),this.service.addEventParent(this),c.Util.setOptions(this,t)},getDynamicLayers:function(){return this.options.dynamicLayers},setDynamicLayers:function(t){return this.options.dynamicLayers=t,this._update(),this},getLayers:function(){return this.options.layers},setLayers:function(t){return this.options.layers=t,this._update(),this},getLayerDefs:function(){return this.options.layerDefs},setLayerDefs:function(t){return this.options.layerDefs=t,this._update(),this},getTimeOptions:function(){return this.options.timeOptions},setTimeOptions:function(t){return this.options.timeOptions=t,this._update(),this},query:function(){return this.service.query()},identify:function(){return this.service.identify()},find:function(){return this.service.find()},_getPopupData:function(t){var e,i=c.Util.bind((function(e,i,o){e||setTimeout(c.Util.bind((function(){this._renderPopup(t.latlng,e,i,o)}),this),300)}),this);if((e=this.options.popup?this.options.popup.on(this._map).at(t.latlng):this.identify().on(this._map).at(t.latlng)).params.maxAllowableOffset||e.simplify(this._map,.5),this.options.popup&&this.options.popup.params&&this.options.popup.params.layers||e.layers(this.options.layers?"visible:"+this.options.layers.join(","):"visible"),this.options.layerDefs&&"string"!=typeof this.options.layerDefs&&!e.params.layerDefs)for(var o in this.options.layerDefs)this.options.layerDefs.hasOwnProperty(o)&&e.layerDef(o,this.options.layerDefs[o]);e.run(i),this._shouldRenderPopup=!0,this._lastClick=t.latlng},_buildExportParams:function(){var t=parseInt(this._map.options.crs.code.split(":")[1],10),e={bbox:this._calculateBbox(),size:this._calculateImageSize(),dpi:96,format:this.options.format,transparent:this.options.transparent,bboxSR:t,imageSR:t};if(this.options.dynamicLayers&&(e.dynamicLayers=this.options.dynamicLayers),this.options.layers){if(0===this.options.layers.length)return;e.layers="show:"+this.options.layers.join(",")}return this.options.layerDefs&&(e.layerDefs="string"==typeof this.options.layerDefs?this.options.layerDefs:JSON.stringify(this.options.layerDefs)),this.options.timeOptions&&(e.timeOptions=JSON.stringify(this.options.timeOptions)),this.options.from&&this.options.to&&(e.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.service.options.token&&(e.token=this.service.options.token),this.options.proxy&&(e.proxy=this.options.proxy),this.options.disableCache&&(e._ts=Date.now()),e},_requestExport:function(t,e){if("json"===this.options.f)this.service.request("export",t,(function(t,i){t||(this.options.token&&i.href&&(i.href+="?token="+this.options.token),this.options.proxy&&i.href&&(i.href=this.options.proxy+"?"+i.href),i.href?this._renderImage(i.href,e):this._renderImage(i.imageData,e,i.contentType))}),this);else{t.f="image";var i=this.options.url+"export"+c.Util.getParamString(t);this.options.proxy&&(i=this.options.proxy+"?"+i),this._renderImage(i,e)}}});function kt(t,e){return new It(t,e)}var Tt=c.Layer.extend({options:{cellSize:512,updateWhenIdle:c.Browser.mobile,updateInterval:150,noWrap:!1,keepBuffer:1.5},initialize:function(t){c.Util.setOptions(this,t)},onAdd:function(t){this._cells={},this._activeCells={},this._resetView(),this._update()},onRemove:function(t){this._removeAllCells(),this._cellZoom=void 0},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllCells(),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=c.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),t},createCell:function(){return document.createElement("div")},removeCell:function(){},reuseCell:function(){},cellLeave:function(){},cellEnter:function(){},getCellSize:function(){var t=this.options.cellSize;return t instanceof c.Point?t:new c.Point(t,t)},_pruneCells:function(){if(this._map){var t,e;for(t in this._cells)(e=this._cells[t]).retain=e.current;for(t in this._cells)if((e=this._cells[t]).current&&!e.active){var i=e.coords;this._retainParent(i.x,i.y,i.z,i.z-5)||this._retainChildren(i.x,i.y,i.z,i.z+2)}for(t in this._cells)this._cells[t].retain||this._removeCell(t)}},_removeAllCells:function(){for(var t in this._cells)this._removeCell(t)},_invalidateAll:function(){this._removeAllCells(),this._cellZoom=void 0},_retainParent:function(t,e,i,o){var s=Math.floor(t/2),n=Math.floor(e/2),r=i-1,a=new c.Point(+s,+n);a.z=+r;var l=this._cellCoordsToKey(a),u=this._cells[l];return u&&u.active?(u.retain=!0,!0):(u&&u.loaded&&(u.retain=!0),r>o&&this._retainParent(s,n,r,o))},_retainChildren:function(t,e,i,o){for(var s=2*t;s<2*t+2;s++)for(var n=2*e;n<2*e+2;n++){var r=new c.Point(s,n);r.z=i+1;var a=this._cellCoordsToKey(r),l=this._cells[a];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),i+1<o&&this._retainChildren(s,n,i+1,o))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);e||this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_setView:function(t,e,i,o){var s=Math.round(e);o||(this._cellZoom=s,this._abortLoading&&this._abortLoading(),this._resetGrid(),void 0!==s&&this._update(t),i||this._pruneCells(),this._noPrune=!!i)},_resetGrid:function(){var t=this._map,e=t.options.crs,i=this._cellSize=this.getCellSize(),o=this._cellZoom,s=this._map.getPixelWorldBounds(this._cellZoom);s&&(this._globalCellRange=this._pxBoundsToCellRange(s)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],o).x/i.x),Math.ceil(t.project([0,e.wrapLng[1]],o).x/i.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],o).y/i.x),Math.ceil(t.project([e.wrapLat[1],0],o).y/i.y)]},_onMoveEnd:function(t){t&&(t.pinch||t.flyTo)||!this._map||this._map._animatingZoom||this._update()},_getCelldPixelBounds:function(t){var e=this._map,i=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),o=e.getZoomScale(i,this._cellZoom),s=e.project(t,this._cellZoom).floor(),n=e.getSize().divideBy(2*o);return new c.Bounds(s.subtract(n),s.add(n))},_update:function(t){var e=this._map;if(e){var i=Math.round(e.getZoom());void 0===t&&(t=e.getCenter());var o=this._getCelldPixelBounds(t),s=this._pxBoundsToCellRange(o),n=s.getCenter(),r=[],a=this.options.keepBuffer,l=new c.Bounds(s.getBottomLeft().subtract([a,-a]),s.getTopRight().add([a,-a]));if(!(isFinite(s.min.x)&&isFinite(s.min.y)&&isFinite(s.max.x)&&isFinite(s.max.y)))throw new Error("Attempted to load an infinite number of cells");for(var u in this._cells){var h=this._cells[u].coords;h.z===this._cellZoom&&l.contains(new c.Point(h.x,h.y))||(this._cells[u].current=!1)}if(Math.abs(i-this._cellZoom)>1)this._setView(t,i);else{for(var p=s.min.y;p<=s.max.y;p++)for(var d=s.min.x;d<=s.max.x;d++){var m=new c.Point(d,p);if(m.z=this._cellZoom,this._isValidCell(m)){var f=this._cells[this._cellCoordsToKey(m)];f?f.current=!0:r.push(m)}}if(r.sort((function(t,e){return t.distanceTo(n)-e.distanceTo(n)})),0!==r.length)for(this._loading||(this._loading=!0),d=0;d<r.length;d++){var g=this._cellCoordsToKey(r[d]),v=this._keyToCellCoords(g);this._activeCells[v]?this._reuseCell(r[d]):this._createCell(r[d])}}}},_isValidCell:function(t){var e=this._map.options.crs;if(!e.infinite){var i=this._globalCellRange;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;var o=this._cellCoordsToBounds(t);return Object(c.toLatLngBounds)(this.options.bounds).overlaps(o)},_keyToBounds:function(t){return this._cellCoordsToBounds(this._keyToCellCoords(t))},_cellCoordsToNwSe:function(t){var e=this._map,i=this.getCellSize(),o=t.scaleBy(i),s=o.add(i);return[e.unproject(o,t.z),e.unproject(s,t.z)]},_cellCoordsToBounds:function(t){var e=this._cellCoordsToNwSe(t),i=new c.LatLngBounds(e[0],e[1]);return this.options.noWrap||(i=this._map.wrapLatLngBounds(i)),i},_cellCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToCellCoords:function(t){var e=t.split(":"),i=new c.Point(+e[0],+e[1]);return i.z=+e[2],i},_removeCell:function(t){var e=this._cells[t];if(e){var i=this._keyToCellCoords(t),o=this._wrapCoords(i),s=this._cellCoordsToBounds(this._wrapCoords(i));e.current=!1,delete this._cells[t],this._activeCells[t]=e,this.cellLeave(s,o,t),this.fire("cellleave",{key:t,coords:o,bounds:s})}},_reuseCell:function(t){var e=this._cellCoordsToKey(t);this._cells[e]=this._activeCells[e],this._cells[e].current=!0;var i=this._wrapCoords(t),o=this._cellCoordsToBounds(this._wrapCoords(t));this.cellEnter(o,i,e),this.fire("cellenter",{key:e,coords:i,bounds:o})},_createCell:function(t){var e=this._cellCoordsToKey(t),i=this._wrapCoords(t),o=this._cellCoordsToBounds(this._wrapCoords(t));this.createCell(o,i,e),this.fire("cellcreate",{key:e,coords:i,bounds:o}),this._cells[e]={coords:t,current:!0},c.Util.requestAnimFrame(this._pruneCells,this)},_cellReady:function(t,e,i){var o=this._cellCoordsToKey(t);(i=this._cells[o])&&(i.loaded=+new Date,i.active=!0)},_getCellPos:function(t){return t.scaleBy(this.getCellSize())},_wrapCoords:function(t){var e=new c.Point(this._wrapX?c.Util.wrapNum(t.x,this._wrapX):t.x,this._wrapY?c.Util.wrapNum(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToCellRange:function(t){var e=this.getCellSize();return new c.Bounds(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))}});function Pt(t){this.values=[].concat(t||[])}Pt.prototype.query=function(t){var e=this.getIndex(t);return this.values[e]},Pt.prototype.getIndex=function(t){this.dirty&&this.sort();for(var e,i,o=0,s=this.values.length-1;o<=s;)if(e=(o+s)/2|0,+(i=this.values[Math.round(e)]).value<+t)o=e+1;else{if(!(+i.value>+t))return e;s=e-1}return Math.abs(~s)},Pt.prototype.between=function(t,e){var i=this.getIndex(t),o=this.getIndex(e);if(0===i&&0===o)return[];for(;this.values[i-1]&&this.values[i-1].value===t;)i--;for(;this.values[o+1]&&this.values[o+1].value===e;)o++;return this.values[o]&&this.values[o].value===e&&this.values[o+1]&&o++,this.values.slice(i,o)},Pt.prototype.insert=function(t){return this.values.splice(this.getIndex(t.value),0,t),this},Pt.prototype.bulkAdd=function(t,e){return this.values=this.values.concat([].concat(t||[])),e?this.sort():this.dirty=!0,this},Pt.prototype.sort=function(){return this.values.sort((function(t,e){return+e.value-+t.value})).reverse(),this.dirty=!1,this};var Dt=Pt,Mt=Tt.extend({options:{attribution:null,where:"1=1",fields:["*"],from:!1,to:!1,timeField:!1,timeFilterMode:"server",simplifyFactor:0,precision:6,fetchAllFeatures:!1},initialize:function(t){if(Tt.prototype.initialize.call(this,t),t=R(t),t=c.Util.setOptions(this,t),this.service=vt(t),this.service.addEventParent(this),"*"!==this.options.fields[0]){for(var e=!1,i=0;i<this.options.fields.length;i++)this.options.fields[i].match(/^(OBJECTID|FID|OID|ID)$/i)&&(e=!0);!1===e&&v("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")}this.options.timeField.start&&this.options.timeField.end?(this._startTimeIndex=new Dt,this._endTimeIndex=new Dt):this.options.timeField&&(this._timeIndex=new Dt),this._cache={},this._currentSnapshot=[],this._activeRequests=0},onAdd:function(t){return G(t),this.service.metadata((function(e,i){if(!e){var o=i.supportedQueryFormats,s=!1;(!1===this.service.options.isModern||this.options.fetchAllFeatures)&&(s=!0),!s&&o&&-1!==o.indexOf("geoJSON")&&(this.service.options.isModern=!0),i.objectIdField&&(this.service.options.idAttribute=i.objectIdField),!this.options.attribution&&t.attributionControl&&i.copyrightText&&(this.options.attribution=i.copyrightText,t.attributionControl.addAttribution(this.getAttribution()))}}),this),t.on("zoomend",this._handleZoomChange,this),Tt.prototype.onAdd.call(this,t)},onRemove:function(t){return z(t),t.off("zoomend",this._handleZoomChange,this),Tt.prototype.onRemove.call(this,t)},getAttribution:function(){return this.options.attribution},createCell:function(t,e){this._visibleZoom()&&this._requestFeatures(t,e)},_requestFeatures:function(t,e,i,o){this._activeRequests++,o=o||0;var s=this.options.where;return 1===this._activeRequests&&this.fire("loading",{bounds:t},!0),this._buildQuery(t,o).run((function(n,r,a){a&&a.exceededTransferLimit&&this.fire("drawlimitexceeded"),this.options.where===s&&(!n&&r&&r.features.length&&c.Util.requestAnimFrame(c.Util.bind((function(){this._addFeatures(r.features,e),this._postProcessFeatures(t)}),this)),n||!r||r.features.length||this._postProcessFeatures(t),n&&this._postProcessFeatures(t),i&&i.call(this,n,r),a&&(a.exceededTransferLimit||a.properties&&a.properties.exceededTransferLimit)&&this.options.fetchAllFeatures&&this._requestFeatures(t,e,i,o+r.features.length))}),this)},_postProcessFeatures:function(t){this._activeRequests--,this._activeRequests<=0&&this.fire("load",{bounds:t})},_cacheKey:function(t){return t.z+":"+t.x+":"+t.y},_addFeatures:function(t,e){if(e){var i=this._cacheKey(e);this._cache[i]=this._cache[i]||[]}for(var o=t.length-1;o>=0;o--){var s=t[o].id;-1===this._currentSnapshot.indexOf(s)&&this._currentSnapshot.push(s),void 0!==i&&-1===this._cache[i].indexOf(s)&&this._cache[i].push(s)}this.options.timeField&&this._buildTimeIndexes(t),this.createLayers(t)},_buildQuery:function(t,e){var i=this.service.query().intersects(t).where(this.options.where).fields(this.options.fields).precision(this.options.precision);return this.options.fetchAllFeatures&&!isNaN(parseInt(e))&&(i=i.offset(e)),i.params.resultType="tile",this.options.requestParams&&c.Util.extend(i.params,this.options.requestParams),this.options.simplifyFactor&&i.simplify(this._map,this.options.simplifyFactor),"server"===this.options.timeFilterMode&&this.options.from&&this.options.to&&i.between(this.options.from,this.options.to),i},setWhere:function(t,e,i){this.options.where=t&&t.length?t:"1=1";for(var o=[],s=[],n=0,r=null,a=c.Util.bind((function(a,l){if(a&&(r=a),l)for(var u=l.features.length-1;u>=0;u--)s.push(l.features[u].id);--n<=0&&this._visibleZoom()&&t===this.options.where&&(this._currentSnapshot=s,c.Util.requestAnimFrame(c.Util.bind((function(){this.removeLayers(o),this.addLayers(s),e&&e.call(i,r)}),this)))}),this),l=this._currentSnapshot.length-1;l>=0;l--)o.push(this._currentSnapshot[l]);for(var u in this._cache={},this._cells){n++;var h=this._keyToCellCoords(u),p=this._cellCoordsToBounds(h);this._requestFeatures(p,h,a)}return this},getWhere:function(){return this.options.where},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(t,e,i,o){var s=this.options.from,n=this.options.to,r=0,a=null,l=c.Util.bind((function(c){c&&(a=c),this._filterExistingFeatures(s,n,t,e),r--,i&&r<=0&&i.call(o,a)}),this);if(this.options.from=t,this.options.to=e,this._filterExistingFeatures(s,n,t,e),"server"===this.options.timeFilterMode)for(var u in this._cells){r++;var h=this._keyToCellCoords(u),p=this._cellCoordsToBounds(h);this._requestFeatures(p,h,l)}return this},refresh:function(){this.setWhere(this.options.where)},_filterExistingFeatures:function(t,e,i,o){var s=t&&e?this._getFeaturesInTimeRange(t,e):this._currentSnapshot,n=this._getFeaturesInTimeRange(i,o);if(n.indexOf)for(var r=0;r<n.length;r++){var a=s.indexOf(n[r]);a>=0&&s.splice(a,1)}c.Util.requestAnimFrame(c.Util.bind((function(){this.removeLayers(s),this.addLayers(n)}),this))},_getFeaturesInTimeRange:function(t,e){var i,o=[];if(this.options.timeField.start&&this.options.timeField.end){var s=this._startTimeIndex.between(t,e),n=this._endTimeIndex.between(t,e);i=s.concat(n)}else{if(!this._timeIndex)return v("You must set timeField in the layer constructor in order to manipulate the start and end time filter."),[];i=this._timeIndex.between(t,e)}for(var r=i.length-1;r>=0;r--)o.push(i[r].id);return o},_buildTimeIndexes:function(t){var e,i;if(this.options.timeField.start&&this.options.timeField.end){var o=[],s=[];for(e=t.length-1;e>=0;e--)o.push({id:(i=t[e]).id,value:new Date(i.properties[this.options.timeField.start])}),s.push({id:i.id,value:new Date(i.properties[this.options.timeField.end])});this._startTimeIndex.bulkAdd(o),this._endTimeIndex.bulkAdd(s)}else{var n=[];for(e=t.length-1;e>=0;e--)n.push({id:(i=t[e]).id,value:new Date(i.properties[this.options.timeField])});this._timeIndex.bulkAdd(n)}},_featureWithinTimeRange:function(t){if(!this.options.from||!this.options.to)return!0;var e=+this.options.from.valueOf(),i=+this.options.to.valueOf();if("string"==typeof this.options.timeField){var o=+t.properties[this.options.timeField];return o>=e&&o<=i}if(this.options.timeField.start&&this.options.timeField.end){var s=+t.properties[this.options.timeField.start],n=+t.properties[this.options.timeField.end];return s>=e&&s<=i||n>=e&&n<=i||s<=e&&n>=i}},_visibleZoom:function(){if(!this._map)return!1;var t=this._map.getZoom();return!(t>this.options.maxZoom||t<this.options.minZoom)},_handleZoomChange:function(){if(this._visibleZoom())for(var t in this._cells){var e=this._cacheKey(this._cells[t].coords);this._cache[e]&&this.addLayers(this._cache[e])}else this.removeLayers(this._currentSnapshot)},authenticate:function(t){return this.service.authenticate(t),this},metadata:function(t,e){return this.service.metadata(t,e),this},query:function(){return this.service.query()},_getMetadata:function(t){this._metadata?t(void 0,this._metadata):this.metadata(c.Util.bind((function(e,i){this._metadata=i,t(e,this._metadata)}),this))},addFeature:function(t,e,i){this.addFeatures(t,e,i)},addFeatures:function(t,e,i){this._getMetadata(c.Util.bind((function(o,s){if(o)e&&e.call(this,o,null);else{var n=t.features?t.features:[t];this.service.addFeatures(t,c.Util.bind((function(t,o){if(!t){for(var r=n.length-1;r>=0;r--)n[r].properties[s.objectIdField]=n.length>1?o[r].objectId:o.objectId,n[r].id=n.length>1?o[r].objectId:o.objectId;this._addFeatures(n)}e&&e.call(i,t,o)}),this))}}),this))},updateFeature:function(t,e,i){this.updateFeatures(t,e,i)},updateFeatures:function(t,e,i){var o=t.features?t.features:[t];this.service.updateFeatures(t,(function(t,s){if(!t){for(var n=o.length-1;n>=0;n--)this.removeLayers([o[n].id],!0);this._addFeatures(o)}e&&e.call(i,t,s)}),this)},deleteFeature:function(t,e,i){this.deleteFeatures(t,e,i)},deleteFeatures:function(t,e,i){return this.service.deleteFeatures(t,(function(t,o){var s=o.length?o:[o];if(!t&&s.length>0)for(var n=s.length-1;n>=0;n--)this.removeLayers([s[n].objectId],!0);e&&e.call(i,t,o)}),this)}}),At=Mt.extend({options:{cacheLayers:!0},initialize:function(t){t.apikey&&(t.token=t.apikey),Mt.prototype.initialize.call(this,t),this._originalStyle=this.options.style,this._layers={}},onRemove:function(t){for(var e in this._layers)t.removeLayer(this._layers[e]),this.fire("removefeature",{feature:this._layers[e].feature,permanent:!1},!0);return Mt.prototype.onRemove.call(this,t)},createNewLayer:function(t){var e=c.GeoJSON.geometryToLayer(t,this.options);return e&&(e.defaultOptions=e.options),e},_updateLayer:function(t,e){var i=[],o=this.options.coordsToLatLng||c.GeoJSON.coordsToLatLng;switch(e.properties&&(t.feature.properties=e.properties),e.geometry.type){case"Point":i=c.GeoJSON.coordsToLatLng(e.geometry.coordinates),t.setLatLng(i);break;case"LineString":i=c.GeoJSON.coordsToLatLngs(e.geometry.coordinates,0,o),t.setLatLngs(i);break;case"MultiLineString":case"Polygon":i=c.GeoJSON.coordsToLatLngs(e.geometry.coordinates,1,o),t.setLatLngs(i);break;case"MultiPolygon":i=c.GeoJSON.coordsToLatLngs(e.geometry.coordinates,2,o),t.setLatLngs(i)}},createLayers:function(t){for(var e=t.length-1;e>=0;e--){var i,o=t[e],s=this._layers[o.id];!this._visibleZoom()||!s||this._map.hasLayer(s)||this.options.timeField&&!this._featureWithinTimeRange(o)||(this._map.addLayer(s),this.fire("addfeature",{feature:s.feature},!0)),s&&this.options.simplifyFactor>0&&(s.setLatLngs||s.setLatLng)&&this._updateLayer(s,o),s||((i=this.createNewLayer(o))?(i.feature=o,i.addEventParent(this),this.options.onEachFeature&&this.options.onEachFeature(i.feature,i),this._layers[i.feature.id]=i,this.setFeatureStyle(i.feature.id,this.options.style),this.fire("createfeature",{feature:i.feature},!0),this._visibleZoom()&&(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(o))&&this._map.addLayer(i)):v("invalid GeoJSON encountered"))}},addLayers:function(t){for(var e=t.length-1;e>=0;e--){var i=this._layers[t[e]];!i||this.options.timeField&&!this._featureWithinTimeRange(i.feature)||this._map.addLayer(i)}},removeLayers:function(t,e){for(var i=t.length-1;i>=0;i--){var o=t[i],s=this._layers[o];s&&(this.fire("removefeature",{feature:s.feature,permanent:e},!0),this._map.removeLayer(s)),s&&e&&delete this._layers[o]}},cellEnter:function(t,e){this._visibleZoom()&&!this._zooming&&this._map&&c.Util.requestAnimFrame(c.Util.bind((function(){var t=this._cacheKey(e),i=this._cellCoordsToKey(e),o=this._cache[t];this._activeCells[i]&&o&&this.addLayers(o)}),this))},cellLeave:function(t,e){this._zooming||c.Util.requestAnimFrame(c.Util.bind((function(){if(this._map){var t=this._cacheKey(e),i=this._cellCoordsToKey(e),o=this._cache[t],s=this._map.getBounds();if(!this._activeCells[i]&&o){for(var n=!0,r=0;r<o.length;r++){var a=this._layers[o[r]];a&&a.getBounds&&s.intersects(a.getBounds())&&(n=!1)}n&&this.removeLayers(o,!this.options.cacheLayers),!this.options.cacheLayers&&n&&(delete this._cache[t],delete this._cells[i],delete this._activeCells[i])}}}),this))},resetStyle:function(){return this.options.style=this._originalStyle,this.eachFeature((function(t){this.resetFeatureStyle(t.feature.id)}),this),this},setStyle:function(t){return this.options.style=t,this.eachFeature((function(e){this.setFeatureStyle(e.feature.id,t)}),this),this},resetFeatureStyle:function(t){var e=this._layers[t],i=this._originalStyle||c.Path.prototype.options;return e&&(c.Util.extend(e.options,e.defaultOptions),this.setFeatureStyle(t,i)),this},setFeatureStyle:function(t,e){var i=this._layers[t];return"function"==typeof e&&(e=e(i.feature)),i.setStyle&&i.setStyle(e),this},eachActiveFeature:function(t,e){if(this._map){var i=this._map.getBounds();for(var o in this._layers)-1!==this._currentSnapshot.indexOf(this._layers[o].feature.id)&&("function"==typeof this._layers[o].getLatLng&&i.contains(this._layers[o].getLatLng())||"function"==typeof this._layers[o].getBounds&&i.intersects(this._layers[o].getBounds()))&&t.call(e,this._layers[o])}return this},eachFeature:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getFeature:function(t){return this._layers[t]},bringToBack:function(){this.eachFeature((function(t){t.bringToBack&&t.bringToBack()}))},bringToFront:function(){this.eachFeature((function(t){t.bringToFront&&t.bringToFront()}))},redraw:function(t){return t&&this._redraw(t),this},_redraw:function(t){var e=this._layers[t],i=e.feature;if(e&&e.setIcon&&this.options.pointToLayer&&this.options.pointToLayer){var o=this.options.pointToLayer(i,Object(c.latLng)(i.geometry.coordinates[1],i.geometry.coordinates[0]));e.setIcon(o.options.icon)}if(e&&e.setStyle&&this.options.pointToLayer){var s=this.options.pointToLayer(i,Object(c.latLng)(i.geometry.coordinates[1],i.geometry.coordinates[0]));this.setFeatureStyle(i.id,s.options)}e&&e.setStyle&&this.options.style&&this.resetStyle(i.id)}});function Ut(t){return new At(t)}var Rt=o.version},aAg2:function(t){t.exports=JSON.parse('{"name":"esri-leaflet","description":"Leaflet plugins for consuming ArcGIS Online and ArcGIS Server services.","version":"3.0.2","author":"Patrick Arlt <parlt@esri.com> (http://patrickarlt.com)","bugs":{"url":"https://github.com/esri/esri-leaflet/issues"},"contributors":["Patrick Arlt <parlt@esri.com> (http://patrickarlt.com)","John Gravois <jgravois@esri.com> (http://johngravois.com)","Gavin Rehkemper <grehkemper@esri.com>","Jacob Wasilkowski <jwasilkowski@esri.com> (https://jwasilgeo.github.io)"],"dependencies":{"@terraformer/arcgis":"^2.0.7","tiny-binary-search":"^1.0.3"},"devDependencies":{"@rollup/plugin-json":"^4.0.3","@rollup/plugin-node-resolve":"^7.1.3","chai":"4.2.0","gh-release":"^4.0.3","highlight.js":"^9.12.0","http-server":"^0.12.3","husky":"^1.1.1","istanbul":"^0.4.5","karma":"^5.2.3","karma-chai-sinon":"^0.1.5","karma-chrome-launcher":"^2.2.0","karma-coverage":"^1.1.2","karma-mocha":"^2.0.1","karma-mocha-reporter":"^2.2.5","karma-sourcemap-loader":"^0.3.7","leaflet":"^1.6.0","mkdirp":"^0.5.1","mocha":"^8.1.3","npm-run-all":"^4.0.2","rollup":"^2.0.0","rollup-plugin-uglify":"^6.0.4","semistandard":"^9.0.0","sinon":"^6.3.5","sinon-chai":"3.2.0","snazzy":"^8.0.0","uglify-js":"^2.8.29","watch":"^1.0.2"},"files":["src/**/*.js","dist/esri-leaflet.js","dist/esri-leaflet.js.map","dist/esri-leaflet-debug.js.map","profiles/*.js"],"homepage":"http://esri.github.io/esri-leaflet","module":"src/EsriLeaflet.js","jsnext:main":"src/EsriLeaflet.js","jspm":{"registry":"npm","format":"es6","main":"src/EsriLeaflet.js"},"keywords":["arcgis","esri","esri leaflet","gis","leaflet plugin","mapping"],"license":"Apache-2.0","main":"dist/esri-leaflet-debug.js","peerDependencies":{"leaflet":"^1.0.0"},"readmeFilename":"README.md","repository":{"type":"git","url":"git@github.com:Esri/esri-leaflet.git"},"scripts":{"build":"rollup -c profiles/debug.js & rollup -c profiles/production.js","lint":"semistandard | snazzy","prebuild":"mkdirp dist","prepare":"npm run build","pretest":"npm run build","precommit":"npm run lint","fix":"semistandard --fix","release":"./scripts/release.sh","start-watch":"watch \\"npm run build\\" src","start":"run-p start-watch serve","serve":"http-server -p 5000 -c-1 -o","test":"npm run lint && karma start","test:ci":"npm run lint && karma start --browsers Chrome_travis_ci"},"semistandard":{"globals":["expect","L","XMLHttpRequest","sinon","xhr","proj4"]},"unpkg":"dist/esri-leaflet-debug.js"}')},n4TO:function(t,e,i){"use strict";i.r(e),i.d(e,"CustomerMapModule",(function(){return lt}));var o=i("ofXK"),s=i("tyNb"),n=i("4R65"),r=(i("b1UB"),i("CvBG"),i("mD1w"),i("eapw"),i("M9GK"),i("HMfJ"),i("I8tt"),i("fXoL")),a=i("pD6V"),c=i("3cRz"),l=i("Ofeh"),u=i("XCAU"),h=i("tmcy"),p=i("XiUz"),d=i("bTqV"),m=i("STbY"),f=i("NFeN"),g=i("+0xr"),v=i("3Pt+"),y=i("M5z4"),b=i("wZkO"),_=i("kmnG"),x=i("qFsG"),L=i("7EHt"),C=i("MutI"),S=i("bSwM"),w=i("d3UM"),O=i("z17N"),I=i("FKr1"),k=i("Wp6s"),T=i("Xa2L");function P(t,e){if(1&t&&(r.fc(0,"span",28),r.Qc(1),r.sc(2,"number"),r.ec()),2&t){const t=r.rc().$implicit,e=r.rc(2);r.Ob(1),r.Sc("",r.tc(2,1,1.852*(null==e.deviceDataIndex[t.deviceid]?null:e.deviceDataIndex[t.deviceid].speed))," km")}}function D(t,e){if(1&t&&(r.fc(0,"div",29),r.Qc(1),r.sc(2,"date"),r.ec()),2&t){const t=r.rc().$implicit,e=r.rc(2);r.Ob(1),r.Sc(" ",r.uc(2,1,null==e.deviceDataIndex[t.deviceid]?null:e.deviceDataIndex[t.deviceid].servertime,"medium")," ")}}function M(t,e){if(1&t){const t=r.gc();r.fc(0,"div",16),r.fc(1,"div",16),r.fc(2,"mat-checkbox",17),r.nc("change",(function(i){r.Hc(t);const o=e.$implicit;return r.rc(2).check(i.checked,o)})),r.ec(),r.fc(3,"a",18),r.nc("click",(function(){r.Hc(t);const i=e.$implicit;return r.rc(2).getLocation(i)})),r.Qc(4),r.ec(),r.fc(5,"a",19),r.fc(6,"mat-icon"),r.Qc(7,"more_vert"),r.ec(),r.ec(),r.fc(8,"span",20),r.ac(9,"i",21),r.ec(),r.Pc(10,P,3,3,"span",22),r.Pc(11,D,3,4,"div",23),r.fc(12,"mat-menu",24,25),r.fc(14,"button",26),r.Qc(15,"Hospital List"),r.ec(),r.fc(16,"button",27),r.Qc(17," Hospital Map "),r.ec(),r.ec(),r.ec(),r.ec()}if(2&t){const t=e.$implicit,i=r.Fc(13),o=r.rc(2);r.Ob(2),r.yc("checked",o.checkState(t.id)),r.Ob(2),r.Rc(t.name),r.Ob(1),r.yc("matMenuTriggerFor",i),r.Ob(5),r.yc("ngIf",o.deviceDataIndex),r.Ob(1),r.yc("ngIf",o.deviceDataIndex)}}function A(t,e){if(1&t){const t=r.gc();r.fc(0,"div"),r.fc(1,"div",9),r.fc(2,"mat-form-field",10),r.fc(3,"input",11),r.nc("keyup",(function(e){return r.Hc(t),r.rc().applyFilter(e.target.value)})),r.ec(),r.ec(),r.fc(4,"button",12),r.Qc(5," + "),r.ec(),r.fc(6,"button",12),r.Qc(7," - "),r.ec(),r.ec(),r.fc(8,"div"),r.fc(9,"mat-accordion"),r.fc(10,"mat-nav-list"),r.fc(11,"mat-expansion-panel",13),r.fc(12,"mat-expansion-panel-header"),r.fc(13,"mat-checkbox",14),r.nc("click",(function(e){return r.Hc(t),e.stopPropagation()}))("keydown",(function(e){return r.Hc(t),e.stopPropagation()}))("change",(function(e){r.Hc(t);const i=r.rc();return i.checkByCustomer(e.checked,i.customer)})),r.Qc(14),r.ec(),r.ec(),r.Pc(15,M,18,5,"div",15),r.ec(),r.ec(),r.ec(),r.ec(),r.ec()}if(2&t){const t=r.rc();r.Ob(3),r.yc("checked",t.box),r.Ob(8),r.yc("expanded",!1),r.Ob(2),r.yc("checked",t.checkStateC(1)),r.Ob(1),r.Sc(" ",null==t.customer[0]?null:t.customer[0].name," "),r.Ob(1),r.yc("ngForOf",t.customerDevices)}}function U(t,e){1&t&&(r.fc(0,"th",40),r.Qc(1,"Time"),r.ec())}function R(t,e){if(1&t){const t=r.gc();r.fc(0,"td",41),r.fc(1,"a",42),r.nc("click",(function(){r.Hc(t);const i=e.$implicit;return r.rc(2).eventInfo(i)})),r.Qc(2),r.sc(3,"date"),r.ec(),r.ec()}if(2&t){const t=e.$implicit;r.Ob(2),r.Rc(r.uc(3,1,t.eventtime,"medium"))}}function F(t,e){1&t&&(r.fc(0,"th",40),r.Qc(1,"Name"),r.ec())}function E(t,e){if(1&t){const t=r.gc();r.fc(0,"td",41),r.fc(1,"a",42),r.nc("click",(function(){r.Hc(t);const i=e.$implicit;return r.rc(2).eventInfo(i)})),r.Qc(2),r.ec(),r.ec()}if(2&t){const t=r.rc(2);r.Ob(2),r.Rc(null==t.customerDevices[0]?null:t.customerDevices[0].name)}}function B(t,e){1&t&&(r.fc(0,"th",40),r.Qc(1,"Events"),r.ec())}function G(t,e){if(1&t){const t=r.gc();r.fc(0,"td",41),r.fc(1,"a",42),r.nc("click",(function(){r.Hc(t);const i=e.$implicit;return r.rc(2).eventInfo(i)})),r.Qc(2),r.ec(),r.ec()}if(2&t){const t=e.$implicit;r.Ob(2),r.Rc(t.type)}}function z(t,e){1&t&&r.ac(0,"th",40)}function j(t,e){if(1&t&&(r.fc(0,"td",41),r.fc(1,"a",43),r.fc(2,"mat-icon"),r.Qc(3,"more_vert"),r.ec(),r.ec(),r.ec()),2&t){r.rc();const t=r.Fc(15);r.Ob(1),r.yc("matMenuTriggerFor",t)}}function N(t,e){1&t&&r.ac(0,"tr",44)}function q(t,e){1&t&&r.ac(0,"tr",45)}function Z(t,e){if(1&t&&(r.fc(0,"mat-tab",30),r.fc(1,"table",31),r.dc(2,32),r.Pc(3,U,2,0,"th",33),r.Pc(4,R,4,4,"td",34),r.cc(),r.dc(5,35),r.Pc(6,F,2,0,"th",33),r.Pc(7,E,3,1,"td",34),r.cc(),r.dc(8,36),r.Pc(9,B,2,0,"th",33),r.Pc(10,G,3,1,"td",34),r.cc(),r.dc(11,37),r.Pc(12,z,1,0,"th",33),r.Pc(13,j,4,1,"td",34),r.cc(),r.fc(14,"mat-menu",24,25),r.fc(16,"button",26),r.Qc(17,"Alert"),r.ec(),r.fc(18,"button",27),r.Qc(19," Delete "),r.ec(),r.ec(),r.Pc(20,N,1,0,"tr",38),r.Pc(21,q,1,0,"tr",39),r.ec(),r.ec()),2&t){const t=r.rc();r.Ob(1),r.yc("dataSource",t.dataEvents),r.Ob(19),r.yc("matHeaderRowDef",t.displayedColumns2),r.Ob(1),r.yc("matRowDefColumns",t.displayedColumns2)}}function Q(t,e){if(1&t&&(r.fc(0,"mat-option",59),r.Qc(1),r.ec()),2&t){const t=e.$implicit;r.yc("value",t.id),r.Ob(1),r.Sc(" ",t.name," ")}}function W(t,e){if(1&t){const t=r.gc();r.fc(0,"div",46),r.fc(1,"form",47),r.fc(2,"mat-form-field",48),r.fc(3,"mat-label"),r.Qc(4,"Device"),r.ec(),r.fc(5,"mat-select",49,50),r.nc("ngModelChange",(function(e){return r.Hc(t),r.rc().selected=e})),r.fc(7,"input",51),r.nc("keyup",(function(e){return r.Hc(t),r.rc().applyFilter(e.target.value)})),r.ec(),r.fc(8,"a",52),r.fc(9,"mat-icon",42),r.nc("click",(function(){return r.Hc(t),r.Fc(6).close()})),r.Qc(10,"clear"),r.ec(),r.ec(),r.Pc(11,Q,2,2,"mat-option",53),r.ec(),r.ec(),r.fc(12,"mat-form-field"),r.ac(13,"input",54),r.ac(14,"owl-date-time",null,55),r.ec(),r.fc(16,"mat-form-field"),r.ac(17,"input",56),r.ac(18,"owl-date-time",null,57),r.ec(),r.ec(),r.fc(20,"button",58),r.nc("click",(function(){return r.Hc(t),r.rc().loadHistory()})),r.Qc(21," Load History "),r.ec(),r.ec()}if(2&t){const t=r.Fc(15),e=r.Fc(19),i=r.rc();r.Ob(1),r.yc("formGroup",i.myform),r.Ob(4),r.yc("ngModel",i.selected),r.Ob(6),r.yc("ngForOf",i.devicesArray),r.Ob(2),r.yc("owlDateTime",t)("owlDateTimeTrigger",t),r.Ob(4),r.yc("owlDateTime",e)("owlDateTimeTrigger",e)}}function H(t,e){1&t&&(r.fc(0,"mat-card",60),r.ac(1,"mat-progress-spinner",61),r.ec())}function K(t,e){1&t&&(r.fc(0,"div"),r.Qc(1," No Records Found! "),r.ec())}let J=(()=>{class t{constructor(t,e,i,o,s,n){this.fb=t,this.route=e,this.customerService=i,this.deviceService=o,this.cusmapService=s,this.dateFormatService=n,this.deviceCurrentData=[],this.deviceData=[],this.deviceDataIndex=[],this.DeviceItem=[],this.DeviceItemCus=[],this.devicelog=[],this.devicelogMatch=[],this.dataSource=new g.k([]),this.dataEvents=new g.k([]),this.displayedColumns2=["time","device_id","event","more"]}ngOnInit(){this.myform=this.fb.group({id:[],from_date:[""],to_date:[""],status:[""],customer_id:[""],d:[""]}),this.route.paramMap.subscribe(t=>{this.Id=t.get("id"),this.getCustomerDevices(this.Id)}),this.getAllEvents(),this.cusmapService.deviceDetailsCatch.subscribe(t=>{t&&(console.log("menu time check"),this.deviceData=[],this.deviceData.push(t),this.deviceData.forEach((t,e)=>{this.deviceDataIndex[t.deviceid]=this.deviceData[e]}),console.log(this.deviceData))})}getCustomerDevices(t){this.customerService.getCustomerByUserId(t).subscribe(t=>{this.customer=t,console.log(this.customer)}),this.customerService.DeviceIdByUser(t).subscribe(t=>{this.deviceId=t,console.log(t),this.selected=this.deviceId[0].deviceid,console.log(this.selected);var e=[];this.deviceId.forEach(t=>{e.push(t.deviceid)}),this.customerService.DeviceByDeviceId({id:e}).subscribe(t=>{this.devicesArray=t,this.customerDevices=t,t.forEach((t,e)=>{this.devicelog.push(t.id)})}),console.log(this.devicelog)})}objectTab(t){var e=t.index;2==e&&setTimeout(()=>{const t=new Date;var e=new Date(t.getFullYear(),t.getMonth(),t.getDate());this.myform.patchValue({from_date:e,to_date:new Date})},100),0!=e&&1!=e||this.cusmapService.tabIndex({id:1})}applyFilter(t){}applyDevices(t){this.customerDevices=this.filterDevices.filter(e=>e.name.toLowerCase().indexOf(t)>-1)}check(t,e){if(t){console.log(e),this.devicelogMatch.push(e.id),console.log(this.devicelogMatch.length),console.log(this.devicelog.length);var i=this.devicelogMatch.length;console.log(i),i===this.devicelog.length&&this.DeviceItemCus.push(1),this.deviceService.getDeviceById(e.id).subscribe(t=>{this.deviceCurrentData=[],console.log(t),this.deviceCurrentData.push(t),this.deviceService.getDevicePositionByPositionId({id:this.deviceCurrentData[0].positionid}).subscribe(e=>{console.log(e),this.deviceDataT=e,this.deviceCurrentData=this.deviceCurrentData.map(t=>Object.assign(t,this.deviceDataT.find(e=>e.deviceid==t.id))),this.customerDevices=this.customerDevices.map(t=>Object.assign(t,this.deviceDataT.find(e=>e.deviceid==t.id))),console.log(t),this.customerDevices.forEach((t,e)=>{console.log("test"),this.deviceDataIndex[t.deviceid]=this.customerDevices[e]}),this.cusmapService.deviceDataExchange(this.deviceCurrentData)})})}else e.deviceid&&(e.id=e.deviceid),console.log(this.devicelogMatch),this.devicelogMatch=this.devicelogMatch.filter(t=>t!==e.id),console.log(this.devicelogMatch),this.DeviceItem=this.DeviceItem.filter(t=>t!==e.id),this.DeviceItemCus=this.DeviceItemCus.filter(t=>1!==t),this.cusmapService.deviceRemove([e])}checkByCustomer(t,e){if(t){this.DeviceItemCus.push(1),console.log(this.devicelog),this.devicelogMatch=this.devicelog;var i={id:this.devicelog};console.log(this.devicelogMatch),console.log(i),this.customerService.DeviceByCustomerUserWithPosition(i).subscribe(t=>{var e=t,i=[];e.forEach((t,e)=>{console.log(t),i.push(t.positionid)}),this.customerService.DevicePositionByPositionId({id:i}).subscribe(t=>{var i=t;console.log(e),console.log(this.customerDevices),this.customerDevices=e.map(t=>Object.assign(t,i.find(e=>e.deviceid==t.id))),console.log(this.customerDevices),this.customerDevices.forEach((t,e)=>{this.DeviceItem.push(t.id)}),this.customerDevices.forEach((t,e)=>{this.deviceDataIndex[t.deviceid]=this.customerDevices[e]}),this.cusmapService.deviceDataExchange(this.customerDevices)})})}else this.customerDevices.forEach(t=>{this.DeviceItem=this.DeviceItem.filter(e=>e!==t.deviceid)}),this.devicelogMatch=[],this.DeviceItemCus=this.DeviceItemCus.filter(t=>1!==t),this.cusmapService.deviceRemove(this.customerDevices)}checkState(t){if(this.customerDevices)return this.DeviceItem.indexOf(t)>-1}checkStateC(t){if(this.customerDevices)return this.DeviceItemCus.indexOf(t)>-1}getAllEvents(){this.deviceService.getAllEvents().subscribe(t=>{this.Events=t,this.dataEvents=new g.k(t)})}loadHistory(){this.isLoading=!0;const t={id:this.myform.value.id,from_date:this.dateFormatService.dateTime("datetime",this.myform.value.from_date),to_date:this.dateFormatService.dateTime("datetime",this.myform.value.to_date)};console.log(this.myform.value),this.deviceService.getHistoryPostionBySearch(t).subscribe(t=>{console.log("test history"),console.log(t),this.historyData=t,this.isLoading=!1,this.cusmapService.deviceHistory(t)})}getLocation(t){t.deviceid&&(t.id=t.deviceid),console.log(t.id),this.deviceService.getDeviceCurrentPositionById(t.id).subscribe(t=>{this.locationData=t,this.cusmapService.deviceLocation(this.locationData),this.cusmapService.detailsDataExchange(this.locationData)})}eventInfo(t){this.deviceService.getEventPositionById(t.id).subscribe(t=>{console.log(t),this.cusmapService.eventExchange(t)})}}return t.\u0275fac=function(e){return new(e||t)(r.Zb(v.e),r.Zb(s.a),r.Zb(y.a),r.Zb(u.a),r.Zb(c.a),r.Zb(h.a))},t.\u0275cmp=r.Tb({type:t,selectors:[["app-side-menu"]],decls:11,vars:5,consts:[[1,"container"],[3,"selectedTabChange"],["allTabs",""],["label","Objects"],[4,"ngIf"],["label","Events",4,"ngIf"],["label","History"],["class","historytab",4,"ngIf"],["style","display:flex; justify-content: center; align-items: center",4,"ngIf"],[1,"search-div"],[1,"filter"],["matInput","","placeholder","search","autocomplete","off",3,"checked","keyup"],[1,"btn"],[1,"space",2,"clear","both",3,"expanded"],[3,"checked","click","keydown","change"],["class","item",4,"ngFor","ngForOf"],[1,"item"],[1,"name",3,"checked","change"],[1,"devicename",3,"click"],[1,"b2",3,"matMenuTriggerFor"],[1,"b21"],["aria-hidden","true",1,"fa","fa-circle"],["class","b213",4,"ngIf"],["class","movingtime",4,"ngIf"],[1,"dropdown-content"],["hospital","matMenu"],["mat-menu-item","","routerLink","/"],["mat-menu-item","","routerLink","info/map"],[1,"b213"],[1,"movingtime"],["label","Events"],["mat-table","","matTableExporter","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","time"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","device_id"],["matColumnDef","event"],["matColumnDef","more"],["class","header-row","mat-header-row","",4,"matHeaderRowDef"],["class","row","mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"click"],[3,"matMenuTriggerFor"],["mat-header-row","",1,"header-row"],["mat-row","",1,"row"],[1,"historytab"],[3,"formGroup"],[1,"half"],["formControlName","id",3,"ngModel","ngModelChange"],["sl",""],["matInput","","placeholder","search","autocomplete","off",1,"filterBox",3,"keyup"],[1,"closeButton"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","from_date","placeholder","Date Time",3,"owlDateTime","owlDateTimeTrigger"],["dt1",""],["matInput","","formControlName","to_date","placeholder","To Time",3,"owlDateTime","owlDateTimeTrigger"],["dt2",""],["mat-raised-button","","color","primary",1,"btn-block",3,"click"],[3,"value"],[2,"display","flex","justify-content","center","align-items","center"],["color","primary","mode","indeterminate"]],template:function(t,e){1&t&&(r.fc(0,"div",0),r.fc(1,"mat-tab-group",1,2),r.nc("selectedTabChange",(function(t){return e.objectTab(t)})),r.fc(3,"mat-tab",3),r.Pc(4,A,16,5,"div",4),r.ec(),r.Pc(5,Z,22,3,"mat-tab",5),r.fc(6,"mat-tab",6),r.Pc(7,W,22,7,"div",7),r.fc(8,"div"),r.Pc(9,H,2,0,"mat-card",8),r.ec(),r.Pc(10,K,2,0,"div",4),r.ec(),r.ec(),r.ec()),2&t&&(r.Ob(4),r.yc("ngIf",e.customerDevices),r.Ob(1),r.yc("ngIf",e.customerDevices),r.Ob(2),r.yc("ngIf",e.customerDevices),r.Ob(2),r.yc("ngIf",e.isLoading),r.Ob(1),r.yc("ngIf",""==e.historyData))},directives:[b.b,b.a,o.m,_.c,x.b,L.a,C.d,L.c,L.d,S.a,o.l,m.c,f.a,m.d,m.a,s.d,g.j,g.c,g.e,g.b,g.g,g.i,g.d,g.a,g.f,g.h,v.t,v.n,v.g,_.g,w.a,v.m,v.f,v.c,O.b,O.d,O.a,d.b,I.o,k.a,T.a],pipes:[o.f,o.e],styles:[".container[_ngcontent-%COMP%]{width:100%}.historytab[_ngcontent-%COMP%]{margin-left:10%}table[_ngcontent-%COMP%]{width:95%!important} .mat-tab-label,  .mat-tab-label-active{min-width:0!important;padding:10px!important;margin:10px!important}.filter[_ngcontent-%COMP%]{margin-left:5px!important}.btn[_ngcontent-%COMP%]{width:30px!important;background-color:#00f;margin-left:5px}.mat-column-select[_ngcontent-%COMP%]{width:10%!important}.mat-column-name[_ngcontent-%COMP%]{width:80%!important}.mat-column-more[_ngcontent-%COMP%]{width:10%!important}a[_ngcontent-%COMP%]{cursor:pointer}mat-menu[_ngcontent-%COMP%]{margin-left:50px!important;position:absolute}.dropdown-content[_ngcontent-%COMP%]{display:none;position:absolute;background-color:#f9f9f9;min-width:160px;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);z-index:20}.cdk-overlay-container[_ngcontent-%COMP%]{position:fixed!important;z-index:3000!important}.filterBox[_ngcontent-%COMP%]{width:150px;height:25px;margin-left:10px;margin-top:5px;margin-bottom:5px;border-radius:10px 10px 10px 10px;border:2px solid #000}.closeButton[_ngcontent-%COMP%]{margin-top:20px}.space[_ngcontent-%COMP%]{margin-bottom:2px}.group[_ngcontent-%COMP%]{font-size:14px;font-weight:500}.item[_ngcontent-%COMP%]{margin-bottom:10px;margin-right:2px}.b2[_ngcontent-%COMP%]{color:#0078a8!important}.b2[_ngcontent-%COMP%], .b21[_ngcontent-%COMP%]{float:right;flex:1 1 auto}.b21[_ngcontent-%COMP%]{width:10px;color:#ff0!important}.b213[_ngcontent-%COMP%]{float:right;flex:1 1 auto;margin-right:3px}.devicename[_ngcontent-%COMP%]{margin-top:5px;margin-left:10px;text-align:center;color:#0078a8!important}.clock[_ngcontent-%COMP%]{width:70%!important}.mat-list-base[_ngcontent-%COMP%]   .mat-list-item[_ngcontent-%COMP%]   .mat-list-item-content[_ngcontent-%COMP%], .mat-list-base[_ngcontent-%COMP%]   .mat-list-option[_ngcontent-%COMP%]   .mat-list-item-content[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 10px;height:unset}.movingtime[_ngcontent-%COMP%]{margin-left:10%;font-size:9px}"]}),t})();i("Bn1M");var V=i("zkoq");function X(t,e){1&t&&(r.fc(0,"h3",11),r.fc(1,"mat-icon"),r.Qc(2,"near_me"),r.ec(),r.Qc(3,"Name"),r.ec())}function $(t,e){if(1&t&&(r.fc(0,"h3",11),r.fc(1,"mat-icon"),r.Qc(2,"near_me"),r.ec(),r.Qc(3),r.fc(4,"span",15),r.ac(5,"i",16),r.Qc(6,"Active"),r.ec(),r.ec()),2&t){const t=r.rc();r.Ob(3),r.Sc("",null==t.deviceName?null:t.deviceName.name," ")}}function Y(t,e){if(1&t){const t=r.gc();r.fc(0,"a",17),r.fc(1,"mat-icon",18),r.nc("click",(function(){r.Hc(t);const e=r.rc();return e.findLocation(e.deviceData)})),r.Qc(2,"visibility"),r.ec(),r.ec()}if(2&t){const t=r.rc();r.zc("href",t.url,r.Ic)}}let tt=(()=>{class t{constructor(t){this.cusmapService=t,this.link="http://www.google.com/maps/place/"}ngOnInit(){this.map=n.map("mapidd",{center:[23.774252395907105,90.41607082790188],zoom:17,zoomControl:!1,attributionControl:!1}),n.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(this.map),console.log(this.url),this.cusmapService.detailsDataCatch.subscribe(t=>{if(t){this.deviceId=t[0].deviceid;var e={lat:t[0].latitude,lng:t[0].longitude};n.Control.Geocoder.nominatim().reverse(e,this.map.options.crs.scale(this.map.getZoom()),t=>{t[0]&&(this.address=t[0].name)}),this.url=this.link+t.latitude+","+t.longitude,this.deviceData=t[0],this.deviceName=t[0],this.attribute=JSON.parse(this.deviceData.attributes)}}),this.cusmapService.deviceDetailsCatch.subscribe(t=>{if(console.log("12122"),t&&(console.log(t.deviceid),console.log(this.deviceId),t.deviceid==this.deviceId)){var e={lat:t.latitude,lng:t.longitude};n.Control.Geocoder.nominatim().reverse(e,this.map.options.crs.scale(this.map.getZoom()),t=>{t[0]&&(this.address=t[0].name)}),this.url=this.link+t.latitude+","+t.longitude,this.deviceData=t,this.attribute=JSON.parse(this.deviceData.attributes)}})}findLocation(t){}}return t.\u0275fac=function(e){return new(e||t)(r.Zb(c.a))},t.\u0275cmp=r.Tb({type:t,selectors:[["app-bottom-details"]],decls:128,vars:21,consts:[["fxLayout","row",1,"container"],["id","mapidd"],["fxFlex","30%"],[1,"heading"],["class","deviceName",4,"ngIf"],["cols","1","rowHeight","20px"],[1,"pos"],[1,"mag"],["target","_blank",3,"href",4,"ngIf"],[1,"vertical"],["fxFlex","70%"],[1,"deviceName"],["cols","3","rowHeight","20px"],[1,"mag2"],["fxFlex","15%"],[1,"status"],["aria-hidden","true",1,"fa","fa-circle"],["target","_blank",3,"href"],[1,"eyeicon",3,"click"]],template:function(t,e){1&t&&(r.fc(0,"div",0),r.ac(1,"div",1),r.fc(2,"div",2),r.fc(3,"div",3),r.Pc(4,X,4,0,"h3",4),r.Pc(5,$,7,1,"h3",4),r.ec(),r.ac(6,"hr"),r.fc(7,"mat-grid-list",5),r.fc(8,"mat-grid-tile",6),r.fc(9,"mat-label",7),r.fc(10,"b"),r.Qc(11," Address: "),r.ec(),r.ec(),r.Qc(12),r.sc(13,"slice"),r.Pc(14,Y,3,1,"a",8),r.ec(),r.fc(15,"mat-grid-tile",6),r.fc(16,"mat-label",7),r.fc(17,"b"),r.Qc(18," Time:"),r.ec(),r.ec(),r.Qc(19),r.sc(20,"date"),r.ec(),r.fc(21,"mat-grid-tile",6),r.fc(22,"mat-label",7),r.fc(23,"b"),r.Qc(24," Stop Duration:"),r.ec(),r.ec(),r.ec(),r.fc(25,"mat-grid-tile",6),r.fc(26,"mat-label",7),r.fc(27,"b"),r.Qc(28," Driver:"),r.ec(),r.ec(),r.ec(),r.ec(),r.ec(),r.ac(29,"div",9),r.fc(30,"div",10),r.fc(31,"h3",11),r.fc(32,"mat-icon"),r.Qc(33,"sensors"),r.ec(),r.Qc(34,"Sensor"),r.ec(),r.ac(35,"hr"),r.fc(36,"mat-grid-list",12),r.fc(37,"mat-grid-tile"),r.fc(38,"mat-icon"),r.Qc(39,"tag"),r.ec(),r.fc(40,"mat-label",13),r.fc(41,"b"),r.Qc(42,"Alert:"),r.ec(),r.ec(),r.Qc(43),r.ec(),r.fc(44,"mat-grid-tile"),r.fc(45,"mat-icon"),r.Qc(46,"slow_motion_video"),r.ec(),r.fc(47,"mat-label",13),r.fc(48,"b"),r.Qc(49," Motion:"),r.ec(),r.ec(),r.Qc(50),r.ec(),r.fc(51,"mat-grid-tile"),r.fc(52,"mat-icon"),r.Qc(53,"vpn_key"),r.ec(),r.fc(54,"mat-label",13),r.fc(55,"b"),r.Qc(56," Ignition:"),r.ec(),r.ec(),r.Qc(57),r.ec(),r.fc(58,"mat-grid-tile"),r.fc(59,"mat-icon"),r.Qc(60,"signal_cellular_alt"),r.ec(),r.fc(61,"mat-label",13),r.fc(62,"b"),r.Qc(63," GSM:"),r.ec(),r.ec(),r.Qc(64),r.ec(),r.fc(65,"mat-grid-tile"),r.fc(66,"mat-icon"),r.Qc(67,"battery_charging_full"),r.ec(),r.fc(68,"mat-label",13),r.fc(69,"b"),r.Qc(70," Battery Level:"),r.ec(),r.ec(),r.Qc(71),r.ec(),r.fc(72,"mat-grid-tile"),r.fc(73,"mat-icon"),r.Qc(74,"invert_colors"),r.ec(),r.fc(75,"mat-label",13),r.fc(76,"b"),r.Qc(77," Route Color:"),r.ec(),r.ec(),r.Qc(78," On "),r.ec(),r.fc(79,"mat-grid-tile"),r.fc(80,"mat-icon"),r.Qc(81,"satellite"),r.ec(),r.fc(82,"mat-label",13),r.fc(83,"b"),r.Qc(84," Satellite:"),r.ec(),r.ec(),r.Qc(85),r.ec(),r.fc(86,"mat-grid-tile"),r.fc(87,"mat-icon"),r.Qc(88,"villa"),r.ec(),r.fc(89,"mat-label",13),r.fc(90,"b"),r.Qc(91,"Doors:"),r.ec(),r.ec(),r.Qc(92," Opened "),r.ec(),r.fc(93,"mat-grid-tile"),r.fc(94,"mat-icon"),r.Qc(95,"drag_handle"),r.ec(),r.fc(96,"mat-label"),r.fc(97,"b"),r.Qc(98,"Distance:"),r.ec(),r.ec(),r.Qc(99," Opened "),r.ec(),r.fc(100,"mat-grid-tile"),r.fc(101,"mat-icon"),r.Qc(102,"moped"),r.ec(),r.fc(103,"mat-label",13),r.fc(104,"b"),r.Qc(105," Engin Hours:"),r.ec(),r.ec(),r.Qc(106),r.ec(),r.fc(107,"mat-grid-tile"),r.fc(108,"mat-icon"),r.Qc(109,"battery_saver"),r.ec(),r.fc(110,"mat-label"),r.fc(111,"b"),r.Qc(112," Battery Charging:"),r.ec(),r.ec(),r.Qc(113),r.ec(),r.fc(114,"mat-grid-tile"),r.fc(115,"mat-icon"),r.Qc(116,"speed"),r.ec(),r.fc(117,"mat-label",13),r.fc(118,"b"),r.Qc(119," Speed:"),r.ec(),r.ec(),r.Qc(120),r.ec(),r.ec(),r.ec(),r.ac(121,"div",9),r.fc(122,"div",14),r.fc(123,"h3",11),r.fc(124,"mat-icon"),r.Qc(125,"settings"),r.ec(),r.Qc(126,"Services"),r.ec(),r.ac(127,"hr"),r.ec(),r.ec()),2&t&&(r.Ob(4),r.yc("ngIf",!e.deviceData),r.Ob(1),r.yc("ngIf",e.deviceData),r.Ob(7),r.Sc(" ",(null==e.address?null:e.address.length)>20?r.vc(13,14,e.address,0,20)+"..":e.address," "),r.Ob(2),r.yc("ngIf",e.address),r.Ob(5),r.Sc(" ",r.uc(20,18,null==e.deviceData?null:e.deviceData.servertime,"medium")," "),r.Ob(24),r.Sc(" ",null==e.deviceData?null:e.deviceData.contact," "),r.Ob(7),r.Sc(" ",null==e.attribute?null:e.attribute.motion," "),r.Ob(7),r.Sc(" ",null==e.attribute?null:e.attribute.ignition," "),r.Ob(7),r.Sc(" ",null==e.deviceData?null:e.deviceData.speed," "),r.Ob(7),r.Sc(" ",null==e.attribute?null:e.attribute.batteryLevel," "),r.Ob(14),r.Sc(" ",null==e.attribute?null:e.attribute.sat," "),r.Ob(21),r.Sc(" ",null==e.deviceData?null:e.deviceData.speed," "),r.Ob(7),r.Sc(" ",null==e.deviceData?null:e.deviceData.model," "),r.Ob(7),r.Sc(" ",null==e.attribute?null:e.attribute.speed," "))},directives:[p.b,p.a,o.m,V.a,V.c,_.g,f.a],pipes:[o.t,o.e],styles:[".container[_ngcontent-%COMP%]{width:100%;background-color:#fff}.f[_ngcontent-%COMP%]{width:30%;float:left}.f[_ngcontent-%COMP%], .s[_ngcontent-%COMP%]{height:100%;background-color:#deb887}.s[_ngcontent-%COMP%]{width:70%!important}.vertical[_ngcontent-%COMP%]{width:3px;background-color:grey}.pos[_ngcontent-%COMP%] >   figure, mat-grid-tile[_ngcontent-%COMP%]  figure{justify-content:flex-start!important}.mag[_ngcontent-%COMP%]{margin-right:15%}.mag2[_ngcontent-%COMP%]{margin-right:5%}.eyeicon[_ngcontent-%COMP%]{margin-left:3%}.deviceName[_ngcontent-%COMP%]{text-align:left}.status[_ngcontent-%COMP%]{font-size:small;float:right}"]}),t})(),et=(()=>{class t{constructor(t,e){this.cusmapService=t,this.fb=e,this.speedControl=[{value:1},{value:2},{value:3},{value:4},{value:5},{value:6}],this.selected=1}ngOnInit(){this.myform=this.fb.group({motion:[]})}start(){this.cusmapService.deviceMove({id:100})}stop(){this.cusmapService.motionStop({id:103})}toggle(){console.log("toggle"),this.cusmapService.deviceToggle({id:101})}onChange(t){this.cusmapService.motionControl(t)}}return t.\u0275fac=function(e){return new(e||t)(r.Zb(c.a),r.Zb(v.e))},t.\u0275cmp=r.Tb({type:t,selectors:[["app-history-info"]],decls:15,vars:0,consts:[[1,"container"],["label","Speed"],[1,"top_margin"],[1,"a"],[3,"click"],["label","Altitude"],["label","GSM"],["label","Battery"],["label","Ignition"]],template:function(t,e){1&t&&(r.fc(0,"div",0),r.fc(1,"mat-tab-group"),r.fc(2,"mat-tab",1),r.fc(3,"div",2),r.fc(4,"a",3),r.fc(5,"mat-icon",4),r.nc("click",(function(){return e.start()})),r.Qc(6,"play_arrow"),r.ec(),r.ec(),r.fc(7,"a",3),r.fc(8,"mat-icon",4),r.nc("click",(function(){return e.toggle()})),r.Qc(9,"pause"),r.ec(),r.ec(),r.ec(),r.ac(10,"div"),r.ec(),r.ac(11,"mat-tab",5),r.ac(12,"mat-tab",6),r.ac(13,"mat-tab",7),r.ac(14,"mat-tab",8),r.ec(),r.ec())},directives:[b.b,b.a,f.a],styles:[".container[_ngcontent-%COMP%]{width:100%}.a[_ngcontent-%COMP%]{float:left}.space[_ngcontent-%COMP%]{width:20%}"]}),t})();function it(t,e){if(1&t&&(r.fc(0,"div",21),r.fc(1,"a",22),r.ac(2,"img",23),r.ac(3,"span",24),r.ec(),r.ec()),2&t){r.rc();const t=r.Fc(24);r.Ob(1),r.yc("matMenuTriggerFor",t)}}function ot(t,e){if(1&t&&(r.fc(0,"a",25),r.ac(1,"img",23),r.ac(2,"span",24),r.ec()),2&t){r.rc();const t=r.Fc(24);r.yc("matMenuTriggerFor",t)}}const st=[{path:"info/:id",component:(()=>{class t{constructor(t,e,i,o,s,n){this.mediaObserver=t,this.cusmapService=e,this.loginService=i,this.routing=o,this.deviceService=s,this.dateFormatService=n,this.devices=[],this.marker=[],this.markerArray=[],this.engineArray=[],this.parkArray=[],this.storeLatlng=[],this.timeArray=[],this.fixtimeArray=[],this.deviceIdArray=[],this.line=[],this.setIntervalOption=0,this.polyline=[]}ngOnInit(){this.mediaSub=this.mediaObserver.media$.subscribe(t=>{this.deviceXs="xs"===t.mqAlias}),this.myIcon=n.icon({iconUrl:"./assets/client/images/mm.png",iconSize:[20,40],iconAnchor:[12,39],color:"green",className:"icon"}),this.myIcon2=n.icon({iconUrl:"./assets/client/images/nn.png",iconSize:[20,40],iconAnchor:[12,39],color:"green",className:"icon"}),this.myIcon3=n.icon({iconUrl:"./assets/client/images/bike.png",iconSize:[40,80],iconAnchor:[12,69],color:"green",className:"icon"}),this.myIcon4=n.icon({iconUrl:"./assets/client/images/nn.png",iconSize:[0,0],iconAnchor:[0,0],color:"green",className:"icon"}),this.map=n.map("mapid",{center:[23.774252395907105,90.41607082790188],zoom:17,zoomControl:!1,attributionControl:!1});var t=n.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(this.map),e=n.tileLayer("http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{center:[33.590241,130.421222],maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]});t.addTo(this.map),n.layerGroup(this.markerArray);var i=n.layerGroup().addTo(this.map);this.baseMaps={OSM:t,"Google Map":e},this.overlayMaps={Objects:i},this.deviceService.getMovingPosition({id:1}).subscribe(t=>{console.log(t)}),n.control.layers(this.baseMaps,this.overlayMaps).addTo(this.map);var o=n.control.sidebar("sidebar").addTo(this.map);o.show(),n.easyButton("fa-exchange",(function(t,e){o.toggle()})).addTo(this.map);var s=n.control.bar("menu",{position:"bottom",visible:!1}).addTo(this.map);s.hide(),n.easyButton("fa-exchange",(function(t,e){s.toggle()}),{position:"bottomright"}).addTo(this.map),this.historyBar=n.control.bar("history",{position:"bottom",visible:!1}).addTo(this.map);var r=[];this.cusmapService.deviceDataCatch.subscribe(t=>{t&&(console.log(t),clearInterval(this.myInterval),this.check=1,this.deviceIdArray.includes(t[0].deviceid)||(this.deviceIdArray.push(t[0].deviceid),this.polyline[t[0].deviceid]=n.polyline([]).addTo(this.map),this.fixtime||(console.log("11111"),this.fixtime="2020-08-18T05:42:11.000Z",this.fixtime=this.dateFormatService.dateTime("datetime",this.fixtime)),t[0].fixtime=this.dateFormatService.dateTime("datetime",t[0].fixtime),this.fixtime<t[0].fixtime&&(this.fixtime=t[0].fixtime),t.forEach(t=>{r[t.deviceid]=n.marker([t.latitude,t.longitude],{icon:this.myIcon3}).bindPopup(t.name+" <br> Address: "+t.contact+" <br> Model: "+t.model+" <br> Phone: "+t.phone+" <br> Type: "+t.category,{closeOnClick:!0,autoClose:!1}).bindTooltip(t.name,{direction:"left",offset:[15,-45],permanent:!0}).addTo(this.map),i.addLayer(r[t.deviceid])})),this.myInterval=setInterval(()=>{this.fixtime=this.dateFormatService.dateTime("datetime",this.fixtime),1==this.check&&this.deviceService.getMovingPosition({id:this.deviceIdArray,fixtime:this.fixtime}).subscribe(t=>{t.forEach(t=>{this.fixtime=t.fixtime,console.log(this.fixtime),this.cusmapService.deviceDetails(t),n.layerGroup(),this.markerArray=n.layerGroup(),console.log(t.name);var e=JSON.parse(t.attributes);this.marker=r[t.deviceid].setLatLng([t.latitude,t.longitude],{animate:!0,duration:.5,color:"red"}).bindPopup("Name: <br> Address: "+t.latitude+","+t.longitude+" <br> Time: "+t.fixtime+" <br> Satellite: "+e.sat+" <br> Ignition: "+e.ignition+" <br> Motion: "+e.motion,{closeOnClick:!1,autoClose:!1}),this.line3=this.polyline[t.deviceid].addLatLng(n.latLng(t.latitude,t.longitude))})})},5e3))}),this.cusmapService.deviceRemoveFromMap.subscribe(t=>{t&&(t.forEach(t=>{t.deviceid&&(t.id=t.deviceid),this.deviceIdArray=this.deviceIdArray.filter(e=>e!==t.id),console.log(t.id),this.map.removeLayer(r[t.id]),this.polyline[t.id]&&this.map.removeLayer(this.polyline[t.id])}),this.deviceIdArray.length<=0&&(console.log("check"),this.check=0,clearInterval(this.myInterval)))}),this.cusmapService.deviceLocationCatch.subscribe(t=>{t&&this.map.panTo(new n.LatLng(t[0].latitude,t[0].longitude))}),this.cusmapService.detailsDataCatch.subscribe(t=>{t&&s.show()}),this.cusmapService.eventCatch.subscribe(t=>{if(t){var e,i={lat:t[0].latitude,lng:t[0].longitude};n.Control.Geocoder.nominatim().reverse(i,this.map.options.crs.scale(this.map.getZoom()),t=>{e=t[0].name}),n.marker([t[0].latitude,t[0].longitude],{icon:this.myIcon4}).addTo(this.map).bindPopup("<b>"+t[0].name+"</b> <br> Address: "+e+" <br> Latitude: "+t[0].latitude+" <br> Longitude: "+t[0].longitude+" <br> Altitude: "+t[0].altitude+" <br> Speed: "+t[0].speed+" <br> Time: "+t[0].eventtime,{closeOnClick:!0,autoClose:!1}).openPopup(),this.map.panTo(new n.LatLng(t[0].latitude,t[0].longitude))}}),this.cusmapService.deviceHistoryCatch.subscribe(t=>{if(console.log(t),t){this.map.removeLayer(i),s.hide(),this.historyBar.show();var e=n.polyline([]).addTo(this.map);this.positions=t,this.storeLatlng=[],""!=this.positions&&(this.map.setView(new n.LatLng(this.positions[0].latitude,this.positions[0].longitude),13),this.positions.forEach((t,i)=>{let o=new Date(t.servertime),s=new Date(t.fixtime);this.timeArray.push(o),this.fixtimeArray.push(s);var r=(this.timeArray[i]-this.fixtimeArray[i])/6e4;r>20&&(this.engine=n.marker([t.latitude,t.longitude],{icon:this.myIcon}).bindPopup(t.deviceid+" <br> Address: "+t.latitude+" <br> Model: "+t.longitude+" <br> Servertime: "+t.servertime+" <br> Speed: "+t.speed+" <br> Power: "+t.course,{closeOnClick:!1,autoClose:!1}).openPopup(),this.engineArray.push(this.engine),this.history=n.layerGroup(this.engineArray)),r<20&&r>5&&(this.park=n.marker([t.latitude,t.longitude],{icon:this.myIcon2}).bindPopup(t.deviceid+" <br> Address: "+void 0+" <br> Latitude: "+t.latitude+" <br> Longitude: "+t.longitude+" <br> Servertime: "+t.servertime+" <br> Altitude: "+t.altitude+" <br> Speed: "+t.speed,{closeOnClick:!1,autoClose:!1}).openPopup().addTo(this.map),this.parkArray.push(this.park),this.parking=n.layerGroup(this.parkArray)),this.route=e.addLatLng(n.latLng(t.latitude,t.longitude)),this.arrow=this.route.arrowheads({size:"12px",color:"red",yawn:40,frequency:10}),this.storeLatlng.push([t.latitude,t.longitude])}),this.overlayMaps={Route:this.route,Engine:this.history,Parking:this.parking},this.parking&&this.parking.addTo(this.map),this.polylineMotion=n.motion.polyline(this.storeLatlng,{color:" "},{auto:!1,duration:3e4,easing:n.Motion.Ease.easeInOutQuart},{removeOnEnd:!1,icon:this.myIcon3}).addTo(this.map))}}),this.cusmapService.deviceMoveCatch.subscribe(t=>{t&&this.polylineMotion.motionStart()}),this.cusmapService.deviceToggleCatch.subscribe(t=>{t&&this.polylineMotion.motionToggle()}),this.cusmapService.motionConCatch.subscribe(t=>{t&&(console.log(t),this.polylineMotion.motionSpeed(t))}),this.cusmapService.motionStoponCatch.subscribe(t=>{t&&this.polylineMotion.motionStop()}),this.cusmapService.tabIndexCatch.subscribe(t=>{t&&(this.map.setView(new n.LatLng(23.774252395907105,90.41607082790188),17),this.route&&this.map.removeLayer(this.route),this.parking&&this.map.removeLayer(this.parking),this.history&&this.map.removeLayer(this.history),this.map.addLayer(i),this.historyBar.hide())})}logout(){this.loginService.logout().subscribe(t=>{this.check=0,sessionStorage.removeItem("accessToken"),sessionStorage.removeItem("refreshToken"),this.routing.navigate(["/"])})}}return t.\u0275fac=function(e){return new(e||t)(r.Zb(a.g),r.Zb(c.a),r.Zb(l.a),r.Zb(s.c),r.Zb(u.a),r.Zb(h.a))},t.\u0275cmp=r.Tb({type:t,selectors:[["app-map-info"]],decls:47,vars:3,consts:[["id","t","fxLayout","row","fxLayout.xs","column","color","primary",1,"mi"],["fxFlex","70%","fxLayout","row","fxLayout.xs","100%"],["fxFlex","80%"],["src","assets/client/images/traccar.png","width","130","alt","avatar"],["fxLayout","row","fxFlex","30%",4,"ngIf"],["fxFlex","25%","fxLayout.xs","100%"],[1,"position"],["mat-button","",1,"menu",3,"matMenuTriggerFor"],[1,"col"],["mat-button","",1,"col"],["hospital","matMenu"],["mat-menu-item",""],["mat-button","",3,"matMenuTriggerFor",4,"ngIf"],["menu","matMenu"],["routerLink","authorization/users/user-profile","mat-menu-item",""],["routerLink","authorization/users/change-password","mat-menu-item",""],["mat-menu-item","",3,"click"],["id","mapid",2,"width","100%","height","90%"],["id","sidebar",2,"width","100%","height","100%"],["id","menu",2,"height","200px"],["id","history",2,"height","150px"],["fxLayout","row","fxFlex","30%"],["id","r","mat-button","",3,"matMenuTriggerFor"],["src","assets/client/images/avatar.png","width","35","alt","avatar",1,"logout-image"],[1,"align-middle"],["mat-button","",3,"matMenuTriggerFor"]],template:function(t,e){if(1&t&&(r.fc(0,"div",0),r.fc(1,"div",1),r.fc(2,"div",2),r.ac(3,"img",3),r.ec(),r.Pc(4,it,4,1,"div",4),r.ec(),r.fc(5,"div",5),r.fc(6,"div",6),r.fc(7,"button",7),r.fc(8,"span",8),r.Qc(9,"Tools"),r.ec(),r.fc(10,"mat-icon",8),r.Qc(11,"arrow_drop_down"),r.ec(),r.ec(),r.fc(12,"button",9),r.Qc(13,"Setup"),r.ec(),r.fc(14,"button",9),r.Qc(15,"Chat"),r.ec(),r.fc(16,"mat-menu",null,10),r.fc(18,"button",11),r.Qc(19,"Alerts"),r.ec(),r.fc(20,"button",11),r.Qc(21," Routes "),r.ec(),r.ec(),r.Pc(22,ot,3,1,"a",12),r.fc(23,"mat-menu",null,13),r.fc(25,"a",14),r.fc(26,"mat-icon"),r.Qc(27,"account_circle"),r.ec(),r.fc(28,"span"),r.Qc(29,"Profile"),r.ec(),r.ec(),r.fc(30,"a",15),r.fc(31,"mat-icon"),r.Qc(32,"settings"),r.ec(),r.fc(33,"span"),r.Qc(34,"Change Pass "),r.ec(),r.ec(),r.fc(35,"a",16),r.nc("click",(function(){return e.logout()})),r.fc(36,"mat-icon"),r.Qc(37,"exit_to_app"),r.ec(),r.fc(38,"span"),r.Qc(39,"Logout"),r.ec(),r.ec(),r.ec(),r.ec(),r.ec(),r.ec(),r.ac(40,"div",17),r.fc(41,"div",18),r.ac(42,"app-side-menu"),r.ec(),r.fc(43,"div",19),r.ac(44,"app-bottom-details"),r.ec(),r.fc(45,"div",20),r.ac(46,"app-history-info"),r.ec()),2&t){const t=r.Fc(17);r.Ob(4),r.yc("ngIf",e.deviceXs),r.Ob(3),r.yc("matMenuTriggerFor",t),r.Ob(15),r.yc("ngIf",!e.deviceXs)}},directives:[p.b,p.a,o.m,d.b,m.c,f.a,m.d,m.a,s.e,J,tt,et,d.a],styles:["h2[_ngcontent-%COMP%]{margin-top:3%}.mi[_ngcontent-%COMP%]{width:100%!important;background-color:#3f51b5;float:left}.space[_ngcontent-%COMP%]{flex:1 1 auto}.col[_ngcontent-%COMP%], .colm[_ngcontent-%COMP%]{color:#fff}.colm[_ngcontent-%COMP%]{margin-left:2%}.map[_ngcontent-%COMP%]{width:100%}a[_ngcontent-%COMP%]{cursor:pointer}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:25px 30px!important}.tab[_ngcontent-%COMP%]{overflow:hidden;border:1px solid #ccc;background-color:#e63e3e}.tab[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:inherit;float:left;border:none;outline:none;cursor:pointer;padding:14px 16px;transition:.3s}.tab[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#ddd}.tab[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#ccc}#bottommenu[_ngcontent-%COMP%]{width:900px!important}.easy-button-button.disabled[_ngcontent-%COMP%]{display:none}.position[_ngcontent-%COMP%]{margin-top:2%;margin-left:10%}.admin_button[_ngcontent-%COMP%]{margin-top:.5%}.leaflet-marker-pane[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{transition:transform .3s linear}"]}),t})()}];let nt=(()=>{class t{}return t.\u0275mod=r.Xb({type:t}),t.\u0275inj=r.Wb({factory:function(e){return new(e||t)},imports:[[s.f.forChild(st)],s.f]}),t})();var rt=i("jAig"),at=i("YUcS"),ct=i("xoCY");let lt=(()=>{class t{}return t.\u0275mod=r.Xb({type:t}),t.\u0275inj=r.Wb({factory:function(e){return new(e||t)},imports:[[o.c,nt,rt.a,at.a,ct.a,ct.b,v.q,v.i]]}),t})()}}]);