(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{Cp0R:function(e,t,c){"use strict";c.d(t,"a",(function(){return n}));var r=c("fXoL"),o=c("Ofeh"),i=c("tyNb");let n=(()=>{class e{constructor(e,t){this.loginService=e,this.router=t,this.assigedRole=[]}canActivate(e,t){return this.loginService.loggedIn()?(this.assigedRole=JSON.parse(sessionStorage.getItem("rolesData")),1==this.assigedRole.includes(e.data.roles)||(this.router.navigate(["/deny"]),!1)):(this.router.navigate(["/"]),!1)}}return e.\u0275fac=function(t){return new(t||e)(r.jc(o.a),r.jc(i.c))},e.\u0275prov=r.Vb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},EURN:function(e,t,c){"use strict";c.r(t),c.d(t,"QueryModule",(function(){return Pt}));var r=c("ofXK"),o=c("3Pt+"),i=c("jAig"),n=c("KUt4"),a=c("YUcS"),s=c("tyNb"),l=c("Cp0R"),u=c("fXoL"),m=c("dNgK"),f=c("whuR"),d=c("q+pd"),h=c("Z0sz"),g=c("Wp6s"),p=c("bSwM"),y=c("/1cH"),b=c("kmnG"),v=c("qFsG"),C=c("d3UM"),S=c("bTqV"),O=c("NFeN"),x=c("FKr1"),M=c("MutI"),q=c("f0Cb");function I(e,t){if(1&e&&(u.fc(0,"mat-option",33),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.yc("value",e.id),u.Ob(1),u.Uc(" ",e.value," ")}}function _(e,t){if(1&e){const e=u.gc();u.fc(0,"mat-form-field",31),u.fc(1,"mat-label"),u.Sc(2,"Search Type"),u.ec(),u.fc(3,"mat-select",32),u.nc("ngModelChange",(function(t){return u.Jc(e),u.rc().searchType(t)}))("ngModelChange",(function(t){return u.Jc(e),u.rc().selected=t})),u.Rc(4,I,2,2,"mat-option",15),u.ec(),u.ec()}if(2&e){const e=u.rc();u.Ob(3),u.yc("ngModel",e.selected),u.Ob(1),u.yc("ngForOf",e.searchTypes)}}function P(e,t){if(1&e){const e=u.gc();u.fc(0,"mat-form-field",34),u.fc(1,"input",35),u.nc("keyup",(function(t){return u.Jc(e),u.rc().applySearch(t.target.value)})),u.ec(),u.fc(2,"mat-hint"),u.Sc(3,"Searching and selecting field is mandatory"),u.ec(),u.ec()}if(2&e){u.rc();const e=u.Fc(12);u.Ob(1),u.yc("matAutocomplete",e)}}function k(e,t){if(1&e){const e=u.gc();u.fc(0,"mat-option",37),u.nc("ngModelChange",(function(t){return u.Jc(e),u.rc(2).onChangeCustomer(t)})),u.fc(1,"mat-list"),u.fc(2,"mat-list-item",38),u.nc("click",(function(){u.Jc(e);const c=t.$implicit;return u.rc(2).onChangeCustomer(c.id)})),u.Sc(3),u.ec(),u.ac(4,"mat-divider"),u.ec(),u.ec()}if(2&e){const e=t.$implicit;u.yc("value",e.id),u.Ob(3),u.Uc(" ",e.id," ")}}function D(e,t){if(1&e&&(u.fc(0,"span"),u.Rc(1,k,5,2,"mat-option",36),u.ec()),2&e){const e=u.rc();u.Ob(1),u.yc("ngForOf",e.searchData)}}function R(e,t){if(1&e){const e=u.gc();u.fc(0,"mat-option",37),u.nc("ngModelChange",(function(t){return u.Jc(e),u.rc(2).onChangeCustomer(t)})),u.fc(1,"mat-list"),u.fc(2,"mat-list-item",38),u.nc("click",(function(){u.Jc(e);const c=t.$implicit;return u.rc(2).onChangeCustomer(c.id)})),u.Sc(3),u.ec(),u.ac(4,"mat-divider"),u.ec(),u.ec()}if(2&e){const e=t.$implicit;u.yc("value",e.name),u.Ob(3),u.Uc(" ",e.name," ")}}function F(e,t){if(1&e&&(u.fc(0,"span"),u.Rc(1,R,5,2,"mat-option",36),u.ec()),2&e){const e=u.rc();u.Ob(1),u.yc("ngForOf",e.searchData)}}function w(e,t){if(1&e){const e=u.gc();u.fc(0,"mat-option",37),u.nc("ngModelChange",(function(t){return u.Jc(e),u.rc(2).onChangeCustomer(t)})),u.fc(1,"mat-list"),u.fc(2,"mat-list-item",38),u.nc("click",(function(){u.Jc(e);const c=t.$implicit;return u.rc(2).onChangeCustomer(c.id)})),u.Sc(3),u.ec(),u.ac(4,"mat-divider"),u.ec(),u.ec()}if(2&e){const e=t.$implicit;u.yc("value",e.email),u.Ob(3),u.Uc(" ",e.email," ")}}function A(e,t){if(1&e&&(u.fc(0,"span"),u.Rc(1,w,5,2,"mat-option",36),u.ec()),2&e){const e=u.rc();u.Ob(1),u.yc("ngForOf",e.searchData)}}function N(e,t){if(1&e){const e=u.gc();u.fc(0,"mat-option",37),u.nc("ngModelChange",(function(t){return u.Jc(e),u.rc(2).onChangeCustomer(t)})),u.fc(1,"mat-list"),u.fc(2,"mat-list-item",38),u.nc("click",(function(){u.Jc(e);const c=t.$implicit;return u.rc(2).onChangeCustomer(c.id)})),u.Sc(3),u.ec(),u.ac(4,"mat-divider"),u.ec(),u.ec()}if(2&e){const e=t.$implicit;u.yc("value",e.phone),u.Ob(3),u.Uc(" ",e.phone," ")}}function T(e,t){if(1&e&&(u.fc(0,"span"),u.Rc(1,N,5,2,"mat-option",36),u.ec()),2&e){const e=u.rc();u.Ob(1),u.yc("ngForOf",e.searchData)}}function B(e,t){if(1&e&&(u.fc(0,"mat-option",33),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.yc("value",e.value),u.Ob(1),u.Uc(" ",e.value," ")}}function J(e,t){if(1&e&&(u.fc(0,"mat-option",33),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.yc("value",e.value),u.Ob(1),u.Uc(" ",e.value," ")}}function Q(e,t){if(1&e&&(u.fc(0,"mat-option",33),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.yc("value",e.value),u.Ob(1),u.Uc(" ",e.value," ")}}function $(e,t){if(1&e&&(u.fc(0,"mat-option",33),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.yc("value",e.id),u.Ob(1),u.Uc(" ",e.name," ")}}function U(e,t){if(1&e&&(u.fc(0,"mat-option",33),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.yc("value",e.model_bdcom),u.Ob(1),u.Uc(" ",e.model_bdcom," ")}}function j(e,t){if(1&e){const e=u.gc();u.fc(0,"span"),u.fc(1,"a",51),u.fc(2,"mat-icon",38),u.nc("click",(function(){u.Jc(e);const t=u.rc().index;return u.rc().removeAttributes(t)})),u.Sc(3,"clear"),u.ec(),u.ec(),u.ec()}}function Z(e,t){if(1&e){const e=u.gc();u.fc(0,"div",39),u.fc(1,"div",40),u.fc(2,"mat-form-field",41),u.fc(3,"mat-label"),u.Sc(4,"Category"),u.ec(),u.fc(5,"mat-select",42,43),u.nc("ngModelChange",(function(c){u.Jc(e);const r=t.index;return u.rc().onChange(c,r)})),u.fc(7,"input",44),u.nc("keyup",(function(t){return u.Jc(e),u.rc().applyFilter(t.target.value)})),u.ec(),u.fc(8,"a",45),u.fc(9,"mat-icon",38),u.nc("click",(function(){return u.Jc(e),u.Fc(6).close()})),u.Sc(10,"clear"),u.ec(),u.ec(),u.Rc(11,$,2,2,"mat-option",15),u.ec(),u.ec(),u.fc(12,"mat-form-field",41),u.fc(13,"mat-label"),u.Sc(14,"Model"),u.ec(),u.fc(15,"mat-select",46,47),u.nc("ngModelChange",(function(c){u.Jc(e);const r=t.index;return u.rc().onChangeModel(c,r)})),u.fc(17,"input",44),u.nc("keyup",(function(t){return u.Jc(e),u.rc().applyFilterP(t.target.value)})),u.ec(),u.fc(18,"a",45),u.fc(19,"mat-icon",38),u.nc("click",(function(){return u.Jc(e),u.Fc(16).close()})),u.Sc(20,"clear"),u.ec(),u.ec(),u.Rc(21,U,2,2,"mat-option",15),u.ec(),u.ec(),u.fc(22,"mat-form-field",41),u.ac(23,"input",48),u.ec(),u.fc(24,"mat-form-field",41),u.fc(25,"input",49),u.nc("ngModelChange",(function(c){u.Jc(e);const r=t.index;return u.rc().unitPriceIndex[r]=c})),u.ec(),u.ec(),u.fc(26,"mat-checkbox",50),u.Sc(27," Complementary "),u.ec(),u.Rc(28,j,4,0,"span",9),u.ec(),u.ec()}if(2&e){const e=t.index,c=u.rc();u.Ob(1),u.yc("formArrayName",e),u.Ob(10),u.yc("ngForOf",c.categories),u.Ob(4),u.yc("id","model"+e),u.Ob(6),u.yc("ngForOf",c.productIndex[e]),u.Ob(4),u.yc("id","price"+e)("ngModel",c.unitPriceIndex[e]),u.Ob(3),u.yc("ngIf",c.myform.get("products").length>1)}}function L(e,t){if(1&e){const e=u.gc();u.fc(0,"span"),u.fc(1,"a",51),u.fc(2,"mat-icon",38),u.nc("click",(function(){u.Jc(e);const t=u.rc().index;return u.rc(2).removeMrc(t)})),u.Sc(3,"clear"),u.ec(),u.ec(),u.ec()}}function V(e,t){if(1&e){const e=u.gc();u.fc(0,"div",54),u.fc(1,"div",40),u.fc(2,"mat-form-field",55),u.fc(3,"input",56),u.nc("ngModelChange",(function(t){return u.Jc(e),u.rc(2).onCheck(t)})),u.ec(),u.ec(),u.fc(4,"mat-form-field",55),u.ac(5,"input",57),u.ec(),u.Rc(6,L,4,0,"span",9),u.ec(),u.ec()}if(2&e){const e=t.index,c=u.rc(2);u.Ob(1),u.yc("formArrayName",e),u.Ob(5),u.yc("ngIf",c.myform.get("mrc").length>1)}}function E(e,t){if(1&e){const e=u.gc();u.fc(0,"div",52),u.Rc(1,V,7,2,"div",53),u.fc(2,"span",23),u.fc(3,"button",24),u.nc("click",(function(){return u.Jc(e),u.rc().addMoreMrc()})),u.fc(4,"mat-icon"),u.Sc(5,"add"),u.ec(),u.ec(),u.ec(),u.ec()}if(2&e){const e=u.rc();u.Ob(1),u.yc("ngForOf",e.myform.get("mrc").controls)}}function H(e,t){if(1&e&&(u.fc(0,"mat-option",33),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.yc("value",e.value),u.Ob(1),u.Uc(" ",e.value," ")}}function z(e,t){if(1&e){const e=u.gc();u.fc(0,"a"),u.fc(1,"mat-icon",38),u.nc("click",(function(){u.Jc(e);const t=u.rc().index;return u.rc().removeFile(t)})),u.Sc(2,"clear"),u.ec(),u.ec()}}function G(e,t){if(1&e){const e=u.gc();u.fc(0,"div",58),u.fc(1,"div",40),u.fc(2,"mat-form-field",59),u.fc(3,"mat-label"),u.Sc(4,"Type"),u.ec(),u.fc(5,"mat-select",60),u.Rc(6,H,2,2,"mat-option",15),u.ec(),u.ec(),u.ac(7,"img",61),u.fc(8,"mat-label",62),u.Sc(9,"File "),u.ec(),u.fc(10,"input",63),u.nc("change",(function(t){return u.Jc(e),u.rc().onFileSelected(t)})),u.ec(),u.Rc(11,z,3,0,"a",9),u.ec(),u.ec()}if(2&e){const e=t.index,c=u.rc();u.Ob(1),u.yc("formArrayName",e),u.Ob(5),u.yc("ngForOf",c.types),u.Ob(5),u.yc("ngIf",c.myform.get("files").length>1)}}let W=(()=>{class e{constructor(e,t,c,r,o,i,n){this.fb=e,this.router=t,this.snackBar=c,this.queryService=r,this.categoryService=o,this.productService=i,this.cdr=n,this.showMrc=0,this.searchFlag=0,this.groupItems=[],this.fileurl=null,this.unitPriceIndex=[],this.productIndex=[],this.submitted=!1,this.states=[{id:1,value:"GPS Device"},{id:0,value:"Camera"},{id:0,value:"Burzer"}],this.priorities=[{id:1,value:"Low"},{id:0,value:"High"},{id:0,value:"Medium"}],this.sources=[{id:1,value:"Phone"},{id:0,value:"Email"},{id:0,value:"Web"}],this.types=[{id:1,value:"Document"},{id:0,value:"Image"},{id:0,value:"Binary"}],this.searchTypes=[{id:1,value:"Customer ID"},{id:2,value:"Name"},{id:3,value:"Email"},{id:4,value:"Phone"}],this.selected=1}ngOnInit(){this.myform=this.fb.group({name:["",[o.u.required]],phone:["",[o.u.required]],email:[""],contact_address:["",[o.u.required]],billing_address:["",[o.u.required]],source:["",[o.u.required]],status:[""],remarks:[""],type:["",[o.u.required]],priority:["",[o.u.required]],created_by:[""],products:this.fb.array([this.moreProducts()]),mrc:this.fb.array([this.moreMrc()]),files:this.fb.array([this.moreFile()]),existing_customer:[],search:[""],item:[""],search_type:[""]}),this.getAllCategory()}moreProducts(){return this.fb.group({category:[],complementary:[],model:[""],quantity:[],price:[]})}get fArray(){return this.myform.get("products")}addMoreProducts(){this.fArray.push(this.moreProducts())}removeAttributes(e){this.myform.get("products").removeAt(e)}moreMrc(){return this.fb.group({title:[""],amount:[""]})}get Array(){return this.myform.get("mrc")}addMoreMrc(){this.Array.push(this.moreMrc())}removeMrc(e){this.myform.get("mrc").removeAt(e)}moreFile(){return this.fb.group({type:[""],file:[""]})}get fileArray(){return this.myform.get("files")}addMoreFile(){this.fileArray.push(this.moreFile())}removeFile(e){this.myform.get("files").removeAt(e)}getAllCategory(){this.categoryService.getAllCategory().subscribe(e=>{this.categories=e,this.filterCategories=this.categories})}applyFilter(e){this.categories=this.filterCategories.filter(t=>t.name.toLowerCase().indexOf(e)>-1)}applyFilterP(e){this.products=this.filterProducts.filter(t=>t.model_bdcom.toLowerCase().indexOf(e)>-1)}openSnackBar(){this.snackBar.open("Successfully added!!","Close",{duration:2e3,verticalPosition:"top",horizontalPosition:"end"})}onChange(e,t){this.productService.getProductByCategory(e).subscribe(e=>{this.productIndex[t]=this.products=e,console.log(this.products),this.filterProducts=this.products}),console.log("test validate");let c=this.myform.get("products").controls;for(let r of c)r.controls.model.setValidators(o.u.required),r.controls.quantity.setValidators(o.u.required),r.controls.model.updateValueAndValidity(),r.controls.quantity.updateValueAndValidity()}onCheck(e){let t=this.myform.get("mrc").controls;for(let c of t)c.controls.amount.setValidators(o.u.required),c.controls.amount.updateValueAndValidity()}isActive(e){const t=this.myform.get("campaign");"Agent"===e?t.setValidators(o.u.required):t.clearValidators(),t.updateValueAndValidity()}onChangeModel(e,t){console.log(e),this.objIndex=this.products.findIndex(t=>t.model_bdcom==e),console.log(this.objIndex),this.unitPriceIndex[t]=this.unitPrice=this.products[this.objIndex].price,console.log(this.products[this.objIndex].price)}onFileSelected(e){if(e.target.files.length>0){this.files=e.target.files[0],console.log(this.files);const t=new FileReader;t.onload=e=>{this.fileurl=e.target.result},t.readAsDataURL(this.files)}}check(e){e?(this.existing_customer=1,this.c=this.myform.get("search"),this.c.setValidators(o.u.required),this.searchFlag=1):(this.c.clearValidators(),this.searchFlag=0),console.log("tttttttttt")}checkMrc(e){this.showMrc=e?1:0}applySearch(e){this.queryService.filterSearch({name:e}).subscribe(e=>{this.searchData=e,console.log(this.searchData)})}onChangeCustomer(e){const t=this.searchData.map(e=>e.id).indexOf(e);console.log(t),e&&(this.name=this.searchData[t].name,this.phone=this.searchData[t].phone,this.email=this.searchData[t].email,this.type=this.searchData[t].type,this.priority=this.searchData[t].priority,this.source=this.searchData[t].source,this.contact_address=this.searchData[t].contact_address,this.billing_address=this.searchData[t].billing_address)}searchType(e){this.typeFlag=e;const t=e-1;console.log(this.searchTypes[t].value),this.search_type=this.searchTypes[t].value,this.cdr.detectChanges()}errorMessage(){this.snackBar.open("Something is error!!","Close",{duration:2e3,verticalPosition:"top",horizontalPosition:"end"})}addQuery(){this.submitted=!0,this.myform.markAllAsTouched(),this.myform.invalid||(this.queryID=Math.random().toString().slice(2,11),this.myform.value.queryID=this.queryID,this.userData=JSON.parse(localStorage.getItem("userData")),this.myform.value.created_by=this.userData.id,this.object={existing_customer:this.existing_customer,search_type:this.search_type,queryID:this.queryID,name:this.myform.value.name,email:this.myform.value.email,remarks:this.myform.value.remarks,phone:this.myform.value.phone,contact_address:this.myform.value.contact_address,billing_address:this.myform.value.billing_address,source:this.myform.value.source,type:this.myform.value.type,priority:this.myform.value.priority,created_by:this.myform.value.created_by,status:"New"},this.myform.value.products&&this.myform.value.products.forEach(e=>{e.totalPrice=e.price*e.quantity,e.queryID=this.queryID,this.queryService.addQueryProduct(e).subscribe()}),this.myform.value.mrc.forEach(e=>{e.queryID=this.queryID,this.queryService.addQueryMrc(e).subscribe(),console.log(e)}),this.myform.value.files.forEach(e=>{e.queryID=this.queryID,console.log(e.file);const t=new FormData;t.append("file",this.files),t.append("queryID",this.queryID),t.append("type",this.myform.get("type").value),this.queryService.addQueryFile(t).subscribe()}),this.queryService.addQuery(this.object).subscribe(e=>{this.openSnackBar(),this.router.navigate(["/admin/query/list"])},e=>{this.errorMessage()}))}}return e.\u0275fac=function(t){return new(t||e)(u.Zb(o.e),u.Zb(s.c),u.Zb(m.a),u.Zb(f.a),u.Zb(d.a),u.Zb(h.a),u.Zb(u.i))},e.\u0275cmp=u.Tb({type:e,selectors:[["app-query-add"]],decls:69,vars:22,consts:[[1,"customStyle"],[1,"title-style"],[1,"fl"],[1,"content",3,"formGroup"],[2,"font-size","12px"],[1,"exist_customer",3,"change"],["class","type_customer","appearance","outline",4,"ngIf"],["class","search_field","appearance","outline",4,"ngIf"],["auto","matAutocomplete"],[4,"ngIf"],[1,"half"],["trim","blur","matInput","","placeholder","Name","formControlName","name","autocomplete","off","required","",3,"ngModel","ngModelChange"],["matInput","","placeholder","Phone","formControlName","phone","autocomplete","off","required","",3,"ngModel","ngModelChange"],["matInput","","placeholder","Email","formControlName","email","autocomplete","off",3,"ngModel","ngModelChange"],["formControlName","type","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","priority","required","",3,"ngModel","ngModelChange"],["formControlName","source","required","",3,"ngModel","ngModelChange"],["matInput","","placeholder","Contact Address","formControlName","contact_address","autocomplete","off","required","",3,"ngModel","ngModelChange"],["matInput","","placeholder","Billing Address","formControlName","billing_address","autocomplete","off","required","",3,"ngModel","ngModelChange"],[1,"full"],[1,"product"],["formArrayName","products",4,"ngFor","ngForOf"],[1,"addbutton"],["mat-button","",1,"mat-primary",3,"click"],[3,"change"],["class","mrc",4,"ngIf"],[1,"files"],["formArrayName","files",4,"ngFor","ngForOf"],["matInput","","placeholder","Remarks","formControlName","remarks","autocomplete","off","required",""],["mat-stroked-button","","color","primary",1,"btn-block",3,"disabled","click"],["appearance","outline",1,"type_customer"],["formControlName","search_type",3,"ngModel","ngModelChange"],[3,"value"],["appearance","outline",1,"search_field"],["matInput","","placeholder","Input Text","formControlName","search",3,"matAutocomplete","keyup"],[3,"value","ngModelChange",4,"ngFor","ngForOf"],[3,"value","ngModelChange"],[3,"click"],["formArrayName","products"],[3,"formArrayName"],[1,"quater"],["formControlName","category",3,"ngModelChange"],["sl",""],["matInput","","placeholder","search","autocomplete","off",1,"filterBox",3,"keyup"],[1,"closeButton"],["formControlName","model",3,"id","ngModelChange"],["cl",""],["matInput","","placeholder","Quantity","formControlName","quantity","autocomplete","off"],["matInput","","placeholder","Unit Price","formControlName","price","autocomplete","off",3,"id","ngModel","ngModelChange"],["formControlName","complementary","labelPosition","before",1,"checkbox"],[1,"delAssigns"],[1,"mrc"],["formArrayName","mrc",4,"ngFor","ngForOf"],["formArrayName","mrc"],[1,"semi"],["matInput","","placeholder","Title","formControlName","title","autocomplete","off",3,"ngModelChange"],["matInput","","placeholder","Amount","formControlName","amount","autocomplete","off"],["formArrayName","files"],[1,"semiType"],["formControlName","type"],["type","hide"],[1,"image"],["type","file","formControlName","file","enctype","multipart/form-data",1,"image",3,"change"]],template:function(e,t){1&e&&(u.fc(0,"mat-card",0),u.fc(1,"div",1),u.fc(2,"mat-card-title"),u.Sc(3,"Query Form"),u.ec(),u.ec(),u.fc(4,"mat-card-content",2),u.fc(5,"form",3),u.fc(6,"div",4),u.fc(7,"mat-checkbox",5),u.nc("change",(function(e){return t.check(e.checked)})),u.Sc(8,"Exist Customer "),u.ec(),u.Rc(9,_,5,2,"mat-form-field",6),u.Rc(10,P,4,1,"mat-form-field",7),u.fc(11,"mat-autocomplete",null,8),u.Rc(13,D,2,1,"span",9),u.Rc(14,F,2,1,"span",9),u.Rc(15,A,2,1,"span",9),u.Rc(16,T,2,1,"span",9),u.ec(),u.ec(),u.fc(17,"mat-form-field",10),u.fc(18,"input",11),u.nc("ngModelChange",(function(e){return t.name=e})),u.ec(),u.ec(),u.fc(19,"mat-form-field",10),u.fc(20,"input",12),u.nc("ngModelChange",(function(e){return t.phone=e})),u.ec(),u.ec(),u.fc(21,"mat-form-field",10),u.fc(22,"input",13),u.nc("ngModelChange",(function(e){return t.email=e})),u.ec(),u.ec(),u.fc(23,"mat-form-field",10),u.fc(24,"mat-label"),u.Sc(25,"Type"),u.ec(),u.fc(26,"mat-select",14),u.nc("ngModelChange",(function(e){return t.type=e})),u.Rc(27,B,2,2,"mat-option",15),u.ec(),u.ec(),u.fc(28,"mat-form-field",10),u.fc(29,"mat-label"),u.Sc(30,"Priority"),u.ec(),u.fc(31,"mat-select",16),u.nc("ngModelChange",(function(e){return t.priority=e})),u.Rc(32,J,2,2,"mat-option",15),u.ec(),u.ec(),u.fc(33,"mat-form-field",10),u.fc(34,"mat-label"),u.Sc(35,"Source"),u.ec(),u.fc(36,"mat-select",17),u.nc("ngModelChange",(function(e){return t.source=e})),u.Rc(37,Q,2,2,"mat-option",15),u.ec(),u.ec(),u.fc(38,"mat-form-field",10),u.fc(39,"textarea",18),u.nc("ngModelChange",(function(e){return t.contact_address=e})),u.ec(),u.ec(),u.fc(40,"mat-form-field",10),u.fc(41,"textarea",19),u.nc("ngModelChange",(function(e){return t.billing_address=e})),u.ec(),u.ec(),u.fc(42,"div",20),u.Sc(43," Products:"),u.ec(),u.fc(44,"div",21),u.Rc(45,Z,29,7,"div",22),u.fc(46,"span",23),u.fc(47,"button",24),u.nc("click",(function(){return t.addMoreProducts()})),u.fc(48,"mat-icon"),u.Sc(49,"add"),u.ec(),u.ec(),u.ec(),u.ec(),u.fc(50,"div",20),u.fc(51,"mat-checkbox",25),u.nc("change",(function(e){return t.checkMrc(e.checked)})),u.ec(),u.Sc(52," MRC "),u.ec(),u.Rc(53,E,6,1,"div",26),u.fc(54,"div",20),u.Sc(55,"Files:"),u.ec(),u.fc(56,"div",27),u.Rc(57,G,12,3,"div",28),u.fc(58,"span",23),u.fc(59,"button",24),u.nc("click",(function(){return t.addMoreFile()})),u.fc(60,"mat-icon"),u.Sc(61,"add"),u.ec(),u.ec(),u.ec(),u.ec(),u.fc(62,"mat-form-field",20),u.ac(63,"textarea",29),u.ec(),u.ec(),u.ec(),u.fc(64,"mat-card-actions"),u.fc(65,"button",30),u.nc("click",(function(){return t.addQuery()})),u.Sc(66," Submit "),u.ec(),u.fc(67,"p"),u.Sc(68,"Note: Field marked with * is Mandatory"),u.ec(),u.ec(),u.ec()),2&e&&(u.Ob(5),u.yc("formGroup",t.myform),u.Ob(4),u.yc("ngIf",1==t.searchFlag),u.Ob(1),u.yc("ngIf",1==t.searchFlag),u.Ob(3),u.yc("ngIf",1==t.typeFlag),u.Ob(1),u.yc("ngIf",2==t.typeFlag),u.Ob(1),u.yc("ngIf",3==t.typeFlag),u.Ob(1),u.yc("ngIf",4==t.typeFlag),u.Ob(2),u.yc("ngModel",t.name),u.Ob(2),u.yc("ngModel",t.phone),u.Ob(2),u.yc("ngModel",t.email),u.Ob(4),u.yc("ngModel",t.type),u.Ob(1),u.yc("ngForOf",t.states),u.Ob(4),u.yc("ngModel",t.priority),u.Ob(1),u.yc("ngForOf",t.priorities),u.Ob(4),u.yc("ngModel",t.source),u.Ob(1),u.yc("ngForOf",t.sources),u.Ob(2),u.yc("ngModel",t.contact_address),u.Ob(2),u.yc("ngModel",t.billing_address),u.Ob(4),u.yc("ngForOf",t.myform.get("products").controls),u.Ob(8),u.yc("ngIf",t.showMrc),u.Ob(4),u.yc("ngForOf",t.myform.get("files").controls),u.Ob(8),u.yc("disabled",!t.myform.valid))},directives:[g.a,g.f,g.c,o.v,o.o,o.g,p.a,r.m,y.a,b.c,v.b,o.c,o.n,o.f,o.t,b.g,C.a,r.l,S.b,O.a,g.b,x.o,y.c,b.f,M.a,M.b,q.a,o.d],styles:["mat-card[_ngcontent-%COMP%]{width:80%;top:0}.fl[_ngcontent-%COMP%]{position:relative;display:flex}.customStyle[_ngcontent-%COMP%]{border-radius:10px 10px 10px 10px;box-shadow:5px 10px 15px #1a237e}.customStyle[_ngcontent-%COMP%]   .title-style[_ngcontent-%COMP%]{color:#1a237e;text-align:center!important}.customStyle[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{color:red;margin-left:30px}.customStyle[_ngcontent-%COMP%]   .error_message[_ngcontent-%COMP%]{color:red;margin-left:20px;margin-top:-10px;font-size:12px}.mat-stroked-button[_ngcontent-%COMP%]{width:120px;border:1px solid #00f}.sidenav-content[_ngcontent-%COMP%]{height:120%}.filterBox[_ngcontent-%COMP%]{width:150px;height:25px;margin-left:10px;margin-top:5px;margin-bottom:5px;border-radius:10px 10px 10px 10px;border:2px solid #000}.product[_ngcontent-%COMP%]{margin-left:3%;float:left}.quater[_ngcontent-%COMP%]{width:14%;margin-left:2%}.semi[_ngcontent-%COMP%], .semiType[_ngcontent-%COMP%]{width:35%;margin-left:5%}.semiType[_ngcontent-%COMP%]{margin-right:5%}.addbutton[_ngcontent-%COMP%]{float:right;margin-top:-45px;margin-right:80px}.delAssigns[_ngcontent-%COMP%]{margin-left:10px;margin-top:-20px}.image[_ngcontent-%COMP%]{width:25%}.exist_customer[_ngcontent-%COMP%]{margin-left:5%}.type_customer[_ngcontent-%COMP%]{margin-left:2%;margin-right:2%}"]}),e})();var X=c("CjG4"),K=c("zkoq"),Y=c("+0xr"),ee=c("Dh3D"),te=c("iadO"),ce=c("Xa2L");function re(e,t){1&e&&(u.fc(0,"th",23),u.Sc(1,"Category"),u.ec())}function oe(e,t){if(1&e&&(u.fc(0,"td",24),u.Sc(1),u.ec()),2&e){const e=t.$implicit,c=u.rc(2);u.Ob(1),u.Tc(null==c.categoryIndex[null==e?null:e.category]?null:c.categoryIndex[null==e?null:e.category].name)}}function ie(e,t){1&e&&(u.fc(0,"th",23),u.Sc(1,"Model"),u.ec())}function ne(e,t){if(1&e&&(u.fc(0,"td",24),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.Ob(1),u.Tc(e.model)}}function ae(e,t){1&e&&(u.fc(0,"th",23),u.Sc(1,"Unit Price"),u.ec())}function se(e,t){if(1&e&&(u.fc(0,"td",24),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.Ob(1),u.Tc(e.unit_price)}}function le(e,t){1&e&&(u.fc(0,"th",23),u.Sc(1,"Quantity"),u.ec())}function ue(e,t){if(1&e&&(u.fc(0,"td",24),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.Ob(1),u.Tc(e.quantity)}}function me(e,t){1&e&&(u.fc(0,"th",23),u.Sc(1,"Total Price"),u.ec())}function fe(e,t){if(1&e&&(u.fc(0,"td",24),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.Ob(1),u.Tc(e.total_price)}}function de(e,t){1&e&&(u.fc(0,"th",23),u.Sc(1,"Complementary"),u.ec())}function he(e,t){if(1&e&&(u.fc(0,"td",24),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.Ob(1),u.Tc(e.complementary)}}function ge(e,t){1&e&&u.ac(0,"tr",25)}function pe(e,t){1&e&&u.ac(0,"tr",26)}function ye(e,t){1&e&&(u.fc(0,"th",23),u.Sc(1,"Title"),u.ec())}function be(e,t){if(1&e&&(u.fc(0,"td",24),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.Ob(1),u.Tc(e.title)}}function ve(e,t){1&e&&(u.fc(0,"th",23),u.Sc(1,"Amount"),u.ec())}function Ce(e,t){if(1&e&&(u.fc(0,"td",24),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.Ob(1),u.Tc(e.amount)}}function Se(e,t){1&e&&u.ac(0,"tr",25)}function Oe(e,t){1&e&&u.ac(0,"tr",26)}function xe(e,t){if(1&e&&(u.fc(0,"div"),u.fc(1,"mat-grid-list",29),u.fc(2,"mat-grid-tile",30),u.fc(3,"div"),u.fc(4,"b"),u.Sc(5," By:"),u.ec(),u.Sc(6),u.ac(7,"br"),u.fc(8,"b"),u.Sc(9," Time:"),u.ec(),u.Sc(10),u.sc(11,"date"),u.ac(12,"br"),u.fc(13,"b"),u.Sc(14," States:"),u.ec(),u.Sc(15),u.ac(16,"br"),u.ec(),u.ec(),u.fc(17,"mat-grid-tile",30),u.Sc(18),u.ec(),u.ac(19,"mat-divider"),u.ec(),u.ec()),2&e){const e=t.$implicit,c=u.rc(3);u.Ob(2),u.yc("colspan",3),u.Ob(4),u.Uc(" ",null==c.usersIndex[null==e?null:e.created_by]?null:c.usersIndex[null==e?null:e.created_by].full_name,""),u.Ob(4),u.Uc(" ",u.uc(11,6,null==e?null:e.created_time,"medium"),""),u.Ob(5),u.Tc(null==e?null:e.state),u.Ob(2),u.yc("colspan",5),u.Ob(1),u.Uc(" ",null==e?null:e.remark,"")}}function Me(e,t){if(1&e&&(u.fc(0,"div",27),u.fc(1,"b"),u.Sc(2,"Query Action "),u.ec(),u.ac(3,"br"),u.Rc(4,xe,20,9,"div",28),u.ec()),2&e){const e=u.rc(2);u.Ob(4),u.yc("ngForOf",e.queryAction)}}function qe(e,t){if(1&e){const e=u.gc();u.fc(0,"div"),u.fc(1,"button",31),u.nc("click",(function(){return u.Jc(e),u.rc(2).reopenForm()})),u.Sc(2,"Reopen"),u.ec(),u.ec()}}function Ie(e,t){if(1&e&&u.ac(0,"img",43),2&e){const e=u.rc(3);u.yc("src",e.fileurl,u.Kc)}}function _e(e,t){if(1&e&&(u.fc(0,"mat-option",44),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.yc("value",e.value),u.Ob(1),u.Uc(" ",e.value," ")}}function Pe(e,t){if(1&e&&(u.fc(0,"mat-form-field",34),u.fc(1,"mat-label"),u.Sc(2,"Choose a date"),u.ec(),u.ac(3,"input",45),u.ac(4,"mat-datepicker-toggle",46),u.ac(5,"mat-datepicker",null,47),u.ec()),2&e){const e=u.Fc(6);u.Ob(3),u.yc("matDatepicker",e),u.Ob(1),u.yc("for",e)}}function ke(e,t){if(1&e){const e=u.gc();u.fc(0,"div",32),u.fc(1,"b"),u.Sc(2,"Form:"),u.ec(),u.ac(3,"br"),u.fc(4,"form",33),u.fc(5,"mat-form-field",34),u.ac(6,"textarea",35),u.ec(),u.fc(7,"div",34),u.Rc(8,Ie,1,1,"img",36),u.fc(9,"mat-label",37),u.Sc(10,"File "),u.ec(),u.fc(11,"input",38),u.nc("change",(function(t){return u.Jc(e),u.rc(2).onFileSelected(t)})),u.ec(),u.ac(12,"br"),u.ec(),u.fc(13,"div"),u.fc(14,"mat-form-field",34),u.fc(15,"mat-label"),u.Sc(16,"States"),u.ec(),u.fc(17,"mat-select",39),u.nc("ngModelChange",(function(t){return u.Jc(e),u.rc(2).onChangeState(t)})),u.Rc(18,_e,2,2,"mat-option",40),u.ec(),u.ec(),u.Rc(19,Pe,7,2,"mat-form-field",41),u.ec(),u.fc(20,"div"),u.fc(21,"mat-card-actions"),u.fc(22,"button",42),u.nc("click",(function(){return u.Jc(e),u.rc(2).addQueryAction()})),u.Sc(23," Submit "),u.ec(),u.fc(24,"p"),u.Sc(25,"Note: Field marked with * is Mandatory"),u.ec(),u.ec(),u.ec(),u.ec(),u.ec()}if(2&e){const e=u.rc(2);u.Ob(4),u.yc("formGroup",e.myform),u.Ob(4),u.yc("ngIf",e.fileurl),u.Ob(10),u.yc("ngForOf",e.states),u.Ob(1),u.yc("ngIf",1==e.show),u.Ob(3),u.yc("disabled",!e.myform.valid)}}const De=function(){return[0]};function Re(e,t){if(1&e){const e=u.gc();u.fc(0,"mat-card",2),u.fc(1,"div"),u.fc(2,"button",3),u.nc("click",(function(){return u.Jc(e),u.rc().goBack()})),u.fc(3,"mat-icon"),u.Sc(4,"arrow_back"),u.ec(),u.ec(),u.ec(),u.fc(5,"div",4),u.fc(6,"div"),u.fc(7,"mat-card-title"),u.Sc(8,"Query Details"),u.ec(),u.ec(),u.ec(),u.fc(9,"div"),u.fc(10,"div"),u.fc(11,"mat-grid-list",5),u.fc(12,"mat-grid-tile"),u.fc(13,"div"),u.fc(14,"b"),u.Sc(15,"Name:"),u.ec(),u.Sc(16),u.ec(),u.ec(),u.fc(17,"mat-grid-tile"),u.fc(18,"div"),u.fc(19,"b"),u.Sc(20,"Email:"),u.ec(),u.Sc(21),u.ec(),u.ec(),u.fc(22,"mat-grid-tile"),u.fc(23,"div"),u.fc(24,"b"),u.Sc(25,"Phone:"),u.ec(),u.Sc(26),u.ec(),u.ec(),u.fc(27,"mat-grid-tile"),u.fc(28,"div"),u.fc(29,"b"),u.Sc(30,"Type:"),u.ec(),u.Sc(31),u.ec(),u.ec(),u.fc(32,"mat-grid-tile"),u.fc(33,"div"),u.fc(34,"b"),u.Sc(35,"Priority:"),u.ec(),u.Sc(36),u.ec(),u.ec(),u.fc(37,"mat-grid-tile"),u.fc(38,"div"),u.fc(39,"b"),u.Sc(40,"Source:"),u.ec(),u.Sc(41),u.ec(),u.ec(),u.fc(42,"mat-grid-tile"),u.fc(43,"b"),u.Sc(44,"Status :"),u.ec(),u.Sc(45),u.ec(),u.fc(46,"mat-grid-tile"),u.fc(47,"div"),u.fc(48,"b"),u.Sc(49," Created : "),u.ec(),u.Sc(50),u.ac(51,"br"),u.Sc(52),u.sc(53,"date"),u.ac(54,"br"),u.ec(),u.ec(),u.fc(55,"mat-grid-tile"),u.fc(56,"div"),u.fc(57,"b"),u.Sc(58,"Updated :"),u.ec(),u.Sc(59),u.ac(60,"br"),u.Sc(61),u.sc(62,"date"),u.ec(),u.ec(),u.ec(),u.ec(),u.fc(63,"div"),u.fc(64,"b"),u.Sc(65,"Product "),u.ec(),u.ac(66,"br"),u.fc(67,"table",6,7),u.dc(69,8),u.Rc(70,re,2,0,"th",9),u.Rc(71,oe,2,1,"td",10),u.cc(),u.dc(72,11),u.Rc(73,ie,2,0,"th",9),u.Rc(74,ne,2,1,"td",10),u.cc(),u.dc(75,12),u.Rc(76,ae,2,0,"th",9),u.Rc(77,se,2,1,"td",10),u.cc(),u.dc(78,13),u.Rc(79,le,2,0,"th",9),u.Rc(80,ue,2,1,"td",10),u.cc(),u.dc(81,14),u.Rc(82,me,2,0,"th",9),u.Rc(83,fe,2,1,"td",10),u.cc(),u.dc(84,15),u.Rc(85,de,2,0,"th",9),u.Rc(86,he,2,1,"td",10),u.cc(),u.Rc(87,ge,1,0,"tr",16),u.Rc(88,pe,1,0,"tr",17),u.ec(),u.ec(),u.fc(89,"div"),u.fc(90,"b"),u.Sc(91,"Mrc "),u.ec(),u.ac(92,"br"),u.fc(93,"table",6,7),u.dc(95,18),u.Rc(96,ye,2,0,"th",9),u.Rc(97,be,2,1,"td",10),u.cc(),u.dc(98,19),u.Rc(99,ve,2,0,"th",9),u.Rc(100,Ce,2,1,"td",10),u.cc(),u.Rc(101,Se,1,0,"tr",16),u.Rc(102,Oe,1,0,"tr",17),u.ec(),u.ec(),u.Rc(103,Me,5,1,"div",20),u.ec(),u.Rc(104,qe,3,0,"div",21),u.Rc(105,ke,26,5,"div",22),u.ec()}if(2&e){const e=u.rc();u.Ob(16),u.Uc(" ",e.queryData.name,""),u.Ob(5),u.Uc(" ",e.queryData.email,""),u.Ob(5),u.Uc(" ",e.queryData.phone,""),u.Ob(5),u.Uc(" ",e.queryData.type,""),u.Ob(5),u.Uc(" ",e.queryData.priority,""),u.Ob(5),u.Uc(" ",e.queryData.source,""),u.Ob(4),u.Tc(null==e.queryData?null:e.queryData.status),u.Ob(5),u.Uc(" By: ",null==e.usersIndex[null==e.queryData?null:e.queryData.created_by]?null:e.usersIndex[null==e.queryData?null:e.queryData.created_by].full_name,""),u.Ob(2),u.Uc(" Time: ",u.uc(53,22,null==e.queryData?null:e.queryData.created_time,"medium"),""),u.Ob(7),u.Uc(" By: ",null==e.usersIndex[null==e.queryData?null:e.queryData.created_by]?null:e.usersIndex[null==e.queryData?null:e.queryData.created_by].full_name,""),u.Ob(2),u.Uc(" Time: ",u.uc(62,25,null==e.queryData?null:e.queryData.created_time,"medium"),""),u.Ob(6),u.yc("dataSource",e.queryProducts)("hiddenColumns",u.Ac(28,De)),u.Ob(20),u.yc("matHeaderRowDef",e.displayedColumns),u.Ob(1),u.yc("matRowDefColumns",e.displayedColumns),u.Ob(5),u.yc("dataSource",e.queryMrc)("hiddenColumns",u.Ac(29,De)),u.Ob(8),u.yc("matHeaderRowDef",e.displayedMrcColumns),u.Ob(1),u.yc("matRowDefColumns",e.displayedMrcColumns),u.Ob(1),u.yc("ngIf",""!=e.queryAction),u.Ob(1),u.yc("ngIf",1==e.reopen),u.Ob(1),u.yc("ngIf","Canceled"!=e.queryData.status&&"Successful"!=e.queryData.status&&"Failed"!=e.queryData.status&&"Hold"!=e.queryData.status)}}function Fe(e,t){1&e&&(u.fc(0,"mat-card",48),u.ac(1,"mat-progress-spinner",49),u.ec())}let we=(()=>{class e{constructor(e,t,c,r,o,i,n,a){this.fb=e,this.router=t,this.snackBar=c,this.queryService=r,this.route=o,this.userService=i,this.categoryService=n,this.changeDetectorRefs=a,this.reopen=0,this.queryStatusObject={},this.customerObject={},this.categoryIndex=[],this.fileurl=null,this.usersIndex=[],this.submitted=!1,this.isLoading=!0,this.states=[{id:1,value:"Communicated"},{id:0,value:"Visited"},{id:0,value:"Proposal Send"},{id:0,value:"Negotiation"},{id:0,value:"Work Order"},{id:0,value:"Requsition"},{id:0,value:"Delivered"},{id:0,value:"Successful"},{id:0,value:"Canceled"},{id:0,value:"Failed"},{id:0,value:"Hold"}],this.displayedColumns=["category","model","unit_price","quantity","total_price","complementary"],this.displayedMrcColumns=["title","amount"]}ngOnInit(){this.myform=this.fb.group({remarks:["",[o.u.required]],file:[""],states:["",[o.u.required]],hold_date:[""]}),this.getAllCategory(),this.route.paramMap.subscribe(e=>{this.Id=e.get("id"),this.edit(this.Id)})}getAllUser(){this.userService.getAllUser().subscribe(e=>{var t;this.users=e,console.log(null===(t=this.users[6])||void 0===t?void 0:t.full_name),this.users.forEach((e,t)=>{var c;this.usersIndex[e.id]=this.users[t],console.log(null===(c=this.usersIndex[6])||void 0===c?void 0:c.full_name)})})}getAllCategory(){this.categoryService.getAllCategory().subscribe(e=>{this.categories=e,this.categories.forEach((e,t)=>{this.categoryIndex[e.id]=this.categories[t]})})}edit(e){this.queryService.getQueryById(e).subscribe(t=>{this.queryData=t,this.changeDetectorRefs.detectChanges(),console.log(this.queryData),"Hold"==this.queryData.status&&(this.reopen=1),this.getAllUser(),this.queryService.getQueryProductById(e).subscribe(e=>{this.queryProducts=e}),this.queryService.getQueryMrcById(e).subscribe(e=>{this.isLoading=!1,this.queryMrc=e}),this.queryService.getQueryActionById(e).subscribe(e=>{this.queryAction=e})})}onFileSelected(e){if(e.target.files.length>0){this.files=e.target.files[0];const t=new FileReader;t.onload=e=>{this.fileurl=e.target.result},t.readAsDataURL(this.files)}}openSnackBar(){this.snackBar.open("Customer Created Successfully!!","Close",{duration:2e3,verticalPosition:"top",horizontalPosition:"end"})}errorMessage(){this.snackBar.open("Something is error!!","Close",{duration:2e3,verticalPosition:"top",horizontalPosition:"end"})}goBack(){this.router.navigate(["/admin/query/list"])}onChangeState(e){console.log(e),this.show="Hold"==e?1:0,this.queryStatus="Visited"==e||"Communicated"==e||"Proposal Send"==e?"Prosessing":"Work Order"==e?"Work Order":"Requsition"==e||"Negotiality"==e?"Prosessing":"Successful"==e?"Successful":e}reopenForm(){this.queryData.status="HoldingOut",this.reopen=0}addQueryAction(){if(this.submitted=!0,this.myform.invalid)return;this.userData=JSON.parse(localStorage.getItem("userData")),this.myform.value.created_by=this.userData.id;const e=new FormData;if(e.append("queryID",this.Id),e.append("file",this.files),e.append("remarks",this.myform.get("remarks").value),e.append("states",this.myform.get("states").value),e.append("created_by",this.myform.value.created_by),e.append("hold_date",this.myform.get("hold_date").value),this.queryStatusObject={status:this.queryStatus},this.queryService.updateQueryStaus(this.Id,this.queryStatusObject).subscribe(e=>{this.edit(this.Id)}),console.log(this.queryData.existing_customer),"Work Order"==this.queryStatus&&0==this.queryData.existing_customer&&0==this.queryData.customer_id){console.log("status testing");var t=Math.floor(9e4*Math.random())+1e4;this.customerObject={queryId:this.Id,customer_id:t,name:this.queryData.name,phone:this.queryData.phone,created_by:this.myform.value.created_by,email:this.queryData.email,contact_address:this.queryData.contact_address,billing_address:this.queryData.billing_address},this.queryService.addQueryCustomer(this.customerObject).subscribe(e=>{this.openSnackBar()})}this.queryService.addQueryAction(e).subscribe(t=>{console.log(e),this.changeDetectorRefs.detectChanges()},e=>{this.errorMessage()})}}return e.\u0275fac=function(t){return new(t||e)(u.Zb(o.e),u.Zb(s.c),u.Zb(m.a),u.Zb(f.a),u.Zb(s.a),u.Zb(X.a),u.Zb(d.a),u.Zb(u.i))},e.\u0275cmp=u.Tb({type:e,selectors:[["app-query-details"]],decls:2,vars:2,consts:[["class","customStyle",4,"ngIf"],["style","display:flex; justify-content: center; align-items: center",4,"ngIf"],[1,"customStyle"],["mat-button","",1,"mat-primary",3,"click"],[1,"title-style"],["cols","3","rowHeight","40px"],["mat-table","","matTableExporter","","matSort","",1,"mat-elevation-z8",3,"dataSource","hiddenColumns"],["exporter","matTableExporter"],["matColumnDef","category"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","model"],["matColumnDef","unit_price"],["matColumnDef","quantity"],["matColumnDef","total_price"],["matColumnDef","complementary"],["class","header-row","mat-header-row","",4,"matHeaderRowDef"],["class","row","mat-row","",4,"matRowDef","matRowDefColumns"],["matColumnDef","title"],["matColumnDef","amount"],["class","actionSection",4,"ngIf"],[4,"ngIf"],["class","form",4,"ngIf"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-row","",1,"header-row"],["mat-row","",1,"row"],[1,"actionSection"],[4,"ngFor","ngForOf"],["cols","8","rowHeight","100px"],[3,"colspan"],["mat-button","","mat-raised-button","",1,"mat-primary",3,"click"],[1,"form"],[3,"formGroup"],[1,"full"],["matInput","","placeholder","Remarks","formControlName","remarks","autocomplete","off","required",""],["type","hide","style","width:100px;height:50px",3,"src",4,"ngIf"],[1,"image"],["type","file","formControlName","file","enctype","multipart/form-data",3,"change"],["formControlName","states","required","",3,"ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["class","full",4,"ngIf"],["mat-stroked-button","","color","primary",1,"btn-block",3,"disabled","click"],["type","hide",2,"width","100px","height","50px",3,"src"],[3,"value"],["matInput","","formControlName","hold_date",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],[2,"display","flex","justify-content","center","align-items","center"],["color","primary","mode","indeterminate"]],template:function(e,t){1&e&&(u.Rc(0,Re,106,30,"mat-card",0),u.Rc(1,Fe,2,0,"mat-card",1)),2&e&&(u.yc("ngIf",t.users),u.Ob(1),u.yc("ngIf",t.isLoading))},directives:[r.m,g.a,S.b,O.a,g.f,K.a,K.c,Y.j,n.a,ee.a,Y.c,Y.e,Y.b,Y.g,Y.i,Y.d,ee.b,Y.a,Y.f,Y.h,r.l,q.a,o.v,o.o,o.g,b.c,v.b,o.c,o.n,o.f,o.t,b.g,C.a,g.b,x.o,te.c,te.f,b.h,te.b,ce.a],pipes:[r.e],styles:["mat-card[_ngcontent-%COMP%]{top:0;width:80%;min-height:400px}.form[_ngcontent-%COMP%]{margin-top:30px}.customStyle[_ngcontent-%COMP%]{border-radius:10px 10px 10px 10px;box-shadow:5px 10px 15px #1a237e}.customStyle[_ngcontent-%COMP%]   .title-style[_ngcontent-%COMP%]{color:#1a237e;text-align:center!important}.customStyle[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{color:red;margin-left:30px}.customStyle[_ngcontent-%COMP%]   .error_message[_ngcontent-%COMP%]{color:red;margin-left:20px;margin-top:-10px;font-size:12px}.mat-stroked-button[_ngcontent-%COMP%]{width:120px;border:1px solid #00f}.sidenav-content[_ngcontent-%COMP%]{height:120%}mat-grid-tile[_ngcontent-%COMP%]{background:#add8e6}mat-card-title[_ngcontent-%COMP%]{margin-top:-25px;margin-bottom:20px}.actionSection[_ngcontent-%COMP%]{margin-top:20px}.actionSection[_ngcontent-%COMP%]   mat-grid-tile[_ngcontent-%COMP%]{background:#e8f8f5}"]}),e})();function Ae(e,t){if(1&e&&(u.fc(0,"mat-option",25),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.yc("value",e.value),u.Ob(1),u.Uc(" ",e.value," ")}}function Ne(e,t){if(1&e&&(u.fc(0,"mat-option",25),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.yc("value",e.value),u.Ob(1),u.Uc(" ",e.value," ")}}function Te(e,t){if(1&e&&(u.fc(0,"mat-option",25),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.yc("value",e.value),u.Ob(1),u.Uc(" ",e.value," ")}}function Be(e,t){if(1&e){const e=u.gc();u.fc(0,"mat-option",41),u.nc("change",(function(){u.Jc(e);const c=t.$implicit;return u.rc(2).change(c.id)})),u.Sc(1),u.ec()}if(2&e){const e=t.$implicit;u.yc("value",e.id),u.Ob(1),u.Uc(" ",e.name," ")}}function Je(e,t){if(1&e){const e=u.gc();u.fc(0,"mat-option",42),u.nc("valueChange",(function(c){return u.Jc(e),t.$implicit.model_bdcom=c})),u.Sc(1),u.ec()}if(2&e){const e=t.$implicit;u.yc("value",e.model_bdcom),u.Ob(1),u.Uc(" ",e.model_bdcom," ")}}function Qe(e,t){if(1&e){const e=u.gc();u.fc(0,"span"),u.fc(1,"a",43),u.fc(2,"mat-icon",17),u.nc("click",(function(){u.Jc(e);const t=u.rc().index;return u.rc().removeAttributes(t)})),u.Sc(3,"clear"),u.ec(),u.ec(),u.ec()}}function $e(e,t){if(1&e){const e=u.gc();u.fc(0,"div",26),u.fc(1,"div",27),u.fc(2,"mat-form-field",28),u.fc(3,"mat-label"),u.Sc(4,"Category"),u.ec(),u.fc(5,"mat-select",29,30),u.nc("ngModelChange",(function(c){u.Jc(e);const r=t.index;return u.rc().onChangeV(c,r)})),u.fc(7,"input",31),u.nc("keyup",(function(t){return u.Jc(e),u.rc().applyFilter(t.target.value)})),u.ec(),u.fc(8,"a",32),u.fc(9,"mat-icon",17),u.nc("click",(function(){return u.Jc(e),u.Fc(6).close()})),u.Sc(10,"clear"),u.ec(),u.ec(),u.Rc(11,Be,2,2,"mat-option",33),u.ec(),u.ec(),u.fc(12,"mat-form-field",28),u.fc(13,"mat-label"),u.Sc(14,"Model"),u.ec(),u.fc(15,"mat-select",34,35),u.nc("ngModelChange",(function(c){u.Jc(e);const r=t.index;return u.rc().onChangeModel(c,r)})),u.fc(17,"input",31),u.nc("keyup",(function(t){return u.Jc(e),u.rc().applyFilterP(t.target.value)})),u.ec(),u.fc(18,"a",32),u.fc(19,"mat-icon",17),u.nc("click",(function(){return u.Jc(e),u.Fc(16).close()})),u.Sc(20,"clear"),u.ec(),u.ec(),u.Rc(21,Je,2,2,"mat-option",36),u.ec(),u.ec(),u.fc(22,"mat-form-field",28),u.ac(23,"input",37),u.ec(),u.fc(24,"mat-form-field",28),u.fc(25,"input",38),u.nc("ngModelChange",(function(c){u.Jc(e);const r=t.index;return u.rc().unitPriceIndex[r]=c})),u.ec(),u.ec(),u.fc(26,"mat-checkbox",39),u.Sc(27," Complementary "),u.ec(),u.Rc(28,Qe,4,0,"span",40),u.ec(),u.ec()}if(2&e){const e=t.index,c=u.rc();u.Ob(1),u.yc("formArrayName",e),u.Ob(10),u.yc("ngForOf",c.categories),u.Ob(4),u.yc("id","model"+e),u.Ob(6),u.yc("ngForOf",c.productIndex[e]),u.Ob(4),u.yc("id","unit_price"+e)("ngModel",c.unitPriceIndex[e]),u.Ob(3),u.yc("ngIf",c.myform.get("products").length>1)}}function Ue(e,t){if(1&e){const e=u.gc();u.fc(0,"span"),u.fc(1,"a",43),u.fc(2,"mat-icon",17),u.nc("click",(function(){u.Jc(e);const t=u.rc(2).index;return u.rc().removeMrc(t)})),u.Sc(3,"clear"),u.ec(),u.ec(),u.ec()}}function je(e,t){if(1&e&&(u.fc(0,"div",27),u.fc(1,"mat-form-field",46),u.ac(2,"input",47),u.ec(),u.fc(3,"mat-form-field",46),u.ac(4,"input",48),u.ec(),u.Rc(5,Ue,4,0,"span",40),u.ec()),2&e){const e=u.rc().index,t=u.rc();u.yc("formArrayName",e),u.Ob(5),u.yc("ngIf",t.myform.get("mrc").length>1)}}function Ze(e,t){if(1&e&&(u.fc(0,"div",44),u.Rc(1,je,6,2,"div",45),u.ec()),2&e){const e=u.rc();u.Ob(1),u.yc("ngIf",e.queryMrc)}}function Le(e,t){1&e&&(u.fc(0,"mat-card",49),u.ac(1,"mat-progress-spinner",50),u.ec())}let Ve=(()=>{class e{constructor(e,t,c,r,o,i,n){this.fb=e,this.router=t,this.snackBar=c,this.queryService=r,this.route=o,this.categoryService=i,this.productService=n,this.categoryIndex=[],this.fileurl=null,this.usersIndex=[],this.unitPriceIndex=[],this.productIndex=[],this.submitted=!1,this.isLoading=!0,this.states=[{id:1,value:"GPS Device"},{id:0,value:"Camera"},{id:0,value:"Burzer"}],this.priorities=[{id:1,value:"Low"},{id:0,value:"High"},{id:0,value:"Medium"}],this.sources=[{id:1,value:"Phone"},{id:0,value:"Email"},{id:0,value:"Web"}]}ngOnInit(){this.myform=this.fb.group({name:["",[o.u.required]],phone:["",[o.u.required]],email:["",[o.u.email]],contact_address:["",[o.u.required]],billing_address:["",[o.u.required]],source:["",[o.u.required]],type:["",[o.u.required]],priority:["",[o.u.required]],remarks:[""],created_by:[""],products:this.fb.array([]),mrc:this.fb.array([])}),this.getAllCategory(),this.route.paramMap.subscribe(e=>{this.Id=e.get("id"),this.edit(this.Id)})}edit(e){this.queryService.getQueryById(e).subscribe(t=>{this.queryData=t,this.queryService.getQueryProductById(e).subscribe(e=>{this.queryProducts=e,this.setProducts()}),this.queryService.getQueryMrcById(e).subscribe(e=>{this.isLoading=!1,this.queryMrc=e,this.setMrc(),console.log(this.queryMrc)}),this.setData(t)})}setData(e){this.myform.patchValue({name:e.name,phone:e.phone,email:e.email,contact_address:e.contact_address,billing_address:e.billing_address,source:e.source,type:e.type,remarks:e.remarks,priority:e.priority}),this.createdBy=e.created_by,this.autoID=e.id,this.queryID=e.queryID}setProducts(){let e=this.myform.controls.products;console.log(this.queryProducts);let t=0;this.queryProducts.forEach(c=>{this.onChange(c,t++),console.log(c.category),e.push(this.fb.group(c))})}setMrc(){let e=this.myform.controls.mrc;this.queryMrc.forEach(t=>{e.push(this.fb.group(t))})}moreProducts(){return this.fb.group({category:[],complementary:[],model:[""],quantity:[],unit_price:[]})}get fArray(){return this.myform.get("products")}addMoreProducts(){this.fArray.push(this.moreProducts())}removeAttributes(e){this.myform.get("products").removeAt(e)}moreMrc(){return this.fb.group({title:[""],amount:[""]})}get Array(){return this.myform.get("mrc")}addMoreMrc(){this.Array.push(this.moreMrc())}removeMrc(e){this.myform.get("mrc").removeAt(e)}getAllCategory(){this.categoryService.getAllCategory().subscribe(e=>{this.categories=e,this.filterCategories=this.categories})}applyFilter(e){this.categories=this.filterCategories.filter(t=>t.name.toLowerCase().indexOf(e)>-1)}applyFilterP(e){this.products=this.filterProducts.filter(t=>t.model_bdcom.toLowerCase().indexOf(e)>-1)}openSnackBar(){this.snackBar.open("Successfully added!!","Close",{duration:2e3,verticalPosition:"top",horizontalPosition:"end"})}onChange(e,t){console.log("======="),console.log(e),this.productService.getProductByCategory(e.category).subscribe(c=>{this.productIndex[t]=this.products=c,this.onChangeModel(e.model,t),console.log(this.products),this.filterProducts=this.products})}onChangeV(e,t){console.log("======="),console.log(e),this.productService.getProductByCategory(e).subscribe(e=>{this.productIndex[t]=this.products=e,console.log(this.products),this.filterProducts=this.products})}onChangeModel(e,t){console.log(this.products),console.log(e),this.objIndex=this.products.findIndex(t=>t.model_bdcom==e),console.log(this.objIndex),this.unitPriceIndex[t]=this.unitPrice=this.products[this.objIndex].price,console.log(this.products[this.objIndex].price)}goBack(){this.router.navigate(["/admin/query/list"])}updateQuery(){this.submitted=!0,this.myform.markAllAsTouched(),this.myform.invalid||(this.userData=JSON.parse(localStorage.getItem("userData")),this.myform.value.created_by=this.userData.id,this.object={queryID:this.Id,name:this.myform.value.name,email:this.myform.value.email,phone:this.myform.value.phone,address:this.myform.value.address,source:this.myform.value.source,type:this.myform.value.type,priority:this.myform.value.priority,created_by:this.createdBy,remarks:this.myform.value.remarks},this.myform.value.products.forEach(e=>{e.totalPrice=e.unit_price*e.quantity,this.queryService.updateQueryProduct(e.id,e).subscribe(),console.log(this.Id),console.log(e)}),this.myform.value.mrc.forEach(e=>{e.queryID=this.queryID,this.queryService.updateQueryMrc(e.id,e).subscribe(),console.log(e)}),this.queryService.updateQuery(this.autoID,this.object).subscribe(e=>{this.openSnackBar(),this.router.navigate(["/admin/query/list"])}))}}return e.\u0275fac=function(t){return new(t||e)(u.Zb(o.e),u.Zb(s.c),u.Zb(m.a),u.Zb(f.a),u.Zb(s.a),u.Zb(d.a),u.Zb(h.a))},e.\u0275cmp=u.Tb({type:e,selectors:[["app-query-edit"]],decls:59,vars:7,consts:[[1,"customStyle"],["mat-button","",1,"mat-primary",3,"click"],[1,"title-style"],[3,"formGroup"],[1,"half"],["trim","blur","matInput","","placeholder","Name","formControlName","name","autocomplete","off","required",""],["matInput","","placeholder","Phone","formControlName","phone","autocomplete","off","required",""],["matInput","","placeholder","Email","formControlName","email","autocomplete","off","required",""],["formControlName","type","required",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","priority","required",""],["formControlName","source","required",""],["matInput","","placeholder","Contact Address","formControlName","contact_address","autocomplete","off","required",""],["matInput","","placeholder","Billing Address","formControlName","billing_address","autocomplete","off","required",""],[1,"full"],[1,"addbutton"],["mat-button","",1,"mat-primary"],[3,"click"],[1,"product"],["formArrayName","products",4,"ngFor","ngForOf"],[1,"mrc"],["formArrayName","mrc",4,"ngFor","ngForOf"],["matInput","","placeholder","Remarks","formControlName","remarks","autocomplete","off","required",""],["mat-stroked-button","","color","primary",1,"btn-block",3,"click"],["style","display:flex; justify-content: center; align-items: center",4,"ngIf"],[3,"value"],["formArrayName","products"],[3,"formArrayName"],[1,"quater"],["formControlName","category",3,"ngModelChange"],["sl",""],["matInput","","placeholder","search","autocomplete","off",1,"filterBox",3,"keyup"],[1,"closeButton"],[3,"value","change",4,"ngFor","ngForOf"],["formControlName","model",3,"id","ngModelChange"],["cl",""],[3,"value","valueChange",4,"ngFor","ngForOf"],["matInput","","placeholder","Quantity","formControlName","quantity","autocomplete","off"],["matInput","","placeholder","Unit Price","formControlName","unit_price","autocomplete","off",3,"id","ngModel","ngModelChange"],["formControlName","complementary","labelPosition","before",1,"checkbox"],[4,"ngIf"],[3,"value","change"],[3,"value","valueChange"],[1,"delAssigns"],["formArrayName","mrc"],[3,"formArrayName",4,"ngIf"],[1,"semi"],["matInput","","placeholder","Title","formControlName","title","autocomplete","off"],["matInput","","placeholder","Amount","formControlName","amount","autocomplete","off"],[2,"display","flex","justify-content","center","align-items","center"],["color","primary","mode","indeterminate"]],template:function(e,t){1&e&&(u.fc(0,"mat-card",0),u.fc(1,"div"),u.fc(2,"button",1),u.nc("click",(function(){return t.goBack()})),u.fc(3,"mat-icon"),u.Sc(4,"arrow_back"),u.ec(),u.ec(),u.ec(),u.fc(5,"div",2),u.fc(6,"mat-card-title"),u.Sc(7,"Query Update Form"),u.ec(),u.ec(),u.fc(8,"mat-card-content"),u.fc(9,"form",3),u.fc(10,"mat-form-field",4),u.ac(11,"input",5),u.ec(),u.fc(12,"mat-form-field",4),u.ac(13,"input",6),u.ec(),u.fc(14,"mat-form-field",4),u.ac(15,"input",7),u.ec(),u.fc(16,"mat-form-field",4),u.fc(17,"mat-label"),u.Sc(18,"Type"),u.ec(),u.fc(19,"mat-select",8),u.Rc(20,Ae,2,2,"mat-option",9),u.ec(),u.ec(),u.fc(21,"mat-form-field",4),u.fc(22,"mat-label"),u.Sc(23,"Priority"),u.ec(),u.fc(24,"mat-select",10),u.Rc(25,Ne,2,2,"mat-option",9),u.ec(),u.ec(),u.fc(26,"mat-form-field",4),u.fc(27,"mat-label"),u.Sc(28,"Source"),u.ec(),u.fc(29,"mat-select",11),u.Rc(30,Te,2,2,"mat-option",9),u.ec(),u.ec(),u.fc(31,"mat-form-field",4),u.ac(32,"textarea",12),u.ec(),u.fc(33,"mat-form-field",4),u.ac(34,"textarea",13),u.ec(),u.fc(35,"div",14),u.Sc(36," Products:"),u.ec(),u.fc(37,"div",15),u.fc(38,"button",16),u.fc(39,"mat-icon",17),u.nc("click",(function(){return t.addMoreProducts()})),u.Sc(40,"add"),u.ec(),u.ec(),u.ec(),u.fc(41,"div",18),u.Rc(42,$e,29,7,"div",19),u.ec(),u.fc(43,"div",14),u.Sc(44,"MRC:"),u.ec(),u.fc(45,"div",20),u.Rc(46,Ze,2,1,"div",21),u.fc(47,"span",15),u.fc(48,"button",16),u.fc(49,"mat-icon",17),u.nc("click",(function(){return t.addMoreMrc()})),u.Sc(50,"add"),u.ec(),u.ec(),u.ec(),u.ec(),u.fc(51,"mat-form-field",14),u.ac(52,"textarea",22),u.ec(),u.ec(),u.ec(),u.fc(53,"mat-card-actions"),u.fc(54,"button",23),u.nc("click",(function(){return t.updateQuery()})),u.Sc(55," Submit "),u.ec(),u.fc(56,"p"),u.Sc(57,"Note: Field marked with * is Mandatory"),u.ec(),u.ec(),u.ec(),u.Rc(58,Le,2,0,"mat-card",24)),2&e&&(u.Ob(9),u.yc("formGroup",t.myform),u.Ob(11),u.yc("ngForOf",t.states),u.Ob(5),u.yc("ngForOf",t.priorities),u.Ob(5),u.yc("ngForOf",t.sources),u.Ob(12),u.yc("ngForOf",t.myform.get("products").controls),u.Ob(4),u.yc("ngForOf",t.myform.get("mrc").controls),u.Ob(12),u.yc("ngIf",t.isLoading))},directives:[g.a,S.b,O.a,g.f,g.c,o.v,o.o,o.g,b.c,v.b,o.c,o.n,o.f,o.t,b.g,C.a,r.l,g.b,r.m,x.o,o.d,p.a,ce.a],styles:["mat-card[_ngcontent-%COMP%]{width:80%;top:0}.customStyle[_ngcontent-%COMP%]{border-radius:10px 10px 10px 10px;box-shadow:5px 10px 15px #1a237e}.customStyle[_ngcontent-%COMP%]   .title-style[_ngcontent-%COMP%]{color:#1a237e;text-align:center!important}.customStyle[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{color:red;margin-left:30px}.customStyle[_ngcontent-%COMP%]   .error_message[_ngcontent-%COMP%]{color:red;margin-left:20px;margin-top:-10px;font-size:12px}.mat-stroked-button[_ngcontent-%COMP%]{width:120px;border:1px solid #00f}.sidenav-content[_ngcontent-%COMP%]{height:120%}.filterBox[_ngcontent-%COMP%]{width:150px;height:25px;margin-left:10px;margin-top:5px;margin-bottom:5px;border-radius:10px 10px 10px 10px;border:2px solid #000}.product[_ngcontent-%COMP%]{margin-left:3%;float:left}.quater[_ngcontent-%COMP%]{width:14%;margin-left:2%}.semi[_ngcontent-%COMP%]{width:35%;margin-left:5%}.addbutton[_ngcontent-%COMP%]{float:right;margin-top:-30px;margin-right:80px;margin-bottom:10px}.delAssigns[_ngcontent-%COMP%]{margin-left:10px;margin-top:-20px}mat-card-title[_ngcontent-%COMP%]{margin-top:-25px;margin-bottom:20px}.t[_ngcontent-%COMP%]{float:right}"]}),e})();var Ee=c("M9IT"),He=c("H0VJ"),ze=c("Nl8B"),Ge=c("XiUz"),We=c("znSr");function Xe(e,t){1&e&&(u.fc(0,"th",39),u.Sc(1,"Action"),u.ec())}function Ke(e,t){if(1&e){const e=u.gc();u.fc(0,"button",45),u.fc(1,"mat-icon",44),u.nc("click",(function(){u.Jc(e);const t=u.rc().$implicit;return u.rc().editQuery(t)})),u.Sc(2,"edit"),u.ec(),u.ec()}}function Ye(e,t){if(1&e){const e=u.gc();u.fc(0,"button",46),u.fc(1,"mat-icon",44),u.nc("click",(function(){u.Jc(e);const t=u.rc().$implicit;return u.rc().deleteQuery(t)})),u.Sc(2,"delete_outline"),u.ec(),u.ec()}}function et(e,t){if(1&e){const e=u.gc();u.fc(0,"td",40),u.Rc(1,Ke,3,0,"button",41),u.Rc(2,Ye,3,0,"button",42),u.fc(3,"button",43),u.fc(4,"mat-icon",44),u.nc("click",(function(){u.Jc(e);const c=t.$implicit;return u.rc().detailsQuery(c.queryID)})),u.Sc(5,"visibility"),u.ec(),u.ec(),u.ec()}if(2&e){const e=t.$implicit,c=u.rc();u.Ob(1),u.yc("ngIf",1==c.assigedRole.includes("query_edit")&&"Canceled"!=e.status&&"Successful"!=e.status&&"Failed"!=e.status),u.Ob(1),u.yc("ngIf","New"==e.status&&1==c.assigedRole.includes("query_delete"))}}function tt(e,t){1&e&&(u.fc(0,"th",47),u.Sc(1,"ID"),u.ec())}function ct(e,t){if(1&e&&(u.fc(0,"td",40),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.Ob(1),u.Tc(e.id)}}function rt(e,t){1&e&&(u.fc(0,"th",47),u.Sc(1,"QueryID"),u.ec())}function ot(e,t){if(1&e){const e=u.gc();u.fc(0,"td",40),u.fc(1,"a",44),u.nc("click",(function(){u.Jc(e);const c=t.$implicit;return u.rc().detailsQuery(c.queryID)})),u.Sc(2),u.ec(),u.ec()}if(2&e){const e=t.$implicit;u.Ob(2),u.Tc(e.queryID)}}function it(e,t){1&e&&(u.fc(0,"th",47),u.Sc(1,"Name"),u.ec())}function nt(e,t){if(1&e&&(u.fc(0,"td",40),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.Ob(1),u.Tc(e.name)}}function at(e,t){1&e&&(u.fc(0,"th",47),u.Sc(1,"Email"),u.ec())}function st(e,t){if(1&e&&(u.fc(0,"td",40),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.Ob(1),u.Tc(e.email)}}function lt(e,t){1&e&&(u.fc(0,"th",47),u.Sc(1,"Phone"),u.ec())}function ut(e,t){if(1&e&&(u.fc(0,"td",40),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.Ob(1),u.Tc(e.phone)}}function mt(e,t){1&e&&(u.fc(0,"th",47),u.Sc(1,"Source"),u.ec())}function ft(e,t){if(1&e&&(u.fc(0,"td",40),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.Ob(1),u.Tc(e.source)}}function dt(e,t){1&e&&(u.fc(0,"th",47),u.Sc(1,"Exits Customer"),u.ec())}function ht(e,t){if(1&e&&(u.fc(0,"td",40),u.Sc(1),u.ec()),2&e){const e=t.$implicit,c=u.rc();u.Ob(1),u.Tc(c.exist[e.existing_customer].value)}}function gt(e,t){1&e&&(u.fc(0,"th",47),u.Sc(1,"Status"),u.ec())}function pt(e,t){if(1&e&&(u.fc(0,"td",40),u.Sc(1),u.ec()),2&e){const e=t.$implicit;u.Ob(1),u.Tc(e.status)}}function yt(e,t){1&e&&u.ac(0,"tr",48)}function bt(e,t){1&e&&u.ac(0,"tr",49)}const vt=function(e){return{active:e}};function Ct(e,t){if(1&e){const e=u.gc();u.fc(0,"li",51),u.fc(1,"a",44),u.nc("click",(function(){u.Jc(e);const c=t.$implicit;return u.rc(2).getQueryByPage(c)})),u.Sc(2),u.ec(),u.ec()}if(2&e){const e=t.$implicit,c=u.rc(2);u.yc("ngClass",u.Bc(2,vt,c.pager.currentPage===e)),u.Ob(2),u.Tc(e)}}const St=function(e){return{disabled:e}};function Ot(e,t){if(1&e){const e=u.gc();u.fc(0,"ul",50),u.fc(1,"li",51),u.fc(2,"a",44),u.nc("click",(function(){u.Jc(e);const t=u.rc();return t.getQueryByPage(t.pager.currentPage-1)})),u.Sc(3,"\xab"),u.ec(),u.ec(),u.Rc(4,Ct,3,4,"li",52),u.fc(5,"li",51),u.fc(6,"a",44),u.nc("click",(function(){u.Jc(e);const t=u.rc();return t.getQueryByPage(t.pager.currentPage+1)})),u.Sc(7,"\xbb"),u.ec(),u.ec(),u.ec()}if(2&e){const e=u.rc();u.Ob(1),u.yc("ngClass",u.Bc(3,St,1===e.pager.currentPage)),u.Ob(3),u.yc("ngForOf",e.pager.pages),u.Ob(1),u.yc("ngClass",u.Bc(5,St,2===e.pager.currentPage))}}function xt(e,t){1&e&&(u.fc(0,"mat-card",53),u.ac(1,"mat-progress-spinner",54),u.ec())}function Mt(e,t){1&e&&(u.fc(0,"mat-card"),u.Sc(1," No Records Found! "),u.ec())}const qt=function(){return[0]},It=[{path:"add",component:W,canActivate:[l.a],data:{roles:"query_add"}},{path:"list",component:(()=>{class e{constructor(e,t,c,r,o,i,n){this.fb=e,this.queryService=t,this.snackBar=c,this.router=r,this.dialogService=o,this.pagination=i,this.changeDetectorRefs=n,this.idColumn="id",this.assigedRole=[],this.currentPage=1,this.params={},this.pager=[],this.record=[],this.dataSource=new Y.k([]),this.isLoading=!0,this.states=[{id:0,value:"Inactive"},{id:1,value:"Active"}],this.exist=[{id:0,value:"No"},{id:1,value:"Yes"}],this.displayedColumns=["action","id","queryID","name","email","phone","source","existing","status"],this.assigedRole=JSON.parse(sessionStorage.getItem("rolesData"))}ngOnInit(){this.myform=this.fb.group({queryID:[""],name:[""],phone:[""],email:[""],source:[""],status:[""]}),this.getAllQuery(),this.removeColumn()}removeColumn(){0==this.assigedRole.includes("query_edit")&&0==this.assigedRole.includes("query_delete")&&(this.displayedColumns=["id","name","email","phone"])}getAllQuery(){this.params={currentPage:this.currentPage},this.queryService.getAllQuery(this.params).subscribe(e=>{this.queries=e.rows,this.record=e.count,console.log(e.count),this.pager=this.pagination.paginate(this.record),console.log(this.pager.totalPages),this.dataSource=new Y.k(this.queries),setTimeout(()=>this.dataSource.sort=this.sort),setTimeout(()=>this.dataSource.paginator=this.paginator),this.changeDetectorRefs.detectChanges(),this.isLoading=!1})}getBack(){this.getAllQuery()}getQueryByPage(e){this.page=e,this.page>this.pager.totalPages||(this.params={currentPage:e,queryID:this.myform.value.queryID,name:this.myform.value.name,phone:this.myform.value.phone,email:this.myform.value.email,source:this.myform.value.source,status:this.myform.value.status},this.queryService.getAllQuery(this.params).subscribe(t=>{this.isLoading=!1,this.queries=t.rows,console.log(this.record),this.pager=this.pagination.paginate(this.record,e),this.dataSource=new Y.k(this.queries),setTimeout(()=>this.dataSource.sort=this.sort),setTimeout(()=>this.dataSource.paginator=this.paginator)}))}getQueryBySearch(){this.cleanForm(this.myform),this.params={currentPage:this.currentPage,queryID:this.myform.value.queryID,name:this.myform.value.name,phone:this.myform.value.phone,email:this.myform.value.email,source:this.myform.value.source,status:this.myform.value.status},console.log(this.params),this.queryService.getAllQuery(this.params).subscribe(e=>{this.isLoading=!1,this.queries=e.rows,this.record=e.count,this.pager=this.pagination.paginate(this.record),this.dataSource=new Y.k(this.queries),setTimeout(()=>this.dataSource.sort=this.sort),setTimeout(()=>this.dataSource.paginator=this.paginator)})}detailsQuery(e){console.log(e),this.router.navigate(["admin/query/details",e])}editQuery(e){console.log(e.queryID),this.router.navigate(["admin/query/edit",e.queryID])}deleteQuery(e){this.dialogService.openConfirmDialog().afterClosed().subscribe(t=>{t&&(this.queryService.deleteQuery(e.queryID).subscribe(),this.deleteRowDataTable(e.id,this.idColumn,this.paginator,this.dataSource),this.openSnackBar())})}deleteRowDataTable(e,t,c,r){this.queries=r.data;const o=this.queries.findIndex(c=>c[t]===e);r.data.splice(o,1),r.paginator=c}openSnackBar(){this.snackBar.open("Deleted!!","Close",{duration:2e3,verticalPosition:"top",horizontalPosition:"end"})}applyFilter(e){this.dataSource.filter=e.trim().toLowerCase()}goAppPage(){this.router.navigate(["/admin/query/add"])}cleanForm(e){Object.keys(e.controls).forEach(t=>e.get(t).setValue(e.get(t).value.trim()))}}return e.\u0275fac=function(t){return new(t||e)(u.Zb(o.e),u.Zb(f.a),u.Zb(m.a),u.Zb(s.c),u.Zb(He.a),u.Zb(ze.a),u.Zb(u.i))},e.\u0275cmp=u.Tb({type:e,selectors:[["app-query-list"]],viewQuery:function(e,t){var c;1&e&&(u.Wc(ee.a,!0),u.Wc(Ee.a,!0)),2&e&&(u.Ec(c=u.oc())&&(t.sort=c.first),u.Ec(c=u.oc())&&(t.paginator=c.first))},decls:66,vars:9,consts:[[1,"custom-style"],[1,"table-title"],["fxLayout","row","fxLayout.xs","column",1,"search-div"],["fxFlex","70%"],[3,"formGroup"],["fxLayout","row","fxLayout.xs","column"],["fxFlex.xs","100%"],["fxFlex","33%","fxFlex.xs","30%",1,"search_field"],["matInput","","placeholder","Query ID","formControlName","queryID","autocomplete","off"],["matInput","","placeholder","Name","formControlName","name","autocomplete","off"],["matInput","","placeholder","Email","formControlName","email","autocomplete","off"],["fxFlex","30%","fxFlex.xs","30%",1,"search_field"],["matInput","","placeholder","Phone","formControlName","phone","autocomplete","off"],["matInput","","placeholder","Source","formControlName","source","autocomplete","off"],["fxFlex","30%","fxFlex.xs","100%",1,"command"],["mat-button","",1,"mat-stroked-button","mat-primary",3,"click"],["mat-button","",1,"mat-raised-button","mat-primary",3,"click"],[1,"addButton"],[1,"table_container"],["mat-table","","matTableExporter","","matSort","",1,"mat-elevation-z8",3,"dataSource","hiddenColumns"],["exporter","matTableExporter"],["matColumnDef","action"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","queryID"],["matColumnDef","name"],["matColumnDef","email"],["matColumnDef","phone"],["matColumnDef","source"],["matColumnDef","existing"],["matColumnDef","status"],["class","header-row","mat-header-row","",4,"matHeaderRowDef"],["class","row","mat-row","",4,"matRowDef","matRowDefColumns"],[1,"middle"],["class","pagination",4,"ngIf"],["style","display:flex; justify-content: center; align-items: center",4,"ngIf"],[4,"ngIf"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","",4,"ngIf"],["mat-icon-button","","color","warn",4,"ngIf"],["mat-icon-button","","color","info"],[3,"click"],["mat-icon-button",""],["mat-icon-button","","color","warn"],["mat-header-cell","","mat-sort-header",""],["mat-header-row","",1,"header-row"],["mat-row","",1,"row"],[1,"pagination"],[1,"pagination",3,"ngClass"],["class","pagination",3,"ngClass",4,"ngFor","ngForOf"],[2,"display","flex","justify-content","center","align-items","center"],["color","primary","mode","indeterminate"]],template:function(e,t){if(1&e){const e=u.gc();u.fc(0,"div",0),u.fc(1,"div",1),u.fc(2,"h3"),u.Sc(3,"Query List Table"),u.ec(),u.ec(),u.fc(4,"div",2),u.fc(5,"div",3),u.fc(6,"form",4),u.fc(7,"div",5),u.fc(8,"div",6),u.fc(9,"mat-form-field",7),u.ac(10,"input",8),u.ec(),u.fc(11,"mat-form-field",7),u.ac(12,"input",9),u.ec(),u.fc(13,"mat-form-field",7),u.ac(14,"input",10),u.ec(),u.ec(),u.fc(15,"div",6),u.fc(16,"mat-form-field",11),u.ac(17,"input",12),u.ec(),u.fc(18,"mat-form-field",11),u.ac(19,"input",13),u.ec(),u.ec(),u.ec(),u.ec(),u.ec(),u.fc(20,"div",14),u.fc(21,"button",15),u.nc("click",(function(){return t.getQueryBySearch()})),u.Sc(22," Search "),u.ec(),u.fc(23,"button",15),u.nc("click",(function(){return t.getBack()})),u.Sc(24," Back "),u.ec(),u.fc(25,"button",16),u.nc("click",(function(){return u.Jc(e),u.Fc(32).exportTable("csv",{fileName:"category"})})),u.Sc(26," CSV "),u.ec(),u.fc(27,"span",17),u.fc(28,"button",16),u.nc("click",(function(){return t.goAppPage()})),u.Sc(29," Add "),u.ec(),u.ec(),u.ec(),u.ec(),u.fc(30,"div",18),u.fc(31,"table",19,20),u.dc(33,21),u.Rc(34,Xe,2,0,"th",22),u.Rc(35,et,6,2,"td",23),u.cc(),u.dc(36,24),u.Rc(37,tt,2,0,"th",25),u.Rc(38,ct,2,1,"td",23),u.cc(),u.dc(39,26),u.Rc(40,rt,2,0,"th",25),u.Rc(41,ot,3,1,"td",23),u.cc(),u.dc(42,27),u.Rc(43,it,2,0,"th",25),u.Rc(44,nt,2,1,"td",23),u.cc(),u.dc(45,28),u.Rc(46,at,2,0,"th",25),u.Rc(47,st,2,1,"td",23),u.cc(),u.dc(48,29),u.Rc(49,lt,2,0,"th",25),u.Rc(50,ut,2,1,"td",23),u.cc(),u.dc(51,30),u.Rc(52,mt,2,0,"th",25),u.Rc(53,ft,2,1,"td",23),u.cc(),u.dc(54,31),u.Rc(55,dt,2,0,"th",25),u.Rc(56,ht,2,1,"td",23),u.cc(),u.dc(57,32),u.Rc(58,gt,2,0,"th",25),u.Rc(59,pt,2,1,"td",23),u.cc(),u.Rc(60,yt,1,0,"tr",33),u.Rc(61,bt,1,0,"tr",34),u.ec(),u.ec(),u.ec(),u.fc(62,"div",35),u.Rc(63,Ot,8,7,"ul",36),u.ec(),u.Rc(64,xt,2,0,"mat-card",37),u.Rc(65,Mt,2,0,"mat-card",38)}2&e&&(u.Ob(6),u.yc("formGroup",t.myform),u.Ob(25),u.yc("dataSource",t.dataSource)("hiddenColumns",u.Ac(8,qt)),u.Ob(29),u.yc("matHeaderRowDef",t.displayedColumns),u.Ob(1),u.yc("matRowDefColumns",t.displayedColumns),u.Ob(2),u.yc("ngIf",t.pager.pages&&t.pager.pages.length),u.Ob(1),u.yc("ngIf",t.isLoading),u.Ob(1),u.yc("ngIf",""==t.queries))},directives:[Ge.b,Ge.a,o.v,o.o,o.g,b.c,v.b,o.c,o.n,o.f,S.b,Y.j,n.a,ee.a,Y.c,Y.e,Y.b,Y.g,Y.i,r.m,Y.d,Y.a,O.a,ee.b,Y.f,Y.h,r.k,We.a,r.l,g.a,ce.a],styles:[".table_container[_ngcontent-%COMP%]{width:100%;overflow:auto}.filter[_ngcontent-%COMP%]{width:15%;margin-right:50%}.addButton[_ngcontent-%COMP%]{margin-left:10px}.mat-column-action[_ngcontent-%COMP%]{width:15%!important}.search_field[_ngcontent-%COMP%]{margin-left:1%;width:12%;float:left}.mat-stroked-button[_ngcontent-%COMP%]{border-radius:20px 20px 20px 20px;border:1px solid #00f}.mat-raised-button[_ngcontent-%COMP%], .mat-stroked-button[_ngcontent-%COMP%]{width:8%;margin-left:.5%}.pagination[_ngcontent-%COMP%]{display:inline-block}.pagination[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#000;float:left;padding:8px 16px;text-decoration:none;transition:background-color .3s;border:1px solid #ddd}.active[_ngcontent-%COMP%]{background-color:#29abe2;background:#4169e1;color:red}.pagination[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:not(.active){background-color:#ddd}.middle[_ngcontent-%COMP%]{margin-left:50%}a[_ngcontent-%COMP%]{cursor:pointer}.command[_ngcontent-%COMP%]{margin-left:3%}"]}),e})(),canActivate:[l.a],data:{roles:"query_list"}},{path:"edit/:id",component:Ve,canActivate:[l.a],data:{roles:"query_edit"}},{path:"details/:id",component:we,canActivate:[l.a],data:{roles:"query_details"}}];let _t=(()=>{class e{}return e.\u0275mod=u.Xb({type:e}),e.\u0275inj=u.Wb({factory:function(t){return new(t||e)},imports:[[s.f.forChild(It)],s.f]}),e})(),Pt=(()=>{class e{}return e.\u0275mod=u.Xb({type:e}),e.\u0275inj=u.Wb({factory:function(t){return new(t||e)},imports:[[r.c,_t,i.a,o.s,o.i,n.b,a.a]]}),e})()},H0VJ:function(e,t,c){"use strict";c.d(t,"a",(function(){return s}));var r=c("fXoL"),o=c("0IaG"),i=c("NFeN"),n=c("bTqV");let a=(()=>{class e{constructor(e){this.dialogRef=e}ngOnInit(){}closeDialog(){this.dialogRef.close(!1)}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(o.f))},e.\u0275cmp=r.Tb({type:e,selectors:[["app-mat-dialog"]],decls:11,vars:2,consts:[[1,"content-container"],["id","close-button",3,"click"],[1,"content-span"],["mat-flat-button","","id","no-button",3,"mat-dialog-close"],["mat-flat-button","","id","yes-button","color","warn",3,"mat-dialog-close"]],template:function(e,t){1&e&&(r.fc(0,"div"),r.fc(1,"div",0),r.fc(2,"mat-icon",1),r.nc("click",(function(){return t.closeDialog()})),r.Sc(3,"close"),r.ec(),r.fc(4,"div",2),r.Sc(5,"Are you sure to delete this record ?"),r.ec(),r.ec(),r.fc(6,"div"),r.fc(7,"button",3),r.Sc(8,"No"),r.ec(),r.fc(9,"button",4),r.Sc(10,"Yes"),r.ec(),r.ec(),r.ec()),2&e&&(r.Ob(7),r.yc("mat-dialog-close",!1),r.Ob(2),r.yc("mat-dialog-close",!0))},directives:[i.a,n.b,o.c],styles:["#close-button[_ngcontent-%COMP%]{margin-left:90%;cursor:pointer}.content-span[_ngcontent-%COMP%]{margin-left:20px;margin-bottom:20px}#no-button[_ngcontent-%COMP%]{width:30%;margin-left:7%;margin-right:25%;background-color:#ff0}#yes-button[_ngcontent-%COMP%]{width:30%}"]}),e})(),s=(()=>{class e{constructor(e){this.dialog=e}openConfirmDialog(){return this.dialog.open(a,{width:"300px",disableClose:!0,position:{top:"20px"}})}}return e.\u0275fac=function(t){return new(t||e)(r.jc(o.b))},e.\u0275prov=r.Vb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},Nl8B:function(e,t,c){"use strict";c.d(t,"a",(function(){return o}));var r=c("fXoL");let o=(()=>{class e{constructor(){}paginate(e,t=1,c=25,r=9){let o,i,n=Math.ceil(e/c);if(t<1?t=1:t>n&&(t=n),n<=r)o=1,i=n;else{let e=Math.floor(r/2),c=Math.ceil(r/2)-1;t<=e?(o=1,i=r):t+c>=n?(o=n-r+1,i=n):(o=t-e,i=t+c)}let a=(t-1)*c,s=Math.min(a+c-1,e-1),l=Array.from(Array(i+1-o).keys()).map(e=>o+e);return{totalItems:e,currentPage:t,pageSize:c,totalPages:n,startPage:o,endPage:i,startIndex:a,endIndex:s,pages:l}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Vb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);