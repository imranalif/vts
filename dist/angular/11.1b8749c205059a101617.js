(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"+clC":function(t,e){L.AnimatedMarker=L.Marker.extend({options:{distance:200,interval:1e3,autoStart:!0,onEnd:function(){},clickable:!1},initialize:function(t,e){this.setLine(t),L.Marker.prototype.initialize.call(this,t[0],e)},_chunk:function(t){var e,i=t.length,o=[];for(e=1;e<i;e++){var n=t[e-1],s=t[e],r=n.distanceTo(s),a=this.options.distance/r,c=a*(s.lat-n.lat),l=a*(s.lng-n.lng);if(r>this.options.distance)for(;r>this.options.distance;)r=(n=new L.LatLng(n.lat+c,n.lng+l)).distanceTo(s),o.push(n);else o.push(n)}return o.push(t[i-1]),o},onAdd:function(t){L.Marker.prototype.onAdd.call(this,t),this.options.autoStart&&this.start()},animate:function(){var t=this,e=this._latlngs.length,i=this.options.interval;this._i<e&&this.i>0&&(i=this._latlngs[this._i-1].distanceTo(this._latlngs[this._i])/this.options.distance*this.options.interval),L.DomUtil.TRANSITION&&(this._icon&&(this._icon.style[L.DomUtil.TRANSITION]="all "+i+"ms linear"),this._shadow&&(this._shadow.style[L.DomUtil.TRANSITION]="all "+i+"ms linear")),this.setLatLng(this._latlngs[this._i]),this._i++,this._tid=setTimeout((function(){t._i===e?t.options.onEnd.apply(t,Array.prototype.slice.call(arguments)):t.animate()}),i)},start:function(){this.animate()},stop:function(){this._tid&&clearTimeout(this._tid)},setLine:function(t){L.DomUtil.TRANSITION?this._latlngs=t:(this._latlngs=this._chunk(t),this.options.distance=10,this.options.interval=30),this._i=0}}),L.animatedMarker=function(t,e){return new L.AnimatedMarker(t,e)}},Bn1M:function(t,e){!function(t){function e(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(i){if("default"!==i){var o=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,o.get?o:{enumerable:!0,get:function(){return t[i]}})}})),e.default=t,e}var i=e(t);function o(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function n(t,e){return i.Util.extend(e,t.geocodingQueryParams)}function s(t,e){return i.Util.extend(e,t.reverseQueryParams)}var r=0,a=/[&<>"'`]/g,c=/[&<>"'`]/,l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};function u(t){return l[t]}function h(t,e,o,n,s){var a="_l_geocoder_"+r++;e[s||"callback"]=a,window[a]=i.Util.bind(o,n);var c=document.createElement("script");c.type="text/javascript",c.src=t+d(e),c.id=a,document.getElementsByTagName("head")[0].appendChild(c)}function p(t,e,i){var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4===o.readyState){var t;if(200!==o.status&&304!==o.status)t="";else if("string"==typeof o.response)try{t=JSON.parse(o.response)}catch(e){t=o.response}else t=o.response;i(t)}},o.open("GET",t+d(e),!0),o.responseType="json",o.setRequestHeader("Accept","application/json"),o.send(null)}function d(t,e,i){var o=[];for(var n in t){var s=encodeURIComponent(i?n.toUpperCase():n),r=t[n];if(Array.isArray(r))for(var a=0;a<r.length;a++)o.push(s+"="+encodeURIComponent(r[a]));else o.push(s+"="+encodeURIComponent(String(r)))}return(e&&-1!==e.indexOf("?")?"&":"?")+o.join("&")}var m=function(){function t(t){this.options={serviceUrl:"https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer",apiKey:""},i.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){var s=n(this.options,{token:this.options.apiKey,SingleLine:t,outFields:"Addr_Type",forStorage:!1,maxLocations:10,f:"json"});p(this.options.serviceUrl+"/findAddressCandidates",s,(function(t){var n=[];if(t.candidates&&t.candidates.length)for(var s=0;s<=t.candidates.length-1;s++){var r=t.candidates[s],a=i.latLng(r.location.y,r.location.x),c=i.latLngBounds(i.latLng(r.extent.ymax,r.extent.xmax),i.latLng(r.extent.ymin,r.extent.xmin));n[s]={name:r.address,bbox:c,center:a}}e.call(o,n)}))},e.suggest=function(t,e,i){return this.geocode(t,e,i)},e.reverse=function(t,e,o,n){var r=s(this.options,{location:t.lng+","+t.lat,distance:100,f:"json"});p(this.options.serviceUrl+"/reverseGeocode",r,(function(t){var e=[];if(t&&!t.error){var s=i.latLng(t.location.y,t.location.x),r=i.latLngBounds(s,s);e.push({name:t.address.Match_addr,center:s,bbox:r})}o.call(n,e)}))},t}(),f=function(){function t(t){this.options={serviceUrl:"https://dev.virtualearth.net/REST/v1/Locations"},i.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){var s=n(this.options,{query:t,key:this.options.apiKey});h(this.options.apiKey,s,(function(t){var n=[];if(t.resourceSets.length>0)for(var s=t.resourceSets[0].resources.length-1;s>=0;s--){var r=t.resourceSets[0].resources[s],a=r.bbox;n[s]={name:r.name,bbox:i.latLngBounds([a[0],a[1]],[a[2],a[3]]),center:i.latLng(r.point.coordinates)}}e.call(o,n)}),this,"jsonp")},e.reverse=function(t,e,o,n){var r=s(this.options,{key:this.options.apiKey});h(this.options.serviceUrl+t.lat+","+t.lng,r,(function(t){for(var e=[],s=t.resourceSets[0].resources.length-1;s>=0;s--){var r=t.resourceSets[0].resources[s],a=r.bbox;e[s]={name:r.name,bbox:i.latLngBounds([a[0],a[1]],[a[2],a[3]]),center:i.latLng(r.point.coordinates)}}o.call(n,e)}),this,"jsonp")},t}(),g=function(){function t(t){this.options={serviceUrl:"https://maps.googleapis.com/maps/api/geocode/json"},i.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){var s=n(this.options,{key:this.options.apiKey,address:t});p(this.options.serviceUrl,s,(function(t){var n=[];if(t.results&&t.results.length)for(var s=0;s<=t.results.length-1;s++){var r=t.results[s],a=i.latLng(r.geometry.location),c=i.latLngBounds(i.latLng(r.geometry.viewport.northeast),i.latLng(r.geometry.viewport.southwest));n[s]={name:r.formatted_address,bbox:c,center:a,properties:r.address_components}}e.call(o,n)}))},e.reverse=function(t,e,o,n){var r=s(this.options,{key:this.options.apiKey,latlng:t.lat+","+t.lng});p(this.options.serviceUrl,r,(function(t){var e=[];if(t.results&&t.results.length)for(var s=0;s<=t.results.length-1;s++){var r=t.results[s],a=i.latLng(r.geometry.location),c=i.latLngBounds(i.latLng(r.geometry.viewport.northeast),i.latLng(r.geometry.viewport.southwest));e[s]={name:r.formatted_address,bbox:c,center:a,properties:r.address_components}}o.call(n,e)}))},t}(),v=function(){function t(t){if(this.options={serviceUrl:"https://geocoder.api.here.com/6.2/",app_id:"",app_code:"",apiKey:"",maxResults:5},i.Util.setOptions(this,t),t.apiKey)throw Error("apiKey is not supported, use app_id/app_code instead!")}var e=t.prototype;return e.geocode=function(t,e,i){var o=n(this.options,{searchtext:t,gen:9,app_id:this.options.app_id,app_code:this.options.app_code,jsonattributes:1,maxresults:this.options.maxResults});this.getJSON(this.options.serviceUrl+"geocode.json",o,e,i)},e.reverse=function(t,e,i,o){var n=t.lat+","+t.lng;this.options.reverseGeocodeProxRadius&&(n+=","+this.options.reverseGeocodeProxRadius);var r=s(this.options,{prox:n,mode:"retrieveAddresses",app_id:this.options.app_id,app_code:this.options.app_code,gen:9,jsonattributes:1,maxresults:this.options.maxResults});this.getJSON(this.options.serviceUrl+"reversegeocode.json",r,i,o)},e.getJSON=function(t,e,o,n){p(t,e,(function(t){var e=[];if(t.response.view&&t.response.view.length)for(var s=0;s<=t.response.view[0].result.length-1;s++){var r=t.response.view[0].result[s].location,a=i.latLng(r.displayPosition.latitude,r.displayPosition.longitude),c=i.latLngBounds(i.latLng(r.mapView.topLeft.latitude,r.mapView.topLeft.longitude),i.latLng(r.mapView.bottomRight.latitude,r.mapView.bottomRight.longitude));e[s]={name:r.address.label,properties:r.address,bbox:c,center:a}}o.call(n,e)}))},t}(),b=function(){function t(t){this.options={serviceUrl:"https://geocode.search.hereapi.com/v1",apiKey:"",app_id:"",app_code:"",maxResults:10},i.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,i){var o=n(this.options,{q:t,apiKey:this.options.apiKey,limit:this.options.maxResults});if(!o.at&&!o.in)throw Error("at / in parameters not found. Please define coordinates (at=latitude,longitude) or other (in) in your geocodingQueryParams.");this.getJSON(this.options.serviceUrl+"/discover",o,e,i)},e.reverse=function(t,e,i,o){var n=s(this.options,{at:t.lat+","+t.lng,limit:this.options.reverseGeocodeProxRadius,apiKey:this.options.apiKey});this.getJSON(this.options.serviceUrl+"/revgeocode",n,i,o)},e.getJSON=function(t,e,o,n){p(t,e,(function(t){var e=[];if(t.items&&t.items.length)for(var s=0;s<=t.items.length-1;s++){var r,a=t.items[s],c=i.latLng(a.position.lat,a.position.lng);r=a.mapView?i.latLngBounds(i.latLng(a.mapView.south,a.mapView.west),i.latLng(a.mapView.north,a.mapView.east)):i.latLngBounds(i.latLng(a.position.lat,a.position.lng),i.latLng(a.position.lat,a.position.lng)),e[s]={name:a.address.label,properties:a.address,bbox:r,center:c}}o.call(n,e)}))},t}();function y(t){var e;return(e=t.match(/^([NS])\s*(\d{1,3}(?:\.\d*)?)\W*([EW])\s*(\d{1,3}(?:\.\d*)?)$/))?i.latLng((/N/i.test(e[1])?1:-1)*+e[2],(/E/i.test(e[3])?1:-1)*+e[4]):(e=t.match(/^(\d{1,3}(?:\.\d*)?)\s*([NS])\W*(\d{1,3}(?:\.\d*)?)\s*([EW])$/))?i.latLng((/N/i.test(e[2])?1:-1)*+e[1],(/E/i.test(e[4])?1:-1)*+e[3]):(e=t.match(/^([NS])\s*(\d{1,3})\xb0?\s*(\d{1,3}(?:\.\d*)?)?['\u2032]?\W*([EW])\s*(\d{1,3})\xb0?\s*(\d{1,3}(?:\.\d*)?)?['\u2032]?$/))?i.latLng((/N/i.test(e[1])?1:-1)*(+e[2]+ +e[3]/60),(/E/i.test(e[4])?1:-1)*(+e[5]+ +e[6]/60)):(e=t.match(/^(\d{1,3})\xb0?\s*(\d{1,3}(?:\.\d*)?)?['\u2032]?\s*([NS])\W*(\d{1,3})\xb0?\s*(\d{1,3}(?:\.\d*)?)?['\u2032]?\s*([EW])$/))?i.latLng((/N/i.test(e[3])?1:-1)*(+e[1]+ +e[2]/60),(/E/i.test(e[6])?1:-1)*(+e[4]+ +e[5]/60)):(e=t.match(/^([NS])\s*(\d{1,3})\xb0?\s*(\d{1,2})['\u2032]?\s*(\d{1,3}(?:\.\d*)?)?["\u2033]?\W*([EW])\s*(\d{1,3})\xb0?\s*(\d{1,2})['\u2032]?\s*(\d{1,3}(?:\.\d*)?)?["\u2033]?$/))?i.latLng((/N/i.test(e[1])?1:-1)*(+e[2]+ +e[3]/60+ +e[4]/3600),(/E/i.test(e[5])?1:-1)*(+e[6]+ +e[7]/60+ +e[8]/3600)):(e=t.match(/^(\d{1,3})\xb0?\s*(\d{1,2})['\u2032]?\s*(\d{1,3}(?:\.\d*)?)?["\u2033]\s*([NS])\W*(\d{1,3})\xb0?\s*(\d{1,2})['\u2032]?\s*(\d{1,3}(?:\.\d*)?)?["\u2033]?\s*([EW])$/))?i.latLng((/N/i.test(e[4])?1:-1)*(+e[1]+ +e[2]/60+ +e[3]/3600),(/E/i.test(e[8])?1:-1)*(+e[5]+ +e[6]/60+ +e[7]/3600)):(e=t.match(/^\s*([+-]?\d+(?:\.\d*)?)\s*[\s,]\s*([+-]?\d+(?:\.\d*)?)\s*$/))?i.latLng(+e[1],+e[2]):void 0}var _=function(){function t(t){this.options={next:void 0,sizeInMeters:1e4},i.Util.setOptions(this,t)}return t.prototype.geocode=function(t,e,i){var o=y(t);if(o){var n=[{name:t,center:o,bbox:o.toBounds(this.options.sizeInMeters)}];e.call(i,n)}else this.options.next&&this.options.next.geocode(t,e,i)},t}(),x=function(){function t(t){this.options={serviceUrl:"https://api.mapbox.com/geocoding/v5/mapbox.places/"},i.Util.setOptions(this,t)}var e=t.prototype;return e._getProperties=function(t){for(var e={text:t.text,address:t.address},i=0;i<(t.context||[]).length;i++)e[t.context[i].id.split(".")[0]]=t.context[i].text,t.context[i].short_code&&(e.countryShortCode=t.context[i].short_code);return e},e.geocode=function(t,e,o){var s=this,r=n(this.options,{access_token:this.options.apiKey});void 0!==r.proximity&&void 0!==r.proximity.lat&&void 0!==r.proximity.lng&&(r.proximity=r.proximity.lng+","+r.proximity.lat),p(this.options.serviceUrl+encodeURIComponent(t)+".json",r,(function(t){var n=[];if(t.features&&t.features.length)for(var r=0;r<=t.features.length-1;r++){var a,c=t.features[r],l=i.latLng(c.center.reverse());a=c.bbox?i.latLngBounds(i.latLng(c.bbox.slice(0,2).reverse()),i.latLng(c.bbox.slice(2,4).reverse())):i.latLngBounds(l,l),n[r]={name:c.place_name,bbox:a,center:l,properties:s._getProperties(c)}}e.call(o,n)}))},e.suggest=function(t,e,i){return this.geocode(t,e,i)},e.reverse=function(t,e,o,n){var r=this;p(this.options.serviceUrl+t.lng+","+t.lat+".json",s(this.options,{access_token:this.options.apiKey}),(function(t){var e=[];if(t.features&&t.features.length)for(var s=0;s<=t.features.length-1;s++){var a,c=t.features[s],l=i.latLng(c.center.reverse());a=c.bbox?i.latLngBounds(i.latLng(c.bbox.slice(0,2).reverse()),i.latLng(c.bbox.slice(2,4).reverse())):i.latLngBounds(l,l),e[s]={name:c.place_name,bbox:a,center:l,properties:r._getProperties(c)}}o.call(n,e)}))},t}(),C=function(){function t(t){this.options={serviceUrl:"https://www.mapquestapi.com/geocoding/v1"},i.Util.setOptions(this,t),this.options.apiKey=decodeURIComponent(this.options.apiKey)}var e=t.prototype;return e._formatName=function(){return[].slice.call(arguments).filter((function(t){return!!t})).join(", ")},e.geocode=function(t,e,o){var s=n(this.options,{key:this.options.apiKey,location:t,limit:5,outFormat:"json"});p(this.options.serviceUrl+"/address",s,i.Util.bind((function(t){var n=[];if(t.results&&t.results[0].locations)for(var s=t.results[0].locations.length-1;s>=0;s--){var r=t.results[0].locations[s],a=i.latLng(r.latLng);n[s]={name:this._formatName(r.street,r.adminArea4,r.adminArea3,r.adminArea1),bbox:i.latLngBounds(a,a),center:a}}e.call(o,n)}),this))},e.reverse=function(t,e,o,n){var r=s(this.options,{key:this.options.apiKey,location:t.lat+","+t.lng,outputFormat:"json"});p(this.options.serviceUrl+"/reverse",r,i.Util.bind((function(t){var e=[];if(t.results&&t.results[0].locations)for(var s=t.results[0].locations.length-1;s>=0;s--){var r=t.results[0].locations[s],a=i.latLng(r.latLng);e[s]={name:this._formatName(r.street,r.adminArea4,r.adminArea3,r.adminArea1),bbox:i.latLngBounds(a,a),center:a}}o.call(n,e)}),this))},t}(),S=function(){function t(t){this.options={userId:void 0,apiKey:void 0,serviceUrl:"https://neutrinoapi.com/"},i.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){var s=n(this.options,{apiKey:this.options.apiKey,userId:this.options.userId,address:t.split(/\s+/).join(".")});p(this.options.serviceUrl+"geocode-address",s,(function(t){var n=[];if(t.locations){t.geometry=t.locations[0];var s=i.latLng(t.geometry.latitude,t.geometry.longitude),r=i.latLngBounds(s,s);n[0]={name:t.geometry.address,bbox:r,center:s}}e.call(o,n)}))},e.suggest=function(t,e,i){return this.geocode(t,e,i)},e.reverse=function(t,e,o,n){var r=s(this.options,{apiKey:this.options.apiKey,userId:this.options.userId,latitude:t.lat,longitude:t.lng});p(this.options.serviceUrl+"geocode-reverse",r,(function(e){var s=[];if(200==e.status.status&&e.found){var r=i.latLng(t.lat,t.lng),a=i.latLngBounds(r,r);s[0]={name:e.address,bbox:a,center:r}}o.call(n,s)}))},t}(),L=function(){function t(t){this.options={serviceUrl:"https://nominatim.openstreetmap.org/",htmlTemplate:function(t){var e,i,o=t.address,n=[];return(o.road||o.building)&&n.push("{building} {road} {house_number}"),(o.city||o.town||o.village||o.hamlet)&&n.push('<span class="'+(n.length>0?"leaflet-control-geocoder-address-detail":"")+'">{postcode} {city} {town} {village} {hamlet}</span>'),(o.state||o.country)&&n.push('<span class="'+(n.length>0?"leaflet-control-geocoder-address-context":"")+'">{state} {country}</span>'),e=n.join("<br/>"),i=o,e.replace(/\{ *([\w_]+) *\}/g,(function(t,e){var o,n=i[e];return void 0===n?n="":"function"==typeof n&&(n=n(i)),null==(o=n)?"":o?c.test(o=""+o)?o.replace(a,u):o:o+""}))}},i.Util.setOptions(this,t||{})}var e=t.prototype;return e.geocode=function(t,e,o){var s=this,r=n(this.options,{q:t,limit:5,format:"json",addressdetails:1});p(this.options.serviceUrl+"search",r,(function(t){for(var n=[],r=t.length-1;r>=0;r--){for(var a=t[r].boundingbox,c=0;c<4;c++)a[c]=+a[c];n[r]={icon:t[r].icon,name:t[r].display_name,html:s.options.htmlTemplate?s.options.htmlTemplate(t[r]):void 0,bbox:i.latLngBounds([a[0],a[2]],[a[1],a[3]]),center:i.latLng(t[r].lat,t[r].lon),properties:t[r]}}e.call(o,n)}))},e.reverse=function(t,e,o,n){var r=this,a=s(this.options,{lat:t.lat,lon:t.lng,zoom:Math.round(Math.log(e/256)/Math.log(2)),addressdetails:1,format:"json"});p(this.options.serviceUrl+"reverse",a,(function(t){var e=[];if(t&&t.lat&&t.lon){var s=i.latLng(t.lat,t.lon),a=i.latLngBounds(s,s);e.push({name:t.display_name,html:r.options.htmlTemplate?r.options.htmlTemplate(t):void 0,center:s,bbox:a,properties:t})}o.call(n,e)}))},t}(),T=function(){function t(t){i.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){try{var n=this.options.OpenLocationCode.decode(t),s={name:t,center:i.latLng(n.latitudeCenter,n.longitudeCenter),bbox:i.latLngBounds(i.latLng(n.latitudeLo,n.longitudeLo),i.latLng(n.latitudeHi,n.longitudeHi))};e.call(o,[s])}catch(r){console.warn(r),e.call(o,[])}},e.reverse=function(t,e,o,n){try{var s={name:this.options.OpenLocationCode.encode(t.lat,t.lng,this.options.codeLength),center:i.latLng(t.lat,t.lng),bbox:i.latLngBounds(i.latLng(t.lat,t.lng),i.latLng(t.lat,t.lng))};o.call(n,[s])}catch(r){console.warn(r),o.call(n,[])}},t}(),O=function(){function t(t){this.options={serviceUrl:"https://api.opencagedata.com/geocode/v1/json"},i.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){var s=n(this.options,{key:this.options.apiKey,q:t});p(this.options.serviceUrl,s,(function(t){var n=[];if(t.results&&t.results.length)for(var s=0;s<t.results.length;s++){var r,a=t.results[s],c=i.latLng(a.geometry);r=a.annotations&&a.annotations.bounds?i.latLngBounds(i.latLng(a.annotations.bounds.northeast),i.latLng(a.annotations.bounds.southwest)):i.latLngBounds(c,c),n.push({name:a.formatted,bbox:r,center:c})}e.call(o,n)}))},e.suggest=function(t,e,i){return this.geocode(t,e,i)},e.reverse=function(t,e,o,n){var r=s(this.options,{key:this.options.apiKey,q:[t.lat,t.lng].join(",")});p(this.options.serviceUrl,r,(function(t){var e=[];if(t.results&&t.results.length)for(var s=0;s<t.results.length;s++){var r,a=t.results[s],c=i.latLng(a.geometry);r=a.annotations&&a.annotations.bounds?i.latLngBounds(i.latLng(a.annotations.bounds.northeast),i.latLng(a.annotations.bounds.southwest)):i.latLngBounds(c,c),e.push({name:a.formatted,bbox:r,center:c})}o.call(n,e)}))},t}(),w=function(){function t(t){this.options={serviceUrl:"https://api.geocode.earth/v1"},this._lastSuggest=0,i.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,i){var o=this,s=n(this.options,{api_key:this.options.apiKey,text:t});p(this.options.serviceUrl+"/search",s,(function(t){e.call(i,o._parseResults(t,"bbox"))}))},e.suggest=function(t,e,i){var o=this,s=n(this.options,{api_key:this.options.apiKey,text:t});p(this.options.serviceUrl+"/autocomplete",s,(function(t){t.geocoding.timestamp>o._lastSuggest&&(o._lastSuggest=t.geocoding.timestamp,e.call(i,o._parseResults(t,"bbox")))}))},e.reverse=function(t,e,i,o){var n=this,r=s(this.options,{api_key:this.options.apiKey,"point.lat":t.lat,"point.lon":t.lng});p(this.options.serviceUrl+"/reverse",r,(function(t){i.call(o,n._parseResults(t,"bounds"))}))},e._parseResults=function(t,e){var o=[];return i.geoJSON(t,{pointToLayer:function(t,e){return i.circleMarker(e)},onEachFeature:function(t,n){var s,r,a={};n.getBounds?r=(s=n.getBounds()).getCenter():n.feature.bbox?(r=n.getLatLng(),s=i.latLngBounds(i.GeoJSON.coordsToLatLng(n.feature.bbox.slice(0,2)),i.GeoJSON.coordsToLatLng(n.feature.bbox.slice(2,4)))):(r=n.getLatLng(),s=i.latLngBounds(r,r)),a.name=n.feature.properties.label,a.center=r,a[e]=s,a.properties=n.feature.properties,o.push(a)}}),o},t}();function M(t){return new w(t)}var k=w,P=M,I=w,A=M,D=function(t){function e(e){return t.call(this,i.Util.extend({serviceUrl:"https://api.openrouteservice.org/geocode"},e))||this}return o(e,t),e}(w),R=function(){function t(t){this.options={serviceUrl:"https://photon.komoot.io/api/",reverseUrl:"https://photon.komoot.io/reverse/",nameProperties:["name","street","suburb","hamlet","town","city","state","country"]},i.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){var s=n(this.options,{q:t});p(this.options.serviceUrl,s,i.Util.bind((function(t){e.call(o,this._decodeFeatures(t))}),this))},e.suggest=function(t,e,i){return this.geocode(t,e,i)},e.reverse=function(t,e,o,n){var r=s(this.options,{lat:t.lat,lon:t.lng});p(this.options.reverseUrl,r,i.Util.bind((function(t){o.call(n,this._decodeFeatures(t))}),this))},e._decodeFeatures=function(t){var e=[];if(t&&t.features)for(var o=0;o<t.features.length;o++){var n=t.features[o],s=n.geometry.coordinates,r=i.latLng(s[1],s[0]),a=n.properties.extent,c=a?i.latLngBounds([a[1],a[0]],[a[3],a[2]]):i.latLngBounds(r,r);e.push({name:this._decodeFeatureName(n),html:this.options.htmlTemplate?this.options.htmlTemplate(n):void 0,center:r,bbox:c,properties:n.properties})}return e},e._decodeFeatureName=function(t){return(this.options.nameProperties||[]).map((function(e){return t.properties[e]})).filter((function(t){return!!t})).join(", ")},t}(),F=function(){function t(t){this.options={serviceUrl:"https://api.what3words.com/v2/"},i.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){p(this.options.serviceUrl+"forward",n(this.options,{key:this.options.apiKey,addr:t.split(/\s+/).join(".")}),(function(t){var n=[];if(t.geometry){var s=i.latLng(t.geometry.lat,t.geometry.lng),r=i.latLngBounds(s,s);n[0]={name:t.words,bbox:r,center:s}}e.call(o,n)}))},e.suggest=function(t,e,i){return this.geocode(t,e,i)},e.reverse=function(t,e,o,n){p(this.options.serviceUrl+"reverse",s(this.options,{key:this.options.apiKey,coords:[t.lat,t.lng].join(",")}),(function(t){var e=[];if(200==t.status.status){var s=i.latLng(t.geometry.lat,t.geometry.lng),r=i.latLngBounds(s,s);e[0]={name:t.words,bbox:r,center:s}}o.call(n,e)}))},t}(),U={__proto__:null,geocodingParams:n,reverseParams:s,ArcGis:m,arcgis:function(t){return new m(t)},Bing:f,bing:function(t){return new f(t)},Google:g,google:function(t){return new g(t)},HERE:v,HEREv2:b,here:function(t){return t.apiKey?new b(t):new v(t)},parseLatLng:y,LatLng:_,latLng:function(t){return new _(t)},Mapbox:x,mapbox:function(t){return new x(t)},MapQuest:C,mapQuest:function(t){return new C(t)},Neutrino:S,neutrino:function(t){return new S(t)},Nominatim:L,nominatim:function(t){return new L(t)},OpenLocationCode:T,openLocationCode:function(t){return new T(t)},OpenCage:O,opencage:function(t){return new O(t)},Pelias:w,pelias:M,GeocodeEarth:k,geocodeEarth:P,Mapzen:I,mapzen:A,Openrouteservice:D,openrouteservice:function(t){return new D(t)},Photon:R,photon:function(t){return new R(t)},What3Words:F,what3words:function(t){return new F(t)}},E=function(){};i.Util.extend(E.prototype,i.Control.prototype),i.Util.extend(E.prototype,i.Evented.prototype);var B=function(t){function e(e){var o;return(o=t.call(this,e)||this).options={showUniqueResult:!0,showResultIcons:!1,collapsed:!0,expand:"touch",position:"topright",placeholder:"Search...",errorMessage:"Nothing found.",iconLabel:"Initiate a new search",query:"",queryMinLength:1,suggestMinLength:3,suggestTimeout:250,defaultMarkGeocode:!0},o._requestCount=0,i.Util.setOptions(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(o),e),o.options.geocoder||(o.options.geocoder=new L),o}o(e,t);var n=e.prototype;return n.addThrobberClass=function(){i.DomUtil.addClass(this._container,"leaflet-control-geocoder-throbber")},n.removeThrobberClass=function(){i.DomUtil.removeClass(this._container,"leaflet-control-geocoder-throbber")},n.onAdd=function(t){var e=this,o="leaflet-control-geocoder",n=i.DomUtil.create("div",o+" leaflet-bar"),s=i.DomUtil.create("button",o+"-icon",n),r=this._form=i.DomUtil.create("div",o+"-form",n);this._map=t,this._container=n,s.innerHTML="&nbsp;",s.type="button",s.setAttribute("aria-label",this.options.iconLabel);var a=this._input=i.DomUtil.create("input","",r);return a.type="text",a.value=this.options.query,a.placeholder=this.options.placeholder,i.DomEvent.disableClickPropagation(a),this._errorElement=i.DomUtil.create("div",o+"-form-no-error",n),this._errorElement.innerHTML=this.options.errorMessage,this._alts=i.DomUtil.create("ul",o+"-alternatives leaflet-control-geocoder-alternatives-minimized",n),i.DomEvent.disableClickPropagation(this._alts),i.DomEvent.addListener(a,"keydown",this._keydown,this),this.options.geocoder.suggest&&i.DomEvent.addListener(a,"input",this._change,this),i.DomEvent.addListener(a,"blur",(function(){e.options.collapsed&&!e._preventBlurCollapse&&e._collapse(),e._preventBlurCollapse=!1})),this.options.collapsed?"click"===this.options.expand?i.DomEvent.addListener(n,"click",(function(t){0===t.button&&2!==t.detail&&e._toggle()})):"touch"===this.options.expand?i.DomEvent.addListener(n,i.Browser.touch?"touchstart mousedown":"mousedown",(function(t){e._toggle(),t.preventDefault(),t.stopPropagation()}),this):(i.DomEvent.addListener(n,"mouseover",this._expand,this),i.DomEvent.addListener(n,"mouseout",this._collapse,this),this._map.on("movestart",this._collapse,this)):(this._expand(),i.DomEvent.addListener(n,i.Browser.touch?"touchstart":"click",(function(){return e._geocode()}))),this.options.defaultMarkGeocode&&this.on("markgeocode",this.markGeocode,this),this.on("startgeocode",this.addThrobberClass,this),this.on("finishgeocode",this.removeThrobberClass,this),this.on("startsuggest",this.addThrobberClass,this),this.on("finishsuggest",this.removeThrobberClass,this),i.DomEvent.disableClickPropagation(n),n},n.setQuery=function(t){return this._input.value=t,this},n._geocodeResult=function(t,e){if(!e&&this.options.showUniqueResult&&1===t.length)this._geocodeResultSelected(t[0]);else if(t.length>0){this._alts.innerHTML="",this._results=t,i.DomUtil.removeClass(this._alts,"leaflet-control-geocoder-alternatives-minimized"),i.DomUtil.addClass(this._container,"leaflet-control-geocoder-options-open");for(var o=0;o<t.length;o++)this._alts.appendChild(this._createAlt(t[o],o))}else i.DomUtil.addClass(this._container,"leaflet-control-geocoder-options-error"),i.DomUtil.addClass(this._errorElement,"leaflet-control-geocoder-error")},n.markGeocode=function(t){var e=t.geocode;return this._map.fitBounds(e.bbox),this._geocodeMarker&&this._map.removeLayer(this._geocodeMarker),this._geocodeMarker=new i.Marker(e.center).bindPopup(e.html||e.name).addTo(this._map).openPopup(),this},n._geocode=function(t){var e=this,i=this._input.value;if(t||!(i.length<this.options.queryMinLength)){var o=++this._requestCount,n=function(n){o===e._requestCount&&(e.fire(t?"finishsuggest":"finishgeocode",{input:i,results:n}),e._geocodeResult(n,t))};this._lastGeocode=i,t||this._clearResults(),this.fire(t?"startsuggest":"startgeocode",{input:i}),t?this.options.geocoder.suggest(i,n):this.options.geocoder.geocode(i,n)}},n._geocodeResultSelected=function(t){this.fire("markgeocode",{geocode:t})},n._toggle=function(){i.DomUtil.hasClass(this._container,"leaflet-control-geocoder-expanded")?this._collapse():this._expand()},n._expand=function(){i.DomUtil.addClass(this._container,"leaflet-control-geocoder-expanded"),this._input.select(),this.fire("expand")},n._collapse=function(){i.DomUtil.removeClass(this._container,"leaflet-control-geocoder-expanded"),i.DomUtil.addClass(this._alts,"leaflet-control-geocoder-alternatives-minimized"),i.DomUtil.removeClass(this._errorElement,"leaflet-control-geocoder-error"),i.DomUtil.removeClass(this._container,"leaflet-control-geocoder-options-open"),i.DomUtil.removeClass(this._container,"leaflet-control-geocoder-options-error"),this._input.blur(),this.fire("collapse")},n._clearResults=function(){i.DomUtil.addClass(this._alts,"leaflet-control-geocoder-alternatives-minimized"),this._selection=null,i.DomUtil.removeClass(this._errorElement,"leaflet-control-geocoder-error"),i.DomUtil.removeClass(this._container,"leaflet-control-geocoder-options-open"),i.DomUtil.removeClass(this._container,"leaflet-control-geocoder-options-error")},n._createAlt=function(t,e){var o=this,n=i.DomUtil.create("li",""),s=i.DomUtil.create("a","",n),r=this.options.showResultIcons&&t.icon?i.DomUtil.create("img","",s):null,a=t.html?void 0:document.createTextNode(t.name);return r&&(r.src=t.icon),n.setAttribute("data-result-index",String(e)),t.html?s.innerHTML=s.innerHTML+t.html:a&&s.appendChild(a),i.DomEvent.addListener(n,"mousedown touchstart",(function(e){o._preventBlurCollapse=!0,i.DomEvent.stop(e),o._geocodeResultSelected(t),i.DomEvent.on(n,"click touchend",(function(){o.options.collapsed?o._collapse():o._clearResults()}))}),this),n},n._keydown=function(t){var e=this,o=function(t){e._selection&&(i.DomUtil.removeClass(e._selection,"leaflet-control-geocoder-selected"),e._selection=e._selection[t>0?"nextSibling":"previousSibling"]),e._selection||(e._selection=e._alts[t>0?"firstChild":"lastChild"]),e._selection&&i.DomUtil.addClass(e._selection,"leaflet-control-geocoder-selected")};switch(t.keyCode){case 27:this.options.collapsed?this._collapse():this._clearResults();break;case 38:o(-1);break;case 40:o(1);break;case 13:if(this._selection){var n=parseInt(this._selection.getAttribute("data-result-index"),10);this._geocodeResultSelected(this._results[n]),this._clearResults()}else this._geocode();break;default:return}i.DomEvent.preventDefault(t)},n._change=function(){var t=this,e=this._input.value;e!==this._lastGeocode&&(clearTimeout(this._suggestTimeout),e.length>=this.options.suggestMinLength?this._suggestTimeout=setTimeout((function(){return t._geocode(!0)}),this.options.suggestTimeout):this._clearResults())},e}(E);i.Util.extend(B,U),i.Util.extend(i.Control,{Geocoder:B,geocoder:function(t){return new B(t)}})}(L)},M9GK:function(t,e,i){!function(t,e,i){"use strict";var o="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer/",n=i.Task.extend({path:"findAddressCandidates",params:{outSr:4326,forStorage:!1,outFields:"*",maxLocations:20},setters:{address:"address",neighborhood:"neighborhood",city:"city",subregion:"subregion",region:"region",postal:"postal",country:"country",text:"singleLine",category:"category",token:"token",apikey:"apikey",key:"magicKey",fields:"outFields",forStorage:"forStorage",maxLocations:"maxLocations",countries:"sourceCountry"},initialize:function(t){(t=t||{}).url=t.url||o,i.Task.prototype.initialize.call(this,t)},within:function(t){return t=e.latLngBounds(t),this.params.searchExtent=i.Util.boundsToExtent(t),this},nearby:function(t,i){var o=e.latLng(t);return this.params.location=o.lng+","+o.lat,i&&(this.params.distance=Math.min(Math.max(i,2e3),5e4)),this},run:function(t,e){return this.options.token&&(this.params.token=this.options.token),this.options.apikey&&(this.params.token=this.options.apikey),this.options.customParam&&(this.params[this.options.customParam]=this.params.singleLine,delete this.params.singleLine),this.request((function(i,o){var n=i?void 0:(0,this._processGeocoderResponse)(o);t.call(e,i,{results:n},o)}),this)},_processGeocoderResponse:function(t){for(var o=[],n=0;n<t.candidates.length;n++){var s=t.candidates[n];if(s.extent)var r=i.Util.extentToBounds(s.extent);o.push({text:s.address,bounds:r,score:s.score,latlng:e.latLng(s.location.y,s.location.x),properties:s.attributes})}return o}});function s(t){return new n(t)}var r=i.Task.extend({path:"reverseGeocode",params:{outSR:4326,returnIntersection:!1},setters:{distance:"distance",language:"langCode",intersection:"returnIntersection"},initialize:function(t){(t=t||{}).url=t.url||o,i.Task.prototype.initialize.call(this,t)},latlng:function(t){var i=e.latLng(t);return this.params.location=i.lng+","+i.lat,this},run:function(t,i){return this.request((function(o,n){var s;s=o?void 0:{latlng:e.latLng(n.location.y,n.location.x),address:n.address},t.call(i,o,s,n)}),this)}});function a(t){return new r(t)}var c=i.Task.extend({path:"suggest",params:{},setters:{text:"text",category:"category",countries:"countryCode",maxSuggestions:"maxSuggestions"},initialize:function(t){(t=t||{}).url||(t.url=o,t.supportsSuggest=!0),i.Task.prototype.initialize.call(this,t)},within:function(t){var o=(t=e.latLngBounds(t)).getCenter(),n=t.getNorthWest();return this.params.location=o.lng+","+o.lat,this.params.distance=Math.min(Math.max(o.distanceTo(n),2e3),5e4),this.params.searchExtent=i.Util.boundsToExtent(t),this},nearby:function(t,i){var o=e.latLng(t);return this.params.location=o.lng+","+o.lat,i&&(this.params.distance=Math.min(Math.max(i,2e3),5e4)),this},run:function(t,e){if(this.options.supportsSuggest)return this.request((function(i,o){t.call(e,i,o,o)}),this);console.warn("this geocoding service does not support asking for suggestions")}});function l(t){return new c(t)}var u=i.Service.extend({initialize:function(t){(t=t||{}).apikey&&(t.token=t.apikey),t.url?(i.Service.prototype.initialize.call(this,t),this._confirmSuggestSupport()):(t.url=o,t.supportsSuggest=!0,i.Service.prototype.initialize.call(this,t))},geocode:function(){return s(this)},reverse:function(){return a(this)},suggest:function(){return l(this)},_confirmSuggestSupport:function(){this.metadata((function(t,e){t||(this.options.supportsSuggest=!!e.capabilities&&e.capabilities.indexOf("Suggest")>-1,this.options.customParam=e.singleLineAddressField.name)}),this)}}),h=e.Evented.extend({options:{zoomToResult:!0,useMapBounds:12,searchBounds:null},initialize:function(t,i){if(e.Util.setOptions(this,i),this._control=t,!i||!i.providers||!i.providers.length)throw new Error("You must specify at least one provider");this._providers=i.providers},_geocode:function(t,i,o){var n,s=0,r=[],a=e.Util.bind((function(e,i){s--,e||(i&&(r=r.concat(i)),s<=0&&(n=this._boundsFromResults(r),this.fire("results",{results:r,bounds:n,latlng:n?n.getCenter():void 0,text:t},!0),this.options.zoomToResult&&n&&this._control._map.fitBounds(n),this.fire("load")))}),this);if(i)s++,o.results(t,i,this._searchBounds(),a);else for(var c=0;c<this._providers.length;c++)s++,this._providers[c].results(t,i,this._searchBounds(),a)},_suggest:function(t){var i=this._providers.length,o=0,n=e.Util.bind((function(t,n){return e.Util.bind((function(e,s){if(i-=1,o+=s.length,e)return this._control._clearProviderSuggestions(n),void this._control._finalizeSuggestions(i,o);if(s.length)for(var r=0;r<s.length;r++)s[r].provider=n;else this._control._renderSuggestions(s);n._lastRender!==t&&this._control._clearProviderSuggestions(n),s.length&&this._control._input.value===t&&(n._lastRender=t,this._control._renderSuggestions(s)),this._control._finalizeSuggestions(i,o)}),this)}),this);this._pendingSuggestions=[];for(var s=0;s<this._providers.length;s++){var r=this._providers[s],a=r.suggestions(t,this._searchBounds(),n(t,r));this._pendingSuggestions.push(a)}},_searchBounds:function(){return null!==this.options.searchBounds?this.options.searchBounds:!1===this.options.useMapBounds?null:!0===this.options.useMapBounds||this.options.useMapBounds<=this._control._map.getZoom()?this._control._map.getBounds():null},_boundsFromResults:function(t){if(t.length){for(var i=e.latLngBounds([0,0],[0,0]),o=[],n=[],s=t.length-1;s>=0;s--){var r=t[s];n.push(r.latlng),r.bounds&&r.bounds.isValid()&&!r.bounds.equals(i)&&o.push(r.bounds)}for(var a=e.latLngBounds(n),c=0;c<o.length;c++)a.extend(o[c]);return a}},_getAttribution:function(){for(var t=[],e=this._providers,i=0;i<e.length;i++)e[i].options.attribution&&t.push(e[i].options.attribution);return t.join(", ")}});function p(t,e){return new h(t,e)}var d=u.extend({options:{label:"Places and Addresses",maxResults:5},suggestions:function(t,e,i){var o=this.suggest().text(t);return e&&o.within(e),this.options.nearby&&o.nearby(this.options.nearby),this.options.countries&&o.countries(this.options.countries),this.options.categories&&o.category(this.options.categories),o.maxSuggestions(this.options.maxResults),o.run((function(t,e,o){var n=[];if(!t)for(;o.suggestions.length&&n.length<=this.options.maxResults-1;){var s=o.suggestions.shift();s.isCollection||n.push({text:s.text,unformattedText:s.text,magicKey:s.magicKey})}i(t,n)}),this)},results:function(t,e,i,o){var n=this.geocode().text(t);return e&&n.key(e),n.maxLocations(this.options.maxResults),i&&n.within(i),this.options.forStorage&&n.forStorage(!0),this.options.nearby&&n.nearby(this.options.nearby),this.options.countries&&n.countries(this.options.countries),this.options.categories&&n.category(this.options.categories),n.run((function(t,e){o(t,e.results)}),this)}});function m(t){return new d(t)}var f=e.Control.extend({includes:e.Evented.prototype,options:{position:"topleft",collapseAfterResult:!0,expanded:!1,allowMultipleResults:!0,placeholder:"Search for places or addresses",title:"Location Search"},initialize:function(t){e.Util.setOptions(this,t),t&&t.providers&&t.providers.length||(t||(t={}),t.providers=[m()]),this._geosearchCore=p(this,t),this._geosearchCore._providers=t.providers,this._geosearchCore.addEventParent(this);for(var i=0;i<this._geosearchCore._providers.length;i++)this._geosearchCore._providers[i].addEventParent(this);this._geosearchCore._pendingSuggestions=[],e.Control.prototype.initialize.call(this,t)},_renderSuggestions:function(t){var i,o,n;t.length>0&&(this._suggestions.style.display="block");for(var s=[],r=0;r<t.length;r++){var a=t[r];if(!n&&this._geosearchCore._providers.length>1&&i!==a.provider.options.label&&((n=e.DomUtil.create("div","geocoder-control-header",a.provider._contentsElement)).textContent=a.provider.options.label,n.innerText=a.provider.options.label,i=a.provider.options.label),o||(o=e.DomUtil.create("ul","geocoder-control-list",a.provider._contentsElement)),-1===s.indexOf(a.text)){var c=e.DomUtil.create("li","geocoder-control-suggestion",o);c.innerHTML=a.text,c.provider=a.provider,c["data-magic-key"]=a.magicKey,c.unformattedText=a.unformattedText}else for(var l=0;l<o.childNodes.length;l++)o.childNodes[l].innerHTML===a.text&&(o.childNodes[l]["data-magic-key"]+=","+a.magicKey);s.push(a.text)}this.getPosition().indexOf("top")>-1&&(this._suggestions.style.maxHeight=this._map.getSize().y-this._suggestions.offsetTop-this._wrapper.offsetTop-10+"px"),this.getPosition().indexOf("bottom")>-1&&this._setSuggestionsBottomPosition()},_setSuggestionsBottomPosition:function(){this._suggestions.style.maxHeight=this._map.getSize().y-this._map._controlCorners[this.getPosition()].offsetHeight-this._wrapper.offsetHeight+"px",this._suggestions.style.top=-this._suggestions.offsetHeight-this._wrapper.offsetHeight+20+"px"},_boundsFromResults:function(t){if(t.length){for(var i=e.latLngBounds([0,0],[0,0]),o=[],n=[],s=t.length-1;s>=0;s--){var r=t[s];n.push(r.latlng),r.bounds&&r.bounds.isValid()&&!r.bounds.equals(i)&&o.push(r.bounds)}for(var a=e.latLngBounds(n),c=0;c<o.length;c++)a.extend(o[c]);return a}},clear:function(){this._clearAllSuggestions(),this.options.collapseAfterResult&&(this._input.value="",this._lastValue="",this._input.placeholder="",e.DomUtil.removeClass(this._wrapper,"geocoder-control-expanded")),!this._map.scrollWheelZoom.enabled()&&this._map.options.scrollWheelZoom&&this._map.scrollWheelZoom.enable()},_clearAllSuggestions:function(){this._suggestions.style.display="none";for(var t=0;t<this.options.providers.length;t++)this._clearProviderSuggestions(this.options.providers[t])},_clearProviderSuggestions:function(t){t._contentsElement.innerHTML=""},_finalizeSuggestions:function(t,i){t||(e.DomUtil.removeClass(this._input,"geocoder-control-loading"),this.getPosition().indexOf("bottom")>-1&&this._setSuggestionsBottomPosition(),i||this._clearAllSuggestions())},_setupClick:function(){e.DomUtil.addClass(this._wrapper,"geocoder-control-expanded"),this._input.focus()},disable:function(){this._input.disabled=!0,e.DomUtil.addClass(this._input,"geocoder-control-input-disabled"),e.DomEvent.removeListener(this._wrapper,"click",this._setupClick,this)},enable:function(){this._input.disabled=!1,e.DomUtil.removeClass(this._input,"geocoder-control-input-disabled"),e.DomEvent.addListener(this._wrapper,"click",this._setupClick,this)},getAttribution:function(){for(var t=[],e=0;e<this._providers.length;e++)this._providers[e].options.attribution&&t.push(this._providers[e].options.attribution);return t.join(", ")},geocodeSuggestion:function(t){var e=t.target||t.srcElement;e.classList.contains("geocoder-control-suggestions")||e.classList.contains("geocoder-control-header")||(e.classList.length<1&&(e=e.parentNode),this._geosearchCore._geocode(e.unformattedText,e["data-magic-key"],e.provider),this.clear())},onAdd:function(t){i.Util.setEsriAttribution(t),this._map=t,this._wrapper=e.DomUtil.create("div","geocoder-control"),this._input=e.DomUtil.create("input","geocoder-control-input leaflet-bar",this._wrapper),this._input.title=this.options.title,this.options.expanded&&(e.DomUtil.addClass(this._wrapper,"geocoder-control-expanded"),this._input.placeholder=this.options.placeholder),this._suggestions=e.DomUtil.create("div","geocoder-control-suggestions leaflet-bar",this._wrapper);for(var o=0;o<this.options.providers.length;o++)this.options.providers[o]._contentsElement=e.DomUtil.create("div",null,this._suggestions);var n=this._geosearchCore._getAttribution();return t.attributionControl&&t.attributionControl.addAttribution(n),e.DomEvent.addListener(this._input,"focus",(function(t){this._input.placeholder=this.options.placeholder,e.DomUtil.addClass(this._wrapper,"geocoder-control-expanded")}),this),e.DomEvent.addListener(this._wrapper,"click",this._setupClick,this),e.DomEvent.addListener(this._suggestions,"mousedown",this.geocodeSuggestion,this),e.DomEvent.addListener(this._input,"blur",(function(t){this.clear()}),this),e.DomEvent.addListener(this._input,"keydown",(function(t){var i=(t.target||t.srcElement).value;e.DomUtil.addClass(this._wrapper,"geocoder-control-expanded");for(var o,n=this._suggestions.querySelectorAll(".geocoder-control-suggestion"),s=this._suggestions.querySelectorAll(".geocoder-control-selected")[0],r=0;r<n.length;r++)if(n[r]===s){o=r;break}switch(t.keyCode){case 13:s?(this._input.value=s.innerText,this._geosearchCore._geocode(s.unformattedText,s["data-magic-key"],s.provider),this.clear()):this.options.allowMultipleResults&&i.length>=2?(this._geosearchCore._geocode(this._input.value,void 0),this.clear()):1===n.length?(e.DomUtil.addClass(n[0],"geocoder-control-selected"),this._geosearchCore._geocode(n[0].innerHTML,n[0]["data-magic-key"],n[0].provider)):(this.clear(),this._input.blur()),e.DomEvent.preventDefault(t);break;case 38:s&&e.DomUtil.removeClass(s,"geocoder-control-selected");var a=n[o-1];e.DomUtil.addClass(s&&a?a:n[n.length-1],"geocoder-control-selected"),e.DomEvent.preventDefault(t);break;case 40:s&&e.DomUtil.removeClass(s,"geocoder-control-selected");var c=n[o+1];e.DomUtil.addClass(s&&c?c:n[0],"geocoder-control-selected"),e.DomEvent.preventDefault(t);break;default:for(var l=0;l<this._geosearchCore._pendingSuggestions.length;l++){var u=this._geosearchCore._pendingSuggestions[l];u&&u.abort&&!u.id&&u.abort()}}}),this),e.DomEvent.addListener(this._input,"keyup",e.Util.throttle((function(t){var i=t.which||t.keyCode,o=(t.target||t.srcElement).value;if(o.length<2)return this._lastValue=this._input.value,this._clearAllSuggestions(),void e.DomUtil.removeClass(this._input,"geocoder-control-loading");27!==i?13!==i&&38!==i&&40!==i&&this._input.value!==this._lastValue&&(this._lastValue=this._input.value,e.DomUtil.addClass(this._input,"geocoder-control-loading"),this._geosearchCore._suggest(o)):this._clearAllSuggestions()}),50,this),this),e.DomEvent.disableClickPropagation(this._wrapper),e.DomEvent.addListener(this._suggestions,"mouseover",(function(e){t.scrollWheelZoom.enabled()&&t.options.scrollWheelZoom&&t.scrollWheelZoom.disable()})),e.DomEvent.addListener(this._suggestions,"mouseout",(function(e){!t.scrollWheelZoom.enabled()&&t.options.scrollWheelZoom&&t.scrollWheelZoom.enable()})),this._geosearchCore.on("load",(function(t){e.DomUtil.removeClass(this._input,"geocoder-control-loading"),this.clear(),this._input.blur()}),this),this._wrapper}}),g=i.FeatureLayerService.extend({options:{label:"Feature Layer",maxResults:5,bufferRadius:1e3,searchMode:"contain",formatSuggestion:function(t){return t.properties[this.options.searchFields[0]]}},initialize:function(t){t.apikey&&(t.token=t.apikey),i.FeatureLayerService.prototype.initialize.call(this,t),"string"==typeof this.options.searchFields&&(this.options.searchFields=[this.options.searchFields]),this._suggestionsQuery=this.query(),this._resultsQuery=this.query()},suggestions:function(t,e,i){var o=this._suggestionsQuery.where(this._buildQuery(t)).returnGeometry(!1);return e&&o.intersects(e),this.options.idField&&o.fields([this.options.idField].concat(this.options.searchFields)),o.run((function(t,e,o){if(t)i(t,[]);else{this.options.idField=o.objectIdFieldName;for(var n=[],s=e.features.length-1;s>=0;s--){var r=e.features[s];n.push({text:this.options.formatSuggestion.call(this,r),unformattedText:r.properties[this.options.searchFields[0]],magicKey:r.id})}i(t,n.slice(0,this.options.maxResults))}}),this)},results:function(t,i,o,n){var s=this._resultsQuery;return i?(delete s.params.where,s.featureIds([i])):s.where(this._buildQuery(t)),o&&s.within(o),s.run(e.Util.bind((function(t,e){for(var i=[],o=0;o<e.features.length;o++){var s=e.features[o];if(s){var r=this._featureBounds(s),a={latlng:r.getCenter(),bounds:r,text:this.options.formatSuggestion.call(this,s),properties:s.properties,geojson:s};i.push(a),delete this._resultsQuery.params.objectIds}}n(t,i)}),this))},orderBy:function(t,e){this._suggestionsQuery.orderBy(t,e)},_buildQuery:function(t){for(var e=[],i=this.options.searchFields.length-1;i>=0;i--){var o='upper("'+this.options.searchFields[i]+'")';if("contain"===this.options.searchMode)e.push(o+" LIKE upper('%"+t+"%')");else if("startWith"===this.options.searchMode)e.push(o+" LIKE upper('"+t+"%')");else if("endWith"===this.options.searchMode)e.push(o+" LIKE upper('%"+t+"')");else{if("strict"!==this.options.searchMode)throw new Error('L.esri.Geocoding.featureLayerProvider: Invalid parameter for "searchMode". Use one of "contain", "startWith", "endWith", or "strict"');e.push(o+" LIKE upper('"+t+"')")}}return this.options.where?this.options.where+" AND ("+e.join(" OR ")+")":e.join(" OR ")},_featureBounds:function(t){var i=e.geoJson(t);if("Point"===t.geometry.type){var o=i.getBounds().getCenter(),n=this.options.bufferRadius/40075017*360/Math.cos(180/Math.PI*o.lat),s=this.options.bufferRadius/40075017*360;return e.latLngBounds([o.lat-s,o.lng-n],[o.lat+s,o.lng+n])}return i.getBounds()}}),v=i.MapService.extend({options:{layers:[0],label:"Map Service",bufferRadius:1e3,maxResults:5,formatSuggestion:function(t){return t.properties[t.displayFieldName]+" <small>"+t.layerName+"</small>"}},initialize:function(t){t.apikey&&(t.token=t.apikey),i.MapService.prototype.initialize.call(this,t),this._getIdFields()},suggestions:function(t,e,i){return this.find().text(t).fields(this.options.searchFields).returnGeometry(!1).layers(this.options.layers).run((function(t,e,o){var n=[];if(!t){var s=Math.min(this.options.maxResults,e.features.length);o.results=o.results.reverse();for(var r=0;r<s;r++){var a=e.features[r],c=o.results[r],l=c.layerId,u=this._idFields[l];a.layerId=l,a.layerName=this._layerNames[l],a.displayFieldName=this._displayFields[l],u&&n.push({text:this.options.formatSuggestion.call(this,a),unformattedText:a.properties[a.displayFieldName],magicKey:c.attributes[u]+":"+l})}}i(t,n.reverse())}),this)},results:function(t,e,i,o){var n,s=[];if(e&&!e.includes(",")){var r=e.split(":")[0],a=e.split(":")[1];n=this.query().layer(a).featureIds(r)}else n=this.find().text(t).fields(this.options.searchFields).layers(this.options.layers);return n.run((function(t,e,i){if(!t){i.results&&(i.results=i.results.reverse());for(var n=0;n<e.features.length;n++){var r=e.features[n];if(a=a||i.results[n].layerId,r&&void 0!==a){var c=this._featureBounds(r);r.layerId=a,r.layerName=this._layerNames[a],r.displayFieldName=this._displayFields[a];var l={latlng:c.getCenter(),bounds:c,text:this.options.formatSuggestion.call(this,r),properties:r.properties,geojson:r};s.push(l)}}}o(t,s.reverse())}),this)},_featureBounds:function(t){var i=e.geoJson(t);if("Point"===t.geometry.type){var o=i.getBounds().getCenter(),n=this.options.bufferRadius/40075017*360/Math.cos(180/Math.PI*o.lat),s=this.options.bufferRadius/40075017*360;return e.latLngBounds([o.lat-s,o.lng-n],[o.lat+s,o.lng+n])}return i.getBounds()},_layerMetadataCallback:function(t){return e.Util.bind((function(e,i){if(!e){this._displayFields[t]=i.displayField,this._layerNames[t]=i.name;for(var o=0;o<i.fields.length;o++){var n=i.fields[o];if("esriFieldTypeOID"===n.type){this._idFields[t]=n.name;break}}}}),this)},_getIdFields:function(){this._idFields={},this._displayFields={},this._layerNames={};for(var t=0;t<this.options.layers.length;t++){var e=this.options.layers[t];this.get(e,{},this._layerMetadataCallback(e))}}}),b=u.extend({options:{label:"Geocode Server",maxResults:5},suggestions:function(t,e,i){if(this.options.supportsSuggest){var o=this.suggest().text(t);return e&&o.within(e),o.run((function(t,e,o){var n=[];if(!t)for(;o.suggestions.length&&n.length<=this.options.maxResults-1;){var s=o.suggestions.shift();s.isCollection||n.push({text:s.text,unformattedText:s.text,magicKey:s.magicKey})}i(t,n)}),this)}return i(void 0,[]),!1},results:function(t,e,i,o){var n=this.geocode().text(t);return e&&n.key(e),n.maxLocations(this.options.maxResults),i&&n.within(i),n.run((function(t,e){o(t,e.results)}),this)}});t.ArcgisOnlineProvider=d,t.FeatureLayerProvider=g,t.Geocode=n,t.GeocodeService=u,t.GeocodeServiceProvider=b,t.Geosearch=f,t.GeosearchCore=h,t.MapServiceProvider=v,t.ReverseGeocode=r,t.Suggest=c,t.VERSION="3.1.1",t.WorldGeocodingServiceUrl=o,t.arcgisOnlineProvider=m,t.featureLayerProvider=function(t){return new g(t)},t.geocode=s,t.geocodeService=function(t){return new u(t)},t.geocodeServiceProvider=function(t){return new b(t)},t.geosearch=function(t){return new f(t)},t.geosearchCore=p,t.mapServiceProvider=function(t){return new v(t)},t.reverseGeocode=a,t.suggest=l,Object.defineProperty(t,"__esModule",{value:!0})}(e,i("4R65"),i("MCPi"))},MCPi:function(t,e,i){"use strict";i.r(e),i.d(e,"VERSION",(function(){return Ft})),i.d(e,"Support",(function(){return r})),i.d(e,"options",(function(){return a})),i.d(e,"Util",(function(){return Z})),i.d(e,"get",(function(){return g})),i.d(e,"post",(function(){return p})),i.d(e,"request",(function(){return m})),i.d(e,"Task",(function(){return W})),i.d(e,"task",(function(){return K})),i.d(e,"Query",(function(){return V})),i.d(e,"query",(function(){return J})),i.d(e,"Find",(function(){return Q})),i.d(e,"find",(function(){return $})),i.d(e,"Identify",(function(){return Y})),i.d(e,"identify",(function(){return tt})),i.d(e,"IdentifyFeatures",(function(){return et})),i.d(e,"identifyFeatures",(function(){return it})),i.d(e,"IdentifyImage",(function(){return nt})),i.d(e,"identifyImage",(function(){return st})),i.d(e,"Service",(function(){return at})),i.d(e,"service",(function(){return ct})),i.d(e,"MapService",(function(){return lt})),i.d(e,"mapService",(function(){return ut})),i.d(e,"ImageService",(function(){return pt})),i.d(e,"imageService",(function(){return dt})),i.d(e,"FeatureLayerService",(function(){return ft})),i.d(e,"featureLayerService",(function(){return gt})),i.d(e,"BasemapLayer",(function(){return yt})),i.d(e,"basemapLayer",(function(){return _t})),i.d(e,"TiledMapLayer",(function(){return xt})),i.d(e,"tiledMapLayer",(function(){return Ct})),i.d(e,"RasterLayer",(function(){return Lt})),i.d(e,"ImageMapLayer",(function(){return Tt})),i.d(e,"imageMapLayer",(function(){return Ot})),i.d(e,"DynamicMapLayer",(function(){return wt})),i.d(e,"dynamicMapLayer",(function(){return Mt})),i.d(e,"FeatureManager",(function(){return At})),i.d(e,"FeatureLayer",(function(){return Dt})),i.d(e,"featureLayer",(function(){return Rt}));var o=i("aAg2"),n=window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,s=""===document.documentElement.style.pointerEvents,r={cors:n,pointerEvents:s},a={attributionWidthOffset:55},c=i("4R65"),l=0;function u(t){var e="";for(var i in t.f=t.f||"json",t)if(t.hasOwnProperty(i)){var o,n=t[i],s=Object.prototype.toString.call(n);e.length&&(e+="&"),o="[object Array]"===s?"[object Object]"===Object.prototype.toString.call(n[0])?JSON.stringify(n):n.join(","):"[object Object]"===s?JSON.stringify(n):"[object Date]"===s?n.valueOf():n,e+=encodeURIComponent(i)+"="+encodeURIComponent(o)}return e}function h(t,e){var i=new window.XMLHttpRequest;return i.onerror=function(o){i.onreadystatechange=c.Util.falseFn,t.call(e,{error:{code:500,message:"XMLHttpRequest error"}},null)},i.onreadystatechange=function(){var o,n;if(4===i.readyState){try{o=JSON.parse(i.responseText)}catch(s){o=null,n={code:500,message:"Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."}}!n&&o.error&&(n=o.error,o=null),i.onerror=c.Util.falseFn,t.call(e,n,o)}},i.ontimeout=function(){this.onerror()},i}function p(t,e,i,o){var n=h(i,o);return n.open("POST",t),null!=o&&void 0!==o.options&&(n.timeout=o.options.timeout),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.send(u(e)),n}function d(t,e,i,o){var n=h(i,o);return n.open("GET",t+"?"+u(e),!0),null!=o&&void 0!==o.options&&(n.timeout=o.options.timeout,o.options.withCredentials&&(n.withCredentials=!0)),n.send(null),n}function m(t,e,i,o){var n=u(e),s=h(i,o),a=(t+"?"+n).length;if(a<=2e3&&r.cors?s.open("GET",t+"?"+n):a>2e3&&r.cors&&(s.open("POST",t),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8")),null!=o&&void 0!==o.options&&(s.timeout=o.options.timeout,o.options.withCredentials&&(s.withCredentials=!0)),a<=2e3&&r.cors)s.send(null);else{if(!(a>2e3&&r.cors))return a<=2e3&&!r.cors?f(t,e,i,o):void v("a request to "+t+" was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy http://esri.github.io/esri-leaflet/api-reference/request.html");s.send(n)}return s}function f(t,e,i,o){window._EsriLeafletCallbacks=window._EsriLeafletCallbacks||{};var n="c"+l;e.callback="window._EsriLeafletCallbacks."+n,window._EsriLeafletCallbacks[n]=function(t){if(!0!==window._EsriLeafletCallbacks[n]){var e,s=Object.prototype.toString.call(t);"[object Object]"!==s&&"[object Array]"!==s&&(e={error:{code:500,message:"Expected array or object as JSONP response"}},t=null),!e&&t.error&&(e=t,t=null),i.call(o,e,t),window._EsriLeafletCallbacks[n]=!0}};var s=c.DomUtil.create("script",null,document.body);return s.type="text/javascript",s.src=t+"?"+u(e),s.id=n,s.onerror=function(t){t&&!0!==window._EsriLeafletCallbacks[n]&&(i.call(o,{error:{code:500,message:"An unknown error occurred"}}),window._EsriLeafletCallbacks[n]=!0)},c.DomUtil.addClass(s,"esri-leaflet-jsonp"),l++,{id:n,url:s.src,abort:function(){window._EsriLeafletCallbacks._callback[n]({code:0,message:"Request aborted."})}}}var g=r.cors?d:f;function v(){console&&console.warn&&console.warn.apply(console,arguments)}g.CORS=d,g.JSONP=f;var b={request:m,get:g,post:p},y=function(t,e,i,o){var n=(o[1]-i[1])*(e[0]-t[0])-(o[0]-i[0])*(e[1]-t[1]);if(0!==n){var s=((o[0]-i[0])*(t[1]-i[1])-(o[1]-i[1])*(t[0]-i[0]))/n,r=((e[0]-t[0])*(t[1]-i[1])-(e[1]-t[1])*(t[0]-i[0]))/n;if(s>=0&&s<=1&&r>=0&&r<=1)return!0}return!1},_=function(t,e){for(var i=0;i<t.length-1;i++)for(var o=0;o<e.length-1;o++)if(y(t[i],t[i+1],e[o],e[o+1]))return!0;return!1},x=function(t){return function(t,e){for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}(t[0],t[t.length-1])||t.push(t[0]),t},C=function(t){for(var e,i=0,o=0,n=t.length,s=t[o];o<n-1;o++)i+=((e=t[o+1])[0]-s[0])*(e[1]+s[1]),s=e;return i>=0},S=function(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},L=function(t,e){var i=_(t,e),o=function(t,e){for(var i=!1,o=-1,n=t.length,s=n-1;++o<n;s=o)(t[o][1]<=e[1]&&e[1]<t[s][1]||t[s][1]<=e[1]&&e[1]<t[o][1])&&e[0]<(t[s][0]-t[o][0])*(e[1]-t[o][1])/(t[s][1]-t[o][1])+t[o][0]&&(i=!i);return i}(t,e[0]);return!(i||!o)},T=function(t){var e=[],i=t.slice(0),o=x(i.shift().slice(0));if(o.length>=4){C(o)||o.reverse(),e.push(o);for(var n=0;n<i.length;n++){var s=x(i[n].slice(0));s.length>=4&&(C(s)&&s.reverse(),e.push(s))}}return e};function O(t,e){return function t(e,i){i=i||"OBJECTID";var o,n={wkid:4326},s={};switch(e.type){case"Point":s.x=e.coordinates[0],s.y=e.coordinates[1],e.coordinates[2]&&(s.z=e.coordinates[2]),s.spatialReference=n;break;case"MultiPoint":s.points=e.coordinates.slice(0),e.coordinates[0][2]&&(s.hasZ=!0),s.spatialReference=n;break;case"LineString":s.paths=[e.coordinates.slice(0)],e.coordinates[0][2]&&(s.hasZ=!0),s.spatialReference=n;break;case"MultiLineString":s.paths=e.coordinates.slice(0),e.coordinates[0][0][2]&&(s.hasZ=!0),s.spatialReference=n;break;case"Polygon":s.rings=T(e.coordinates.slice(0)),e.coordinates[0][0][2]&&(s.hasZ=!0),s.spatialReference=n;break;case"MultiPolygon":s.rings=function(t){for(var e=[],i=0;i<t.length;i++)for(var o=T(t[i]),n=o.length-1;n>=0;n--){var s=o[n].slice(0);e.push(s)}return e}(e.coordinates.slice(0)),e.coordinates[0][0][0][2]&&(s.hasZ=!0),s.spatialReference=n;break;case"Feature":e.geometry&&(s.geometry=t(e.geometry,i)),s.attributes=e.properties?S(e.properties):{},e.id&&(s.attributes[i]=e.id);break;case"FeatureCollection":for(s=[],o=0;o<e.features.length;o++)s.push(t(e.features[o],i));break;case"GeometryCollection":for(s=[],o=0;o<e.geometries.length;o++)s.push(t(e.geometries[o],i))}return s}(t,e)}function w(t,e){return function t(e,i){var o={};if(e.features){o.type="FeatureCollection",o.features=[];for(var n=0;n<e.features.length;n++)o.features.push(t(e.features[n],i))}if("number"==typeof e.x&&"number"==typeof e.y&&(o.type="Point",o.coordinates=[e.x,e.y],"number"==typeof e.z&&o.coordinates.push(e.z)),e.points&&(o.type="MultiPoint",o.coordinates=e.points.slice(0)),e.paths&&(1===e.paths.length?(o.type="LineString",o.coordinates=e.paths[0].slice(0)):(o.type="MultiLineString",o.coordinates=e.paths.slice(0))),e.rings&&(o=function(t){for(var e,i,o=[],n=[],s=0;s<t.length;s++){var r=x(t[s].slice(0));if(!(r.length<4))if(C(r)){var a=[r.slice().reverse()];o.push(a)}else n.push(r.slice().reverse())}for(var c=[];n.length;){i=n.pop();var l=!1;for(e=o.length-1;e>=0;e--)if(L(o[e][0],i)){o[e].push(i),l=!0;break}l||c.push(i)}for(;c.length;){i=c.pop();var u=!1;for(e=o.length-1;e>=0;e--)if(_(o[e][0],i)){o[e].push(i),u=!0;break}u||o.push([i.reverse()])}return 1===o.length?{type:"Polygon",coordinates:o[0]}:{type:"MultiPolygon",coordinates:o}}(e.rings.slice(0))),"number"==typeof e.xmin&&"number"==typeof e.ymin&&"number"==typeof e.xmax&&"number"==typeof e.ymax&&(o.type="Polygon",o.coordinates=[[[e.xmax,e.ymax],[e.xmin,e.ymax],[e.xmin,e.ymin],[e.xmax,e.ymin],[e.xmax,e.ymax]]]),(e.geometry||e.attributes)&&(o.type="Feature",o.geometry=e.geometry?t(e.geometry):null,o.properties=e.attributes?S(e.attributes):null,e.attributes))try{o.id=function(t,e){for(var i=e?[e,"OBJECTID","FID"]:["OBJECTID","FID"],o=0;o<i.length;o++){var n=i[o];if(n in t&&("string"==typeof t[n]||"number"==typeof t[n]))return t[n]}throw Error("No valid id attribute found")}(e.attributes,i)}catch(s){}return JSON.stringify(o.geometry)===JSON.stringify({})&&(o.geometry=null),e.spatialReference&&e.spatialReference.wkid&&4326!==e.spatialReference.wkid&&console.warn("Object converted in non-standard crs - "+JSON.stringify(e.spatialReference)),o}(t,e)}function M(t){if("NaN"!==t.xmin&&"NaN"!==t.ymin&&"NaN"!==t.xmax&&"NaN"!==t.ymax){var e=Object(c.latLng)(t.ymin,t.xmin),i=Object(c.latLng)(t.ymax,t.xmax);return Object(c.latLngBounds)(e,i)}return null}function k(t){return{xmin:(t=Object(c.latLngBounds)(t)).getSouthWest().lng,ymin:t.getSouthWest().lat,xmax:t.getNorthEast().lng,ymax:t.getNorthEast().lat,spatialReference:{wkid:4326}}}var P=/^(OBJECTID|FID|OID|ID)$/i;function I(t){var e;if(t.objectIdFieldName)e=t.objectIdFieldName;else if(t.fields){for(var i=0;i<=t.fields.length-1;i++)if("esriFieldTypeOID"===t.fields[i].type){e=t.fields[i].name;break}if(!e)for(i=0;i<=t.fields.length-1;i++)if(t.fields[i].name.match(P)){e=t.fields[i].name;break}}return e}function A(t){for(var e in t.attributes)if(e.match(P))return e}function D(t,e){var i,o=t.features||t.results,n=o&&o.length;i=e||I(t);var s={type:"FeatureCollection",features:[]};if(n)for(var r=o.length-1;r>=0;r--){var a=w(o[r],i||A(o[r]));s.features.push(a)}return s}function R(t){return"/"!==(t=c.Util.trim(t))[t.length-1]&&(t+="/"),t}function F(t){if(-1!==t.url.indexOf("?")){t.requestParams=t.requestParams||{};var e=t.url.substring(t.url.indexOf("?")+1);t.url=t.url.split("?")[0],t.requestParams=JSON.parse('{"'+decodeURI(e).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')}return t.url=R(t.url.split("?")[0]),t}function U(t){return/^(?!.*utility\.arcgis\.com).*\.arcgis\.com.*FeatureServer/i.test(t)}function E(t){var e;switch(t){case"Point":e="esriGeometryPoint";break;case"MultiPoint":e="esriGeometryMultipoint";break;case"LineString":case"MultiLineString":e="esriGeometryPolyline";break;case"Polygon":case"MultiPolygon":e="esriGeometryPolygon"}return e}function B(t){return t.getSize().x-a.attributionWidthOffset+"px"}function G(t){if(t.attributionControl){if(t.attributionControl._esriAttributionLayerCount||(t.attributionControl._esriAttributionLayerCount=0),0===t.attributionControl._esriAttributionLayerCount){if(!t.attributionControl._esriAttributionAddedOnce){var e=document.createElement("style");e.type="text/css",e.innerHTML=".esri-truncated-attribution:hover {white-space: normal;}",document.getElementsByTagName("head")[0].appendChild(e);var i=document.createElement("style");i.type="text/css",i.innerHTML=".esri-truncated-attribution {vertical-align: -3px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;display: inline-block;transition: 0s white-space;transition-delay: 1s;max-width: "+B(t)+";}",document.getElementsByTagName("head")[0].appendChild(i),t.on("resize",(function(e){t.attributionControl&&(t.attributionControl._container.style.maxWidth=B(e.target))})),t.attributionControl._esriAttributionAddedOnce=!0}t.attributionControl.setPrefix('<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a> | Powered by <a href="https://www.esri.com">Esri</a>'),c.DomUtil.addClass(t.attributionControl._container,"esri-truncated-attribution:hover"),c.DomUtil.addClass(t.attributionControl._container,"esri-truncated-attribution")}t.attributionControl._esriAttributionLayerCount=t.attributionControl._esriAttributionLayerCount+1}}function z(t){t.attributionControl&&(t.attributionControl._esriAttributionLayerCount&&1===t.attributionControl._esriAttributionLayerCount&&(t.attributionControl.setPrefix('<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'),c.DomUtil.removeClass(t.attributionControl._container,"esri-truncated-attribution:hover"),c.DomUtil.removeClass(t.attributionControl._container,"esri-truncated-attribution")),t.attributionControl._esriAttributionLayerCount=t.attributionControl._esriAttributionLayerCount-1)}function N(t){var e={geometry:null,geometryType:null};return t instanceof c.LatLngBounds?(e.geometry=k(t),e.geometryType="esriGeometryEnvelope",e):(t.getLatLng&&(t=t.getLatLng()),t instanceof c.LatLng&&(t={type:"Point",coordinates:[t.lng,t.lat]}),t instanceof c.GeoJSON&&(t=t.getLayers()[0].feature.geometry,e.geometry=O(t),e.geometryType=E(t.type)),t.toGeoJSON&&(t=t.toGeoJSON()),"Feature"===t.type&&(t=t.geometry),"Point"===t.type||"LineString"===t.type||"Polygon"===t.type||"MultiPolygon"===t.type?(e.geometry=O(t),e.geometryType=E(t.type),e):void v("invalid geometry passed to spatial query. Should be L.LatLng, L.LatLngBounds, L.Marker or a GeoJSON Point, Line, Polygon or MultiPolygon object"))}function j(t,e){r.cors&&m(t,{},c.Util.bind((function(t,i){if(!t){e._esriAttributions=[];for(var o=0;o<i.contributors.length;o++)for(var n=i.contributors[o],s=0;s<n.coverageAreas.length;s++){var r=n.coverageAreas[s],a=Object(c.latLng)(r.bbox[0],r.bbox[1]),l=Object(c.latLng)(r.bbox[2],r.bbox[3]);e._esriAttributions.push({attribution:n.attribution,score:r.score,bounds:Object(c.latLngBounds)(a,l),minZoom:r.zoomMin,maxZoom:r.zoomMax})}e._esriAttributions.sort((function(t,e){return e.score-t.score})),q({target:e})}}),this))}function q(t){var e=t.target,i=e._esriAttributions;if(e&&e.attributionControl){var o=e.attributionControl._container.querySelector(".esri-dynamic-attribution");if(o&&i){for(var n="",s=e.getBounds(),r=Object(c.latLngBounds)(s.getSouthWest().wrap(),s.getNorthEast().wrap()),a=e.getZoom(),l=0;l<i.length;l++){var u=i[l],h=u.attribution;!n.match(h)&&u.bounds.intersects(r)&&a>=u.minZoom&&a<=u.maxZoom&&(n+=", "+h)}n=n.substr(2),o.innerHTML=n,o.style.maxWidth=B(e),e.fire("attributionupdated",{attribution:n})}}}var Z={warn:v,cleanUrl:R,getUrlParams:F,isArcgisOnline:U,geojsonTypeToArcGIS:E,responseToFeatureCollection:D,geojsonToArcGIS:O,arcgisToGeoJSON:w,boundsToExtent:k,extentToBounds:M,calcAttributionWidth:B,setEsriAttribution:G,_setGeometry:N,_getAttributionData:j,_updateMapAttribution:q,_findIdAttributeFromFeature:A,_findIdAttributeFromResponse:I},W=c.Class.extend({options:{proxy:!1,useCors:n},generateSetter:function(t,e){return c.Util.bind((function(e){return this.params[t]=e,this}),e)},initialize:function(t){if(t.request&&t.options?(this._service=t,c.Util.setOptions(this,t.options)):(c.Util.setOptions(this,t),this.options.url=R(t.url)),this.params=c.Util.extend({},this.params||{}),this.setters)for(var e in this.setters)this[e]=this.generateSetter(this.setters[e],this)},token:function(t){return this._service?this._service.authenticate(t):this.params.token=t,this},apikey:function(t){return this.token(t)},format:function(t){return this.params.returnUnformattedValues=!t,this},request:function(t,e){return this.options.requestParams&&c.Util.extend(this.params,this.options.requestParams),this._service?this._service.request(this.path,this.params,t,e):this._request("request",this.path,this.params,t,e)},_request:function(t,e,i,o,n){var s=this.options.proxy?this.options.proxy+"?"+this.options.url+e:this.options.url+e;return"get"!==t&&"request"!==t||this.options.useCors?b[t](s,i,o,n):b.get.JSONP(s,i,o,n)}});function K(t){return t=F(t),new W(t)}var V=W.extend({setters:{offset:"resultOffset",limit:"resultRecordCount",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",returnM:"returnM",transform:"datumTransformation",token:"token"},path:"query",params:{returnGeometry:!0,where:"1=1",outSR:4326,outFields:"*"},within:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelContains",this},intersects:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelIntersects",this},contains:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelWithin",this},crosses:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelCrosses",this},touches:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelTouches",this},overlaps:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelOverlaps",this},bboxIntersects:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelEnvelopeIntersects",this},indexIntersects:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelIndexIntersects",this},nearby:function(t,e){return t=Object(c.latLng)(t),this.params.geometry=[t.lng,t.lat],this.params.geometryType="esriGeometryPoint",this.params.spatialRel="esriSpatialRelIntersects",this.params.units="esriSRUnit_Meter",this.params.distance=e,this.params.inSR=4326,this},where:function(t){return this.params.where=t,this},between:function(t,e){return this.params.time=[t.valueOf(),e.valueOf()],this},simplify:function(t,e){var i=Math.abs(t.getBounds().getWest()-t.getBounds().getEast());return this.params.maxAllowableOffset=i/t.getSize().y*e,this},orderBy:function(t,e){return e=e||"ASC",this.params.orderByFields=this.params.orderByFields?this.params.orderByFields+",":"",this.params.orderByFields+=[t,e].join(" "),this},run:function(t,e){return this._cleanParams(),this.options.isModern||U(this.options.url)&&void 0===this.options.isModern?(this.params.f="geojson",this.request((function(i,o){this._trapSQLerrors(i),t.call(e,i,o,o)}),this)):this.request((function(i,o){this._trapSQLerrors(i),t.call(e,i,o&&D(o),o)}),this)},count:function(t,e){return this._cleanParams(),this.params.returnCountOnly=!0,this.request((function(e,i){t.call(this,e,i&&i.count,i)}),e)},ids:function(t,e){return this._cleanParams(),this.params.returnIdsOnly=!0,this.request((function(e,i){t.call(this,e,i&&i.objectIds,i)}),e)},bounds:function(t,e){return this._cleanParams(),this.params.returnExtentOnly=!0,this.request((function(i,o){o&&o.extent&&M(o.extent)?t.call(e,i,M(o.extent),o):t.call(e,i={message:"Invalid Bounds"},null,o)}),e)},distinct:function(){return this.params.returnGeometry=!1,this.params.returnDistinctValues=!0,this},pixelSize:function(t){var e=Object(c.point)(t);return this.params.pixelSize=[e.x,e.y],this},layer:function(t){return this.path=t+"/query",this},_trapSQLerrors:function(t){t&&"400"===t.code&&v("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")},_cleanParams:function(){delete this.params.returnIdsOnly,delete this.params.returnExtentOnly,delete this.params.returnCountOnly},_setGeometryParams:function(t){this.params.inSR=4326;var e=N(t);this.params.geometry=e.geometry,this.params.geometryType=e.geometryType}});function J(t){return new V(t)}var H=J,Q=W.extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs:function(t,e){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[t,e].join(":"),this},simplify:function(t,e){var i=Math.abs(t.getBounds().getWest()-t.getBounds().getEast());return this.params.maxAllowableOffset=i/t.getSize().y*e,this},run:function(t,e){return this.request((function(i,o){t.call(e,i,o&&D(o),o)}),e)}});function $(t){return new Q(t)}var X=$,Y=W.extend({path:"identify",between:function(t,e){return this.params.time=[t.valueOf(),e.valueOf()],this}});function tt(t){return new Y(t)}var et=Y.extend({setters:{layers:"layers",precision:"geometryPrecision",tolerance:"tolerance",returnGeometry:"returnGeometry"},params:{sr:4326,layers:"all",tolerance:3,returnGeometry:!0},on:function(t){var e=k(t.getBounds()),i=t.getSize();return this.params.imageDisplay=[i.x,i.y,96],this.params.mapExtent=[e.xmin,e.ymin,e.xmax,e.ymax],this},at:function(t){return 2===t.length&&(t=Object(c.latLng)(t)),this._setGeometryParams(t),this},layerDef:function(t,e){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[t,e].join(":"),this},simplify:function(t,e){var i=Math.abs(t.getBounds().getWest()-t.getBounds().getEast());return this.params.maxAllowableOffset=i/t.getSize().y*e,this},run:function(t,e){return this.request((function(i,o){if(i)t.call(e,i,void 0,o);else{var n=D(o);o.results=o.results.reverse();for(var s=0;s<n.features.length;s++)n.features[s].layerId=o.results[s].layerId;t.call(e,void 0,n,o)}}))},_setGeometryParams:function(t){var e=N(t);this.params.geometry=e.geometry,this.params.geometryType=e.geometryType}});function it(t){return new et(t)}var ot=it,nt=Y.extend({setters:{setMosaicRule:"mosaicRule",setRenderingRule:"renderingRule",setPixelSize:"pixelSize",returnCatalogItems:"returnCatalogItems",returnGeometry:"returnGeometry"},params:{returnGeometry:!1},at:function(t){return t=Object(c.latLng)(t),this.params.geometry=JSON.stringify({x:t.lng,y:t.lat,spatialReference:{wkid:4326}}),this.params.geometryType="esriGeometryPoint",this},getMosaicRule:function(){return this.params.mosaicRule},getRenderingRule:function(){return this.params.renderingRule},getPixelSize:function(){return this.params.pixelSize},run:function(t,e){return this.request((function(i,o){t.call(e,i,o&&this._responseToGeoJSON(o),o)}),this)},_responseToGeoJSON:function(t){var e=t.location,i=t.catalogItems,o=t.catalogItemVisibilities,n={pixel:{type:"Feature",geometry:{type:"Point",coordinates:[e.x,e.y]},crs:{type:"EPSG",properties:{code:e.spatialReference.wkid}},properties:{OBJECTID:t.objectId,name:t.name,value:t.value},id:t.objectId}};if(t.properties&&t.properties.Values&&(n.pixel.properties.values=t.properties.Values),i&&i.features&&(n.catalogItems=D(i),o&&o.length===n.catalogItems.features.length))for(var s=o.length-1;s>=0;s--)n.catalogItems.features[s].properties.catalogItemVisibility=o[s];return n}});function st(t){return new nt(t)}var rt=st,at=c.Evented.extend({options:{proxy:!1,useCors:n,timeout:0},initialize:function(t){t=t||{},this._requestQueue=[],this._authenticating=!1,c.Util.setOptions(this,t),this.options.url=R(this.options.url)},get:function(t,e,i,o){return this._request("get",t,e,i,o)},post:function(t,e,i,o){return this._request("post",t,e,i,o)},request:function(t,e,i,o){return this._request("request",t,e,i,o)},metadata:function(t,e){return this._request("get","",{},t,e)},authenticate:function(t){return this._authenticating=!1,this.options.token=t,this._runQueue(),this},getTimeout:function(){return this.options.timeout},setTimeout:function(t){this.options.timeout=t},_request:function(t,e,i,o,n){this.fire("requeststart",{url:this.options.url+e,params:i,method:t},!0);var s=this._createServiceCallback(t,e,i,o,n);if(this.options.token&&(i.token=this.options.token),this.options.requestParams&&c.Util.extend(i,this.options.requestParams),!this._authenticating){var r=this.options.proxy?this.options.proxy+"?"+this.options.url+e:this.options.url+e;return"get"!==t&&"request"!==t||this.options.useCors?b[t](r,i,s,n):b.get.JSONP(r,i,s,n)}this._requestQueue.push([t,e,i,o,n])},_createServiceCallback:function(t,e,i,o,n){return c.Util.bind((function(s,r){!s||499!==s.code&&498!==s.code||(this._authenticating=!0,this._requestQueue.push([t,e,i,o,n]),this.fire("authenticationrequired",{authenticate:c.Util.bind(this.authenticate,this)},!0),s.authenticate=c.Util.bind(this.authenticate,this)),o.call(n,s,r),s?this.fire("requesterror",{url:this.options.url+e,params:i,message:s.message,code:s.code,method:t},!0):this.fire("requestsuccess",{url:this.options.url+e,params:i,response:r,method:t},!0),this.fire("requestend",{url:this.options.url+e,params:i,method:t},!0)}),this)},_runQueue:function(){for(var t=this._requestQueue.length-1;t>=0;t--){var e=this._requestQueue[t];this[e.shift()].apply(this,e)}this._requestQueue=[]}});function ct(t){return t=F(t),new at(t)}var lt=at.extend({identify:function(){return ot(this)},find:function(){return X(this)},query:function(){return H(this)}});function ut(t){return new lt(t)}var ht=ut,pt=at.extend({query:function(){return H(this)},identify:function(){return rt(this)}});function dt(t){return new pt(t)}var mt=dt,ft=at.extend({options:{idAttribute:"OBJECTID"},query:function(){return H(this)},addFeature:function(t,e,i){this.addFeatures(t,e,i)},addFeatures:function(t,e,i){for(var o=t.features?t.features:[t],n=o.length-1;n>=0;n--)delete o[n].id;return t=O(t),this.post("addFeatures",{features:t=o.length>1?t:[t]},(function(t,o){e&&e.call(i,t||o.addResults[0].error,o&&o.addResults?o.addResults.length>1?o.addResults:o.addResults[0]:void 0)}),i)},updateFeature:function(t,e,i){this.updateFeatures(t,e,i)},updateFeatures:function(t,e,i){var o=t.features?t.features:[t];return t=O(t,this.options.idAttribute),this.post("updateFeatures",{features:t=o.length>1?t:[t]},(function(t,o){e&&e.call(i,t||o.updateResults[0].error,o&&o.updateResults?o.updateResults.length>1?o.updateResults:o.updateResults[0]:void 0)}),i)},deleteFeature:function(t,e,i){this.deleteFeatures(t,e,i)},deleteFeatures:function(t,e,i){return this.post("deleteFeatures",{objectIds:t},(function(t,o){e&&e.call(i,t||o.deleteResults[0].error,o&&o.deleteResults?o.deleteResults.length>1?o.deleteResults:o.deleteResults[0]:void 0)}),i)}});function gt(t){return new ft(t)}var vt=gt,bt="https:"!==window.location.protocol?"http:":"https:",yt=c.TileLayer.extend({statics:{TILES:{Streets:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Street_Map"}},Topographic:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Topo_Map"}},Oceans:{urlTemplate:bt+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/Ocean_Basemap"}},OceansLabels:{urlTemplate:bt+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:s?"esri-labels":"tilePane",attribution:""}},NationalGeographic:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"National Geographic, DeLorme, HERE, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, increment P Corp."}},DarkGray:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},DarkGrayLabels:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:s?"esri-labels":"tilePane",attribution:""}},Gray:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},GrayLabels:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:s?"esri-labels":"tilePane",attribution:""}},Imagery:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}},ImageryLabels:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:s?"esri-labels":"tilePane",attribution:""}},ImageryTransportation:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:s?"esri-labels":"tilePane",attribution:""}},ShadedRelief:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS"}},ShadedReliefLabels:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:12,subdomains:["server","services"],pane:s?"esri-labels":"tilePane",attribution:""}},Terrain:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS, NOAA"}},TerrainLabels:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],pane:s?"esri-labels":"tilePane",attribution:""}},USATopo:{urlTemplate:bt+"//{s}.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:15,subdomains:["server","services"],attribution:"USGS, National Geographic Society, i-cubed"}},ImageryClarity:{urlTemplate:bt+"//clarity.maptiles.arcgis.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community"}},Physical:{urlTemplate:bt+"//{s}.arcgisonline.com/arcgis/rest/services/World_Physical_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:8,subdomains:["server","services"],attribution:"U.S. National Park Service"}},ImageryFirefly:{urlTemplate:bt+"//fly.maptiles.arcgis.com/arcgis/rest/services/World_Imagery_Firefly/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}}}},initialize:function(t,e){var i;if("object"==typeof t&&t.urlTemplate&&t.options)i=t;else{if("string"!=typeof t||!yt.TILES[t])throw new Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Physical", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ImageryClarity", "ImageryFirefly", ShadedRelief", "ShadedReliefLabels", "Terrain", "TerrainLabels" or "USATopo"');i=yt.TILES[t]}var o=c.Util.extend(i.options,e);c.Util.setOptions(this,o),this.options.token&&-1===i.urlTemplate.indexOf("token=")&&(i.urlTemplate+="?token="+this.options.token),this.options.proxy&&(i.urlTemplate=this.options.proxy+"?"+i.urlTemplate),c.TileLayer.prototype.initialize.call(this,i.urlTemplate,o)},onAdd:function(t){G(t),"esri-labels"===this.options.pane&&this._initPane(),this.options.attributionUrl&&j((this.options.proxy?this.options.proxy+"?":"")+this.options.attributionUrl,t),t.on("moveend",q),c.TileLayer.prototype.onAdd.call(this,t)},onRemove:function(t){z(t),t.off("moveend",q),c.TileLayer.prototype.onRemove.call(this,t)},_initPane:function(){if(!this._map.getPane(this.options.pane)){var t=this._map.createPane(this.options.pane);t.style.pointerEvents="none",t.style.zIndex=500}},getAttribution:function(){if(this.options.attribution)var t='<span class="esri-dynamic-attribution">'+this.options.attribution+"</span>";return t}});function _t(t,e){return new yt(t,e)}var xt=c.TileLayer.extend({options:{zoomOffsetAllowance:.1,errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAA1BMVEUzNDVszlHHAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAAAAAAAAAB6mUWpAAAADZJREFUeJztwQEBAAAAgiD/r25IQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7waBAAABw08RwAAAAABJRU5ErkJggg=="},statics:{MercatorZoomLevels:{0:156543.033928,1:78271.5169639999,2:39135.7584820001,3:19567.8792409999,4:9783.93962049996,5:4891.96981024998,6:2445.98490512499,7:1222.99245256249,8:611.49622628138,9:305.748113140558,10:152.874056570411,11:76.4370282850732,12:38.2185141425366,13:19.1092570712683,14:9.55462853563415,15:4.77731426794937,16:2.38865713397468,17:1.19432856685505,18:.597164283559817,19:.298582141647617,20:.14929107082381,21:.07464553541191,22:.0373227677059525,23:.0186613838529763}},initialize:function(t){t=F(t=c.Util.setOptions(this,t)),this.tileUrl=(t.proxy?t.proxy+"?":"")+t.url+"tile/{z}/{y}/{x}"+(t.requestParams&&Object.keys(t.requestParams).length>0?c.Util.getParamString(t.requestParams):""),-1!==t.url.indexOf("{s}")&&t.subdomains&&(t.url=t.url.replace("{s}",t.subdomains[0])),this.service=ht(t),this.service.addEventParent(this),new RegExp(/tiles.arcgis(online)?\.com/g).test(t.url)&&(this.tileUrl=this.tileUrl.replace("://tiles","://tiles{s}"),t.subdomains=["1","2","3","4"]),this.options.token&&(this.tileUrl+="?token="+this.options.token),c.TileLayer.prototype.initialize.call(this,this.tileUrl,t)},getTileUrl:function(t){var e=this._getZoomForUrl();return c.Util.template(this.tileUrl,c.Util.extend({s:this._getSubdomain(t),x:t.x,y:t.y,z:this._lodMap&&this._lodMap[e]?this._lodMap[e]:e},this.options))},createTile:function(t,e){var i=document.createElement("img");return c.DomEvent.on(i,"load",c.Util.bind(this._tileOnLoad,this,e,i)),c.DomEvent.on(i,"error",c.Util.bind(this._tileOnError,this,e,i)),this.options.crossOrigin&&(i.crossOrigin=""),i.alt="",!this._lodMap||this._lodMap&&this._lodMap[this._getZoomForUrl()]?i.src=this.getTileUrl(t):this.once("lodmap",(function(){i.src=this.getTileUrl(t)}),this),i},onAdd:function(t){G(t),this._lodMap||this.metadata((function(e,i){if(!e&&i.spatialReference){var o=i.spatialReference.latestWkid||i.spatialReference.wkid;if(!this.options.attribution&&t.attributionControl&&i.copyrightText&&(this.options.attribution=i.copyrightText,t.attributionControl.addAttribution(this.getAttribution())),t.options.crs!==c.CRS.EPSG3857||102100!==o&&3857!==o)t.options.crs&&t.options.crs.code&&t.options.crs.code.indexOf(o)>-1||v("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet http://esri.github.io/esri-leaflet/examples/non-mercator-projection.html");else{this._lodMap={};for(var n=i.tileInfo.lods,s=xt.MercatorZoomLevels,r=0;r<n.length;r++){var a=n[r];for(var l in s)if(this._withinPercentage(a.resolution,s[l],this.options.zoomOffsetAllowance)){this._lodMap[l]=a.level;break}}this.fire("lodmap")}}}),this),c.TileLayer.prototype.onAdd.call(this,t)},onRemove:function(t){z(t),c.TileLayer.prototype.onRemove.call(this,t)},metadata:function(t,e){return this.service.metadata(t,e),this},identify:function(){return this.service.identify()},find:function(){return this.service.find()},query:function(){return this.service.query()},authenticate:function(t){var e="?token="+t;return this.tileUrl=this.options.token?this.tileUrl.replace(/\?token=(.+)/g,e):this.tileUrl+e,this.options.token=t,this.service.authenticate(t),this},_withinPercentage:function(t,e,i){return Math.abs(t/e-1)<i}});function Ct(t,e){return new xt(t,e)}var St=c.ImageOverlay.extend({onAdd:function(t){this._topLeft=t.getPixelBounds().min,c.ImageOverlay.prototype.onAdd.call(this,t)},_reset:function(){this._map.options.crs===c.CRS.EPSG3857?c.ImageOverlay.prototype._reset.call(this):c.DomUtil.setPosition(this._image,this._topLeft.subtract(this._map.getPixelOrigin()))}}),Lt=c.Layer.extend({options:{opacity:1,position:"front",f:"image",useCors:n,attribution:null,interactive:!1,alt:""},onAdd:function(t){G(t),this.options.zIndex&&(this.options.position=null),this._update=c.Util.throttle(this._update,this.options.updateInterval,this),t.on("moveend",this._update,this),this._currentImage&&this._currentImage._bounds.equals(this._map.getBounds())?t.addLayer(this._currentImage):this._currentImage&&(this._map.removeLayer(this._currentImage),this._currentImage=null),this._update(),this._popup&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this.metadata((function(e,i){!e&&!this.options.attribution&&t.attributionControl&&i.copyrightText&&(this.options.attribution=i.copyrightText,t.attributionControl.addAttribution(this.getAttribution()))}),this)},onRemove:function(t){z(t),this._currentImage&&this._map.removeLayer(this._currentImage),this._popup&&(this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._map.off("moveend",this._update,this)},bindPopup:function(t,e){return this._shouldRenderPopup=!1,this._lastClick=!1,this._popup=Object(c.popup)(e),this._popupFunction=t,this._map&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this},unbindPopup:function(){return this._map&&(this._map.closePopup(this._popup),this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._popup=!1,this},bringToFront:function(){return this.options.position="front",this._currentImage&&(this._currentImage.bringToFront(),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this.options.position="back",this._currentImage&&(this._currentImage.bringToBack(),this._setAutoZIndex(Math.min)),this},setZIndex:function(t){return this.options.zIndex=t,this._currentImage&&this._currentImage.setZIndex(t),this},_setAutoZIndex:function(t){if(this._currentImage){for(var e,i=this._currentImage.getPane().children,o=-t(-1/0,1/0),n=0,s=i.length;n<s;n++)e=i[n].style.zIndex,i[n]!==this._currentImage._image&&e&&(o=t(o,+e));isFinite(o)&&(this.options.zIndex=o+t(-1,1),this.setZIndex(this.options.zIndex))}},getAttribution:function(){return this.options.attribution},getOpacity:function(){return this.options.opacity},setOpacity:function(t){return this.options.opacity=t,this._currentImage&&this._currentImage.setOpacity(t),this},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(t,e){return this.options.from=t,this.options.to=e,this._update(),this},metadata:function(t,e){return this.service.metadata(t,e),this},authenticate:function(t){return this.service.authenticate(t),this},redraw:function(){this._update()},_renderImage:function(t,e,i){if(this._map){if(i&&(t="data:"+i+";base64,"+t),!t)return;var o=new St(t,e,{opacity:0,crossOrigin:this.options.withCredentials?"use-credentials":this.options.useCors,alt:this.options.alt,pane:this.options.pane||this.getPane(),interactive:this.options.interactive}).addTo(this._map),n=function(t){if(o.off("error",n,this),this._map){var i=t.target,s=this._currentImage;i._bounds.equals(e)&&i._bounds.equals(this._map.getBounds())?(this._currentImage=i,"front"===this.options.position?this.bringToFront():"back"===this.options.position&&this.bringToBack(),this.options.zIndex&&this.setZIndex(this.options.zIndex),this._map&&this._currentImage._map?this._currentImage.setOpacity(this.options.opacity):this._currentImage._map.removeLayer(this._currentImage),s&&this._map&&this._map.removeLayer(s),s&&s._map&&s._map.removeLayer(s)):this._map.removeLayer(i)}this.fire("load",{bounds:e})};o.once("error",(function(){this._map.removeLayer(o),this.fire("error"),o.off("load",n,this)}),this),o.once("load",n,this)}},_update:function(){if(this._map){var t=this._map.getZoom(),e=this._map.getBounds();if(!(this._animatingZoom||this._map._panTransition&&this._map._panTransition._inProgress))if(t>this.options.maxZoom||t<this.options.minZoom)this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null);else{var i=this._buildExportParams();c.Util.extend(i,this.options.requestParams),i?(this._requestExport(i,e),this.fire("loading",{bounds:e})):this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null)}}},_renderPopup:function(t,e,i,o){if(t=Object(c.latLng)(t),this._shouldRenderPopup&&this._lastClick.equals(t)){var n=this._popupFunction(e,i,o);n&&this._popup.setLatLng(t).setContent(n).openOn(this._map)}},_resetPopupState:function(t){this._shouldRenderPopup=!1,this._lastClick=t.latlng},_calculateBbox:function(){var t=this._map.getPixelBounds(),e=this._map.unproject(t.getBottomLeft()),i=this._map.unproject(t.getTopRight()),o=this._map.options.crs.project(i),n=this._map.options.crs.project(e),s=Object(c.bounds)(o,n);return[s.getBottomLeft().x,s.getBottomLeft().y,s.getTopRight().x,s.getTopRight().y].join(",")},_calculateImageSize:function(){var t=this._map.getPixelBounds(),e=this._map.getSize(),i=this._map.unproject(t.getBottomLeft()),o=this._map.unproject(t.getTopRight()),n=this._map.latLngToLayerPoint(o).y,s=this._map.latLngToLayerPoint(i).y;return(n>0||s<e.y)&&(e.y=s-n),e.x+","+e.y}}),Tt=Lt.extend({options:{updateInterval:150,format:"jpgpng",transparent:!0,f:"image"},query:function(){return this.service.query()},identify:function(){return this.service.identify()},initialize:function(t){t=F(t),this.service=mt(t),this.service.addEventParent(this),c.Util.setOptions(this,t)},setPixelType:function(t){return this.options.pixelType=t,this._update(),this},getPixelType:function(){return this.options.pixelType},setBandIds:function(t){return this.options.bandIds=c.Util.isArray(t)?t.join(","):t.toString(),this._update(),this},getBandIds:function(){return this.options.bandIds},setNoData:function(t,e){return this.options.noData=c.Util.isArray(t)?t.join(","):t.toString(),e&&(this.options.noDataInterpretation=e),this._update(),this},getNoData:function(){return this.options.noData},getNoDataInterpretation:function(){return this.options.noDataInterpretation},setRenderingRule:function(t){this.options.renderingRule=t,this._update()},getRenderingRule:function(){return this.options.renderingRule},setMosaicRule:function(t){this.options.mosaicRule=t,this._update()},getMosaicRule:function(){return this.options.mosaicRule},_getPopupData:function(t){var e=c.Util.bind((function(e,i,o){e||setTimeout(c.Util.bind((function(){this._renderPopup(t.latlng,e,i,o)}),this),300)}),this),i=this.identify().at(t.latlng);this.options.mosaicRule&&i.setMosaicRule(this.options.mosaicRule),i.run(e),this._shouldRenderPopup=!0,this._lastClick=t.latlng},_buildExportParams:function(){var t=parseInt(this._map.options.crs.code.split(":")[1],10),e={bbox:this._calculateBbox(),size:this._calculateImageSize(),format:this.options.format,transparent:this.options.transparent,bboxSR:t,imageSR:t};return this.options.from&&this.options.to&&(e.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.options.pixelType&&(e.pixelType=this.options.pixelType),this.options.interpolation&&(e.interpolation=this.options.interpolation),this.options.compressionQuality&&(e.compressionQuality=this.options.compressionQuality),this.options.bandIds&&(e.bandIds=this.options.bandIds),(0===this.options.noData||this.options.noData)&&(e.noData=this.options.noData),this.options.noDataInterpretation&&(e.noDataInterpretation=this.options.noDataInterpretation),this.service.options.token&&(e.token=this.service.options.token),this.options.renderingRule&&(e.renderingRule=JSON.stringify(this.options.renderingRule)),this.options.mosaicRule&&(e.mosaicRule=JSON.stringify(this.options.mosaicRule)),e},_requestExport:function(t,e){if("json"===this.options.f)this.service.request("exportImage",t,(function(t,i){t||(this.options.token&&(i.href+="?token="+this.options.token),this.options.proxy&&(i.href=this.options.proxy+"?"+i.href),this._renderImage(i.href,e))}),this);else{t.f="image";var i=this.options.url+"exportImage"+c.Util.getParamString(t);this.options.proxy&&(i=this.options.proxy+"?"+i),this._renderImage(i,e)}}});function Ot(t,e){return new Tt(t,e)}var wt=Lt.extend({options:{updateInterval:150,layers:!1,layerDefs:!1,timeOptions:!1,format:"png32",transparent:!0,f:"json"},initialize:function(t){t=F(t),this.service=ht(t),this.service.addEventParent(this),c.Util.setOptions(this,t)},getDynamicLayers:function(){return this.options.dynamicLayers},setDynamicLayers:function(t){return this.options.dynamicLayers=t,this._update(),this},getLayers:function(){return this.options.layers},setLayers:function(t){return this.options.layers=t,this._update(),this},getLayerDefs:function(){return this.options.layerDefs},setLayerDefs:function(t){return this.options.layerDefs=t,this._update(),this},getTimeOptions:function(){return this.options.timeOptions},setTimeOptions:function(t){return this.options.timeOptions=t,this._update(),this},query:function(){return this.service.query()},identify:function(){return this.service.identify()},find:function(){return this.service.find()},_getPopupData:function(t){var e,i=c.Util.bind((function(e,i,o){e||setTimeout(c.Util.bind((function(){this._renderPopup(t.latlng,e,i,o)}),this),300)}),this);if((e=this.options.popup?this.options.popup.on(this._map).at(t.latlng):this.identify().on(this._map).at(t.latlng)).params.maxAllowableOffset||e.simplify(this._map,.5),this.options.popup&&this.options.popup.params&&this.options.popup.params.layers||e.layers(this.options.layers?"visible:"+this.options.layers.join(","):"visible"),this.options.layerDefs&&"string"!=typeof this.options.layerDefs&&!e.params.layerDefs)for(var o in this.options.layerDefs)this.options.layerDefs.hasOwnProperty(o)&&e.layerDef(o,this.options.layerDefs[o]);e.run(i),this._shouldRenderPopup=!0,this._lastClick=t.latlng},_buildExportParams:function(){var t=parseInt(this._map.options.crs.code.split(":")[1],10),e={bbox:this._calculateBbox(),size:this._calculateImageSize(),dpi:96,format:this.options.format,transparent:this.options.transparent,bboxSR:t,imageSR:t};if(this.options.dynamicLayers&&(e.dynamicLayers=this.options.dynamicLayers),this.options.layers){if(0===this.options.layers.length)return;e.layers="show:"+this.options.layers.join(",")}return this.options.layerDefs&&(e.layerDefs="string"==typeof this.options.layerDefs?this.options.layerDefs:JSON.stringify(this.options.layerDefs)),this.options.timeOptions&&(e.timeOptions=JSON.stringify(this.options.timeOptions)),this.options.from&&this.options.to&&(e.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.service.options.token&&(e.token=this.service.options.token),this.options.proxy&&(e.proxy=this.options.proxy),this.options.disableCache&&(e._ts=Date.now()),e},_requestExport:function(t,e){if("json"===this.options.f)this.service.request("export",t,(function(t,i){t||(this.options.token&&i.href&&(i.href+="?token="+this.options.token),this.options.proxy&&i.href&&(i.href=this.options.proxy+"?"+i.href),i.href?this._renderImage(i.href,e):this._renderImage(i.imageData,e,i.contentType))}),this);else{t.f="image";var i=this.options.url+"export"+c.Util.getParamString(t);this.options.proxy&&(i=this.options.proxy+"?"+i),this._renderImage(i,e)}}});function Mt(t,e){return new wt(t,e)}var kt=c.Layer.extend({options:{cellSize:512,updateWhenIdle:c.Browser.mobile,updateInterval:150,noWrap:!1,keepBuffer:1.5},initialize:function(t){c.Util.setOptions(this,t)},onAdd:function(t){this._cells={},this._activeCells={},this._resetView(),this._update()},onRemove:function(t){this._removeAllCells(),this._cellZoom=void 0},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllCells(),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=c.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),t},createCell:function(){return document.createElement("div")},removeCell:function(){},reuseCell:function(){},cellLeave:function(){},cellEnter:function(){},getCellSize:function(){var t=this.options.cellSize;return t instanceof c.Point?t:new c.Point(t,t)},_pruneCells:function(){if(this._map){var t,e;for(t in this._cells)(e=this._cells[t]).retain=e.current;for(t in this._cells)if((e=this._cells[t]).current&&!e.active){var i=e.coords;this._retainParent(i.x,i.y,i.z,i.z-5)||this._retainChildren(i.x,i.y,i.z,i.z+2)}for(t in this._cells)this._cells[t].retain||this._removeCell(t)}},_removeAllCells:function(){for(var t in this._cells)this._removeCell(t)},_invalidateAll:function(){this._removeAllCells(),this._cellZoom=void 0},_retainParent:function(t,e,i,o){var n=Math.floor(t/2),s=Math.floor(e/2),r=i-1,a=new c.Point(+n,+s);a.z=+r;var l=this._cellCoordsToKey(a),u=this._cells[l];return u&&u.active?(u.retain=!0,!0):(u&&u.loaded&&(u.retain=!0),r>o&&this._retainParent(n,s,r,o))},_retainChildren:function(t,e,i,o){for(var n=2*t;n<2*t+2;n++)for(var s=2*e;s<2*e+2;s++){var r=new c.Point(n,s);r.z=i+1;var a=this._cellCoordsToKey(r),l=this._cells[a];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),i+1<o&&this._retainChildren(n,s,i+1,o))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);e||this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_setView:function(t,e,i,o){var n=Math.round(e);o||(this._cellZoom=n,this._abortLoading&&this._abortLoading(),this._resetGrid(),void 0!==n&&this._update(t),i||this._pruneCells(),this._noPrune=!!i)},_resetGrid:function(){var t=this._map,e=t.options.crs,i=this._cellSize=this.getCellSize(),o=this._cellZoom,n=this._map.getPixelWorldBounds(this._cellZoom);n&&(this._globalCellRange=this._pxBoundsToCellRange(n)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],o).x/i.x),Math.ceil(t.project([0,e.wrapLng[1]],o).x/i.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],o).y/i.x),Math.ceil(t.project([e.wrapLat[1],0],o).y/i.y)]},_onMoveEnd:function(t){t&&(t.pinch||t.flyTo)||!this._map||this._map._animatingZoom||this._update()},_getCelldPixelBounds:function(t){var e=this._map,i=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),o=e.getZoomScale(i,this._cellZoom),n=e.project(t,this._cellZoom).floor(),s=e.getSize().divideBy(2*o);return new c.Bounds(n.subtract(s),n.add(s))},_update:function(t){var e=this._map;if(e){var i=Math.round(e.getZoom());void 0===t&&(t=e.getCenter());var o=this._getCelldPixelBounds(t),n=this._pxBoundsToCellRange(o),s=n.getCenter(),r=[],a=this.options.keepBuffer,l=new c.Bounds(n.getBottomLeft().subtract([a,-a]),n.getTopRight().add([a,-a]));if(!(isFinite(n.min.x)&&isFinite(n.min.y)&&isFinite(n.max.x)&&isFinite(n.max.y)))throw new Error("Attempted to load an infinite number of cells");for(var u in this._cells){var h=this._cells[u].coords;h.z===this._cellZoom&&l.contains(new c.Point(h.x,h.y))||(this._cells[u].current=!1)}if(Math.abs(i-this._cellZoom)>1)this._setView(t,i);else{for(var p=n.min.y;p<=n.max.y;p++)for(var d=n.min.x;d<=n.max.x;d++){var m=new c.Point(d,p);if(m.z=this._cellZoom,this._isValidCell(m)){var f=this._cells[this._cellCoordsToKey(m)];f?f.current=!0:r.push(m)}}if(r.sort((function(t,e){return t.distanceTo(s)-e.distanceTo(s)})),0!==r.length)for(this._loading||(this._loading=!0),d=0;d<r.length;d++){var g=this._cellCoordsToKey(r[d]),v=this._keyToCellCoords(g);this._activeCells[v]?this._reuseCell(r[d]):this._createCell(r[d])}}}},_isValidCell:function(t){var e=this._map.options.crs;if(!e.infinite){var i=this._globalCellRange;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;var o=this._cellCoordsToBounds(t);return Object(c.toLatLngBounds)(this.options.bounds).overlaps(o)},_keyToBounds:function(t){return this._cellCoordsToBounds(this._keyToCellCoords(t))},_cellCoordsToNwSe:function(t){var e=this._map,i=this.getCellSize(),o=t.scaleBy(i),n=o.add(i);return[e.unproject(o,t.z),e.unproject(n,t.z)]},_cellCoordsToBounds:function(t){var e=this._cellCoordsToNwSe(t),i=new c.LatLngBounds(e[0],e[1]);return this.options.noWrap||(i=this._map.wrapLatLngBounds(i)),i},_cellCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToCellCoords:function(t){var e=t.split(":"),i=new c.Point(+e[0],+e[1]);return i.z=+e[2],i},_removeCell:function(t){var e=this._cells[t];if(e){var i=this._keyToCellCoords(t),o=this._wrapCoords(i),n=this._cellCoordsToBounds(this._wrapCoords(i));e.current=!1,delete this._cells[t],this._activeCells[t]=e,this.cellLeave(n,o,t),this.fire("cellleave",{key:t,coords:o,bounds:n})}},_reuseCell:function(t){var e=this._cellCoordsToKey(t);this._cells[e]=this._activeCells[e],this._cells[e].current=!0;var i=this._wrapCoords(t),o=this._cellCoordsToBounds(this._wrapCoords(t));this.cellEnter(o,i,e),this.fire("cellenter",{key:e,coords:i,bounds:o})},_createCell:function(t){var e=this._cellCoordsToKey(t),i=this._wrapCoords(t),o=this._cellCoordsToBounds(this._wrapCoords(t));this.createCell(o,i,e),this.fire("cellcreate",{key:e,coords:i,bounds:o}),this._cells[e]={coords:t,current:!0},c.Util.requestAnimFrame(this._pruneCells,this)},_cellReady:function(t,e,i){var o=this._cellCoordsToKey(t);(i=this._cells[o])&&(i.loaded=+new Date,i.active=!0)},_getCellPos:function(t){return t.scaleBy(this.getCellSize())},_wrapCoords:function(t){var e=new c.Point(this._wrapX?c.Util.wrapNum(t.x,this._wrapX):t.x,this._wrapY?c.Util.wrapNum(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToCellRange:function(t){var e=this.getCellSize();return new c.Bounds(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))}});function Pt(t){this.values=[].concat(t||[])}Pt.prototype.query=function(t){var e=this.getIndex(t);return this.values[e]},Pt.prototype.getIndex=function(t){this.dirty&&this.sort();for(var e,i,o=0,n=this.values.length-1;o<=n;)if(e=(o+n)/2|0,+(i=this.values[Math.round(e)]).value<+t)o=e+1;else{if(!(+i.value>+t))return e;n=e-1}return Math.abs(~n)},Pt.prototype.between=function(t,e){var i=this.getIndex(t),o=this.getIndex(e);if(0===i&&0===o)return[];for(;this.values[i-1]&&this.values[i-1].value===t;)i--;for(;this.values[o+1]&&this.values[o+1].value===e;)o++;return this.values[o]&&this.values[o].value===e&&this.values[o+1]&&o++,this.values.slice(i,o)},Pt.prototype.insert=function(t){return this.values.splice(this.getIndex(t.value),0,t),this},Pt.prototype.bulkAdd=function(t,e){return this.values=this.values.concat([].concat(t||[])),e?this.sort():this.dirty=!0,this},Pt.prototype.sort=function(){return this.values.sort((function(t,e){return+e.value-+t.value})).reverse(),this.dirty=!1,this};var It=Pt,At=kt.extend({options:{attribution:null,where:"1=1",fields:["*"],from:!1,to:!1,timeField:!1,timeFilterMode:"server",simplifyFactor:0,precision:6,fetchAllFeatures:!1},initialize:function(t){if(kt.prototype.initialize.call(this,t),t=F(t),t=c.Util.setOptions(this,t),this.service=vt(t),this.service.addEventParent(this),"*"!==this.options.fields[0]){for(var e=!1,i=0;i<this.options.fields.length;i++)this.options.fields[i].match(/^(OBJECTID|FID|OID|ID)$/i)&&(e=!0);!1===e&&v("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")}this.options.timeField.start&&this.options.timeField.end?(this._startTimeIndex=new It,this._endTimeIndex=new It):this.options.timeField&&(this._timeIndex=new It),this._cache={},this._currentSnapshot=[],this._activeRequests=0},onAdd:function(t){return G(t),this.service.metadata((function(e,i){if(!e){var o=i.supportedQueryFormats,n=!1;(!1===this.service.options.isModern||this.options.fetchAllFeatures)&&(n=!0),!n&&o&&-1!==o.indexOf("geoJSON")&&(this.service.options.isModern=!0),i.objectIdField&&(this.service.options.idAttribute=i.objectIdField),!this.options.attribution&&t.attributionControl&&i.copyrightText&&(this.options.attribution=i.copyrightText,t.attributionControl.addAttribution(this.getAttribution()))}}),this),t.on("zoomend",this._handleZoomChange,this),kt.prototype.onAdd.call(this,t)},onRemove:function(t){return z(t),t.off("zoomend",this._handleZoomChange,this),kt.prototype.onRemove.call(this,t)},getAttribution:function(){return this.options.attribution},createCell:function(t,e){this._visibleZoom()&&this._requestFeatures(t,e)},_requestFeatures:function(t,e,i,o){this._activeRequests++,o=o||0;var n=this.options.where;return 1===this._activeRequests&&this.fire("loading",{bounds:t},!0),this._buildQuery(t,o).run((function(s,r,a){a&&a.exceededTransferLimit&&this.fire("drawlimitexceeded"),this.options.where===n&&(!s&&r&&r.features.length&&c.Util.requestAnimFrame(c.Util.bind((function(){this._addFeatures(r.features,e),this._postProcessFeatures(t)}),this)),s||!r||r.features.length||this._postProcessFeatures(t),s&&this._postProcessFeatures(t),i&&i.call(this,s,r),a&&(a.exceededTransferLimit||a.properties&&a.properties.exceededTransferLimit)&&this.options.fetchAllFeatures&&this._requestFeatures(t,e,i,o+r.features.length))}),this)},_postProcessFeatures:function(t){this._activeRequests--,this._activeRequests<=0&&this.fire("load",{bounds:t})},_cacheKey:function(t){return t.z+":"+t.x+":"+t.y},_addFeatures:function(t,e){if(e){var i=this._cacheKey(e);this._cache[i]=this._cache[i]||[]}for(var o=t.length-1;o>=0;o--){var n=t[o].id;-1===this._currentSnapshot.indexOf(n)&&this._currentSnapshot.push(n),void 0!==i&&-1===this._cache[i].indexOf(n)&&this._cache[i].push(n)}this.options.timeField&&this._buildTimeIndexes(t),this.createLayers(t)},_buildQuery:function(t,e){var i=this.service.query().intersects(t).where(this.options.where).fields(this.options.fields).precision(this.options.precision);return this.options.fetchAllFeatures&&!isNaN(parseInt(e))&&(i=i.offset(e)),i.params.resultType="tile",this.options.requestParams&&c.Util.extend(i.params,this.options.requestParams),this.options.simplifyFactor&&i.simplify(this._map,this.options.simplifyFactor),"server"===this.options.timeFilterMode&&this.options.from&&this.options.to&&i.between(this.options.from,this.options.to),i},setWhere:function(t,e,i){this.options.where=t&&t.length?t:"1=1";for(var o=[],n=[],s=0,r=null,a=c.Util.bind((function(a,l){if(a&&(r=a),l)for(var u=l.features.length-1;u>=0;u--)n.push(l.features[u].id);--s<=0&&this._visibleZoom()&&t===this.options.where&&(this._currentSnapshot=n,c.Util.requestAnimFrame(c.Util.bind((function(){this.removeLayers(o),this.addLayers(n),e&&e.call(i,r)}),this)))}),this),l=this._currentSnapshot.length-1;l>=0;l--)o.push(this._currentSnapshot[l]);for(var u in this._cache={},this._cells){s++;var h=this._keyToCellCoords(u),p=this._cellCoordsToBounds(h);this._requestFeatures(p,h,a)}return this},getWhere:function(){return this.options.where},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(t,e,i,o){var n=this.options.from,s=this.options.to,r=0,a=null,l=c.Util.bind((function(c){c&&(a=c),this._filterExistingFeatures(n,s,t,e),r--,i&&r<=0&&i.call(o,a)}),this);if(this.options.from=t,this.options.to=e,this._filterExistingFeatures(n,s,t,e),"server"===this.options.timeFilterMode)for(var u in this._cells){r++;var h=this._keyToCellCoords(u),p=this._cellCoordsToBounds(h);this._requestFeatures(p,h,l)}return this},refresh:function(){this.setWhere(this.options.where)},_filterExistingFeatures:function(t,e,i,o){var n=t&&e?this._getFeaturesInTimeRange(t,e):this._currentSnapshot,s=this._getFeaturesInTimeRange(i,o);if(s.indexOf)for(var r=0;r<s.length;r++){var a=n.indexOf(s[r]);a>=0&&n.splice(a,1)}c.Util.requestAnimFrame(c.Util.bind((function(){this.removeLayers(n),this.addLayers(s)}),this))},_getFeaturesInTimeRange:function(t,e){var i,o=[];if(this.options.timeField.start&&this.options.timeField.end){var n=this._startTimeIndex.between(t,e),s=this._endTimeIndex.between(t,e);i=n.concat(s)}else{if(!this._timeIndex)return v("You must set timeField in the layer constructor in order to manipulate the start and end time filter."),[];i=this._timeIndex.between(t,e)}for(var r=i.length-1;r>=0;r--)o.push(i[r].id);return o},_buildTimeIndexes:function(t){var e,i;if(this.options.timeField.start&&this.options.timeField.end){var o=[],n=[];for(e=t.length-1;e>=0;e--)o.push({id:(i=t[e]).id,value:new Date(i.properties[this.options.timeField.start])}),n.push({id:i.id,value:new Date(i.properties[this.options.timeField.end])});this._startTimeIndex.bulkAdd(o),this._endTimeIndex.bulkAdd(n)}else{var s=[];for(e=t.length-1;e>=0;e--)s.push({id:(i=t[e]).id,value:new Date(i.properties[this.options.timeField])});this._timeIndex.bulkAdd(s)}},_featureWithinTimeRange:function(t){if(!this.options.from||!this.options.to)return!0;var e=+this.options.from.valueOf(),i=+this.options.to.valueOf();if("string"==typeof this.options.timeField){var o=+t.properties[this.options.timeField];return o>=e&&o<=i}if(this.options.timeField.start&&this.options.timeField.end){var n=+t.properties[this.options.timeField.start],s=+t.properties[this.options.timeField.end];return n>=e&&n<=i||s>=e&&s<=i||n<=e&&s>=i}},_visibleZoom:function(){if(!this._map)return!1;var t=this._map.getZoom();return!(t>this.options.maxZoom||t<this.options.minZoom)},_handleZoomChange:function(){if(this._visibleZoom())for(var t in this._cells){var e=this._cacheKey(this._cells[t].coords);this._cache[e]&&this.addLayers(this._cache[e])}else this.removeLayers(this._currentSnapshot)},authenticate:function(t){return this.service.authenticate(t),this},metadata:function(t,e){return this.service.metadata(t,e),this},query:function(){return this.service.query()},_getMetadata:function(t){this._metadata?t(void 0,this._metadata):this.metadata(c.Util.bind((function(e,i){this._metadata=i,t(e,this._metadata)}),this))},addFeature:function(t,e,i){this.addFeatures(t,e,i)},addFeatures:function(t,e,i){this._getMetadata(c.Util.bind((function(o,n){if(o)e&&e.call(this,o,null);else{var s=t.features?t.features:[t];this.service.addFeatures(t,c.Util.bind((function(t,o){if(!t){for(var r=s.length-1;r>=0;r--)s[r].properties[n.objectIdField]=s.length>1?o[r].objectId:o.objectId,s[r].id=s.length>1?o[r].objectId:o.objectId;this._addFeatures(s)}e&&e.call(i,t,o)}),this))}}),this))},updateFeature:function(t,e,i){this.updateFeatures(t,e,i)},updateFeatures:function(t,e,i){var o=t.features?t.features:[t];this.service.updateFeatures(t,(function(t,n){if(!t){for(var s=o.length-1;s>=0;s--)this.removeLayers([o[s].id],!0);this._addFeatures(o)}e&&e.call(i,t,n)}),this)},deleteFeature:function(t,e,i){this.deleteFeatures(t,e,i)},deleteFeatures:function(t,e,i){return this.service.deleteFeatures(t,(function(t,o){var n=o.length?o:[o];if(!t&&n.length>0)for(var s=n.length-1;s>=0;s--)this.removeLayers([n[s].objectId],!0);e&&e.call(i,t,o)}),this)}}),Dt=At.extend({options:{cacheLayers:!0},initialize:function(t){t.apikey&&(t.token=t.apikey),At.prototype.initialize.call(this,t),this._originalStyle=this.options.style,this._layers={}},onRemove:function(t){for(var e in this._layers)t.removeLayer(this._layers[e]),this.fire("removefeature",{feature:this._layers[e].feature,permanent:!1},!0);return At.prototype.onRemove.call(this,t)},createNewLayer:function(t){var e=c.GeoJSON.geometryToLayer(t,this.options);return e&&(e.defaultOptions=e.options),e},_updateLayer:function(t,e){var i=[],o=this.options.coordsToLatLng||c.GeoJSON.coordsToLatLng;switch(e.properties&&(t.feature.properties=e.properties),e.geometry.type){case"Point":i=c.GeoJSON.coordsToLatLng(e.geometry.coordinates),t.setLatLng(i);break;case"LineString":i=c.GeoJSON.coordsToLatLngs(e.geometry.coordinates,0,o),t.setLatLngs(i);break;case"MultiLineString":case"Polygon":i=c.GeoJSON.coordsToLatLngs(e.geometry.coordinates,1,o),t.setLatLngs(i);break;case"MultiPolygon":i=c.GeoJSON.coordsToLatLngs(e.geometry.coordinates,2,o),t.setLatLngs(i)}},createLayers:function(t){for(var e=t.length-1;e>=0;e--){var i,o=t[e],n=this._layers[o.id];!this._visibleZoom()||!n||this._map.hasLayer(n)||this.options.timeField&&!this._featureWithinTimeRange(o)||(this._map.addLayer(n),this.fire("addfeature",{feature:n.feature},!0)),n&&this.options.simplifyFactor>0&&(n.setLatLngs||n.setLatLng)&&this._updateLayer(n,o),n||((i=this.createNewLayer(o))?(i.feature=o,i.addEventParent(this),this.options.onEachFeature&&this.options.onEachFeature(i.feature,i),this._layers[i.feature.id]=i,this.setFeatureStyle(i.feature.id,this.options.style),this.fire("createfeature",{feature:i.feature},!0),this._visibleZoom()&&(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(o))&&this._map.addLayer(i)):v("invalid GeoJSON encountered"))}},addLayers:function(t){for(var e=t.length-1;e>=0;e--){var i=this._layers[t[e]];!i||this.options.timeField&&!this._featureWithinTimeRange(i.feature)||this._map.addLayer(i)}},removeLayers:function(t,e){for(var i=t.length-1;i>=0;i--){var o=t[i],n=this._layers[o];n&&(this.fire("removefeature",{feature:n.feature,permanent:e},!0),this._map.removeLayer(n)),n&&e&&delete this._layers[o]}},cellEnter:function(t,e){this._visibleZoom()&&!this._zooming&&this._map&&c.Util.requestAnimFrame(c.Util.bind((function(){var t=this._cacheKey(e),i=this._cellCoordsToKey(e),o=this._cache[t];this._activeCells[i]&&o&&this.addLayers(o)}),this))},cellLeave:function(t,e){this._zooming||c.Util.requestAnimFrame(c.Util.bind((function(){if(this._map){var t=this._cacheKey(e),i=this._cellCoordsToKey(e),o=this._cache[t],n=this._map.getBounds();if(!this._activeCells[i]&&o){for(var s=!0,r=0;r<o.length;r++){var a=this._layers[o[r]];a&&a.getBounds&&n.intersects(a.getBounds())&&(s=!1)}s&&this.removeLayers(o,!this.options.cacheLayers),!this.options.cacheLayers&&s&&(delete this._cache[t],delete this._cells[i],delete this._activeCells[i])}}}),this))},resetStyle:function(){return this.options.style=this._originalStyle,this.eachFeature((function(t){this.resetFeatureStyle(t.feature.id)}),this),this},setStyle:function(t){return this.options.style=t,this.eachFeature((function(e){this.setFeatureStyle(e.feature.id,t)}),this),this},resetFeatureStyle:function(t){var e=this._layers[t],i=this._originalStyle||c.Path.prototype.options;return e&&(c.Util.extend(e.options,e.defaultOptions),this.setFeatureStyle(t,i)),this},setFeatureStyle:function(t,e){var i=this._layers[t];return"function"==typeof e&&(e=e(i.feature)),i.setStyle&&i.setStyle(e),this},eachActiveFeature:function(t,e){if(this._map){var i=this._map.getBounds();for(var o in this._layers)-1!==this._currentSnapshot.indexOf(this._layers[o].feature.id)&&("function"==typeof this._layers[o].getLatLng&&i.contains(this._layers[o].getLatLng())||"function"==typeof this._layers[o].getBounds&&i.intersects(this._layers[o].getBounds()))&&t.call(e,this._layers[o])}return this},eachFeature:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getFeature:function(t){return this._layers[t]},bringToBack:function(){this.eachFeature((function(t){t.bringToBack&&t.bringToBack()}))},bringToFront:function(){this.eachFeature((function(t){t.bringToFront&&t.bringToFront()}))},redraw:function(t){return t&&this._redraw(t),this},_redraw:function(t){var e=this._layers[t],i=e.feature;if(e&&e.setIcon&&this.options.pointToLayer&&this.options.pointToLayer){var o=this.options.pointToLayer(i,Object(c.latLng)(i.geometry.coordinates[1],i.geometry.coordinates[0]));e.setIcon(o.options.icon)}if(e&&e.setStyle&&this.options.pointToLayer){var n=this.options.pointToLayer(i,Object(c.latLng)(i.geometry.coordinates[1],i.geometry.coordinates[0]));this.setFeatureStyle(i.id,n.options)}e&&e.setStyle&&this.options.style&&this.resetStyle(i.id)}});function Rt(t){return new Dt(t)}var Ft=o.version},aAg2:function(t){t.exports=JSON.parse('{"name":"esri-leaflet","description":"Leaflet plugins for consuming ArcGIS Online and ArcGIS Server services.","version":"3.0.2","author":"Patrick Arlt <parlt@esri.com> (http://patrickarlt.com)","bugs":{"url":"https://github.com/esri/esri-leaflet/issues"},"contributors":["Patrick Arlt <parlt@esri.com> (http://patrickarlt.com)","John Gravois <jgravois@esri.com> (http://johngravois.com)","Gavin Rehkemper <grehkemper@esri.com>","Jacob Wasilkowski <jwasilkowski@esri.com> (https://jwasilgeo.github.io)"],"dependencies":{"@terraformer/arcgis":"^2.0.7","tiny-binary-search":"^1.0.3"},"devDependencies":{"@rollup/plugin-json":"^4.0.3","@rollup/plugin-node-resolve":"^7.1.3","chai":"4.2.0","gh-release":"^4.0.3","highlight.js":"^9.12.0","http-server":"^0.12.3","husky":"^1.1.1","istanbul":"^0.4.5","karma":"^5.2.3","karma-chai-sinon":"^0.1.5","karma-chrome-launcher":"^2.2.0","karma-coverage":"^1.1.2","karma-mocha":"^2.0.1","karma-mocha-reporter":"^2.2.5","karma-sourcemap-loader":"^0.3.7","leaflet":"^1.6.0","mkdirp":"^0.5.1","mocha":"^8.1.3","npm-run-all":"^4.0.2","rollup":"^2.0.0","rollup-plugin-uglify":"^6.0.4","semistandard":"^9.0.0","sinon":"^6.3.5","sinon-chai":"3.2.0","snazzy":"^8.0.0","uglify-js":"^2.8.29","watch":"^1.0.2"},"files":["src/**/*.js","dist/esri-leaflet.js","dist/esri-leaflet.js.map","dist/esri-leaflet-debug.js.map","profiles/*.js"],"homepage":"http://esri.github.io/esri-leaflet","module":"src/EsriLeaflet.js","jsnext:main":"src/EsriLeaflet.js","jspm":{"registry":"npm","format":"es6","main":"src/EsriLeaflet.js"},"keywords":["arcgis","esri","esri leaflet","gis","leaflet plugin","mapping"],"license":"Apache-2.0","main":"dist/esri-leaflet-debug.js","peerDependencies":{"leaflet":"^1.0.0"},"readmeFilename":"README.md","repository":{"type":"git","url":"git@github.com:Esri/esri-leaflet.git"},"scripts":{"build":"rollup -c profiles/debug.js & rollup -c profiles/production.js","lint":"semistandard | snazzy","prebuild":"mkdirp dist","prepare":"npm run build","pretest":"npm run build","precommit":"npm run lint","fix":"semistandard --fix","release":"./scripts/release.sh","start-watch":"watch \\"npm run build\\" src","start":"run-p start-watch serve","serve":"http-server -p 5000 -c-1 -o","test":"npm run lint && karma start","test:ci":"npm run lint && karma start --browsers Chrome_travis_ci"},"semistandard":{"globals":["expect","L","XMLHttpRequest","sinon","xhr","proj4"]},"unpkg":"dist/esri-leaflet-debug.js"}')},n4TO:function(t,e,i){"use strict";i.r(e),i.d(e,"CustomerMapModule",(function(){return Rt}));var o=i("ofXK"),n=i("tyNb"),s=i("0IaG"),r=i("4R65"),a=(i("b1UB"),i("CvBG"),i("mD1w"),i("eapw"),i("M9GK"),i("owmp"),i("qLfE"),i("HMfJ"),i("I8tt"),i("+clC"),i("fXoL")),c=i("3Pt+"),l=i("vQH4"),u=i("tmcy"),h=i("NFeN"),p=i("kmnG"),d=i("qFsG"),m=i("d3UM"),f=i("z17N"),g=i("bTqV"),v=i("FKr1");function b(t,e){if(1&t&&(a.fc(0,"mat-option",22),a.Tc(1),a.ec()),2&t){const t=e.$implicit;a.yc("value",t.id),a.Ob(1),a.Vc(" ",t.value," ")}}function y(t,e){if(1&t&&(a.fc(0,"mat-option",22),a.Tc(1),a.ec()),2&t){const t=e.$implicit;a.yc("value",t.id),a.Ob(1),a.Vc(" ",t.value," ")}}function _(t,e){if(1&t&&(a.fc(0,"mat-option",22),a.Tc(1),a.ec()),2&t){const t=e.$implicit;a.yc("value",t.id),a.Ob(1),a.Vc(" ",t.value," ")}}function x(t,e){if(1&t&&(a.fc(0,"mat-option",22),a.Tc(1),a.ec()),2&t){const t=e.$implicit;a.yc("value",t.id),a.Ob(1),a.Vc(" ",t.name," ")}}function C(t,e){if(1&t&&(a.fc(0,"mat-option",22),a.Tc(1),a.ec()),2&t){const t=e.$implicit;a.yc("value",t.id),a.Ob(1),a.Vc(" ",t.value," ")}}function S(t,e){if(1&t&&(a.fc(0,"mat-option",22),a.Tc(1),a.ec()),2&t){const t=e.$implicit;a.yc("value",t.id),a.Ob(1),a.Vc(" ",t.value," ")}}let L=(()=>{class t{constructor(t,e,i,o,n){this.dialogRef=t,this.dialog=e,this.fb=i,this.geofenceService=o,this.dateFormatService=n,this.states=[{id:1,value:"Active"},{id:0,value:"Inactive"}],this.types=[{id:1,value:"General Information"},{id:0,value:"Speed Information"}],this.formates=[{id:1,value:"HTML"},{id:0,value:"CSV"}],this.periods=[{id:1,value:"Today"},{id:0,value:"Yesterday"}],this.selected=1}ngOnInit(){this.reportForm=this.fb.group({title:[""],type:[""],format:[""],period:[""],devices:[""],geofences:[""],sendEmail:[""],speedLimit:[""],from_date:[""],to_date:[""],stops:[""]}),this.getAllGeofence(),setTimeout(()=>{const t=new Date;var e=new Date(t.getFullYear(),t.getMonth(),t.getDate());this.reportForm.patchValue({from_date:e,to_date:new Date})},100)}close(){this.dialogRef.close()}generateReport(){}getAllGeofence(){this.geofenceService.getAllGeofence().subscribe(t=>{this.geofences=t})}}return t.\u0275fac=function(e){return new(e||t)(a.Zb(s.f),a.Zb(s.b),a.Zb(c.e),a.Zb(l.a),a.Zb(u.a))},t.\u0275cmp=a.Tb({type:t,selectors:[["app-report"]],decls:56,vars:17,consts:[[1,"table-title"],[1,"toolsIcon"],[1,"closeIcon",3,"click"],[1,"historytab"],[3,"formGroup"],[1,"full"],["matInput","","placeholder","Title","formControlName","title","autocomplete","off","required",""],[1,"half"],["formControlName","type",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","format",3,"ngModel","ngModelChange"],["formControlName","period",3,"ngModel","ngModelChange"],["formControlName","geofences",3,"ngModel","ngModelChange"],["formControlName","devices",3,"ngModel","ngModelChange"],["matInput","","formControlName","from_date","placeholder","From Time",3,"owlDateTime","owlDateTimeTrigger"],["dt1",""],["matInput","","formControlName","to_date","placeholder","To Time",3,"owlDateTime","owlDateTimeTrigger"],["dt2",""],["matInput","","placeholder","Send to email","formControlName","sendEmail","autocomplete","off","required",""],["matInput","","placeholder","Speed limit","formControlName","speedLimit","autocomplete","off","required",""],["formControlName","stops",3,"ngModel","ngModelChange"],["mat-raised-button","","color","primary",1,"btn-block",3,"click"],[3,"value"]],template:function(t,e){if(1&t&&(a.fc(0,"div",0),a.fc(1,"h3"),a.fc(2,"mat-icon",1),a.Tc(3,"signal_cellular_alt"),a.ec(),a.Tc(4," Report "),a.ec(),a.fc(5,"h4"),a.fc(6,"mat-icon",2),a.nc("click",(function(){return e.close()})),a.Tc(7,"close"),a.ec(),a.ec(),a.ec(),a.fc(8,"div",3),a.fc(9,"form",4),a.fc(10,"mat-form-field",5),a.ac(11,"input",6),a.ec(),a.fc(12,"mat-form-field",7),a.fc(13,"mat-label"),a.Tc(14,"Type"),a.ec(),a.fc(15,"mat-select",8),a.nc("ngModelChange",(function(t){return e.selected=t})),a.Sc(16,b,2,2,"mat-option",9),a.ec(),a.ec(),a.fc(17,"mat-form-field",7),a.fc(18,"mat-label"),a.Tc(19,"Format"),a.ec(),a.fc(20,"mat-select",10),a.nc("ngModelChange",(function(t){return e.selected=t})),a.Sc(21,y,2,2,"mat-option",9),a.ec(),a.ec(),a.fc(22,"mat-form-field",7),a.fc(23,"mat-label"),a.Tc(24,"Period"),a.ec(),a.fc(25,"mat-select",11),a.nc("ngModelChange",(function(t){return e.selected=t})),a.Sc(26,_,2,2,"mat-option",9),a.ec(),a.ec(),a.fc(27,"mat-form-field",7),a.fc(28,"mat-label"),a.Tc(29,"Geofences"),a.ec(),a.fc(30,"mat-select",12),a.nc("ngModelChange",(function(t){return e.selected=t})),a.Sc(31,x,2,2,"mat-option",9),a.ec(),a.ec(),a.fc(32,"mat-form-field",7),a.fc(33,"mat-label"),a.Tc(34,"Devices"),a.ec(),a.fc(35,"mat-select",13),a.nc("ngModelChange",(function(t){return e.selected=t})),a.Sc(36,C,2,2,"mat-option",9),a.ec(),a.ec(),a.fc(37,"mat-form-field",7),a.ac(38,"input",14),a.ac(39,"owl-date-time",null,15),a.ec(),a.fc(41,"mat-form-field",7),a.ac(42,"input",16),a.ac(43,"owl-date-time",null,17),a.ec(),a.fc(45,"mat-form-field",7),a.ac(46,"input",18),a.ec(),a.fc(47,"mat-form-field",7),a.ac(48,"input",19),a.ec(),a.fc(49,"mat-form-field",7),a.fc(50,"mat-label"),a.Tc(51,"Stops"),a.ec(),a.fc(52,"mat-select",20),a.nc("ngModelChange",(function(t){return e.selected=t})),a.Sc(53,S,2,2,"mat-option",9),a.ec(),a.ec(),a.ec(),a.fc(54,"button",21),a.nc("click",(function(){return e.generateReport()})),a.Tc(55," Generate "),a.ec(),a.ec()),2&t){const t=a.Gc(40),i=a.Gc(44);a.Ob(9),a.yc("formGroup",e.reportForm),a.Ob(6),a.yc("ngModel",e.selected),a.Ob(1),a.yc("ngForOf",e.types),a.Ob(4),a.yc("ngModel",e.selected),a.Ob(1),a.yc("ngForOf",e.formates),a.Ob(4),a.yc("ngModel",e.selected),a.Ob(1),a.yc("ngForOf",e.periods),a.Ob(4),a.yc("ngModel",e.selected),a.Ob(1),a.yc("ngForOf",e.geofences),a.Ob(4),a.yc("ngModel",e.selected),a.Ob(1),a.yc("ngForOf",e.states),a.Ob(2),a.yc("owlDateTime",t)("owlDateTimeTrigger",t),a.Ob(4),a.yc("owlDateTime",i)("owlDateTimeTrigger",i),a.Ob(10),a.yc("ngModel",e.selected),a.Ob(1),a.yc("ngForOf",e.states)}},directives:[h.a,c.v,c.o,c.g,p.c,d.b,c.c,c.n,c.f,c.t,p.g,m.a,o.l,f.b,f.d,f.a,g.b,v.o],styles:[".tableTitle[_ngcontent-%COMP%]{background-color:#f0f8ff}.full[_ngcontent-%COMP%]{width:90%;margin-left:5%}.half[_ngcontent-%COMP%]{width:42.5%}.half[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{margin-left:5%;float:left}h3[_ngcontent-%COMP%]{margin-right:70%}h4[_ngcontent-%COMP%]{margin-left:5%}.toolsIcon[_ngcontent-%COMP%]{font-size:14px;margin-right:0}.closeIcon[_ngcontent-%COMP%]{font-size:20px;top:20px}h4[_ngcontent-%COMP%]{margin-top:10px;cursor:pointer}"]}),t})();var T=i("pD6V"),O=i("3cRz"),w=i("Ofeh"),M=i("XCAU"),k=i("dNgK"),P=i("XiUz"),I=i("znSr"),A=i("STbY"),D=i("Qu3c"),R=i("+0xr");let F=(()=>{class t{constructor(t,e){this.dialogRef=t,this.dialog=e}ngOnInit(){this.dialogRef.disableClose=!0}close(){this.dialogRef.close()}}return t.\u0275fac=function(e){return new(e||t)(a.Zb(s.f),a.Zb(s.b))},t.\u0275cmp=a.Tb({type:t,selectors:[["app-alert-add"]],decls:8,vars:0,consts:[[1,"table-title"],[1,"toolsIcon"],[1,"closeIcon",3,"click"]],template:function(t,e){1&t&&(a.fc(0,"div",0),a.fc(1,"h3"),a.fc(2,"mat-icon",1),a.Tc(3,"notifications"),a.ec(),a.Tc(4," Add New "),a.ec(),a.fc(5,"h4"),a.fc(6,"mat-icon",2),a.nc("click",(function(){return e.close()})),a.Tc(7,"close"),a.ec(),a.ec(),a.ec())},directives:[h.a],styles:[".tableTitle[_ngcontent-%COMP%]{background-color:#f0f8ff}h3[_ngcontent-%COMP%]{float:left;margin-right:70%}h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%]{margin-left:5%}.toolsIcon[_ngcontent-%COMP%]{font-size:14px;margin-right:0}.closeIcon[_ngcontent-%COMP%]{font-size:20px;top:20px}h4[_ngcontent-%COMP%]{margin-top:10px;cursor:pointer}"]}),t})();var U=i("M5z4"),E=i("wZkO"),B=i("7EHt"),G=i("MutI"),z=i("bSwM"),N=i("Wp6s"),j=i("Xa2L");function q(t,e){if(1&t&&(a.fc(0,"span",53),a.Tc(1),a.sc(2,"number"),a.ec()),2&t){const t=a.rc().$implicit,e=a.rc(2);a.Ob(1),a.Vc("",a.tc(2,1,1.852*(null==e.deviceDataIndex[t.deviceid]?null:e.deviceDataIndex[t.deviceid].speed))," kmh")}}function Z(t,e){1&t&&(a.fc(0,"span",53),a.Tc(1,"0 kmh"),a.ec())}function W(t,e){if(1&t&&(a.fc(0,"div",54),a.Tc(1),a.sc(2,"date"),a.ec()),2&t){const t=a.rc().$implicit,e=a.rc(2);a.Ob(1),a.Vc(" ",a.uc(2,1,null==e.deviceDataIndex[t.deviceid]?null:e.deviceDataIndex[t.deviceid].servertime,"medium")," ")}}const K=function(t,e,i){return{b21:t,b212:e,b321:i}};function V(t,e){if(1&t){const t=a.gc();a.fc(0,"div",42),a.fc(1,"div",42),a.fc(2,"mat-checkbox",43),a.nc("change",(function(i){a.Kc(t);const o=e.$implicit;return a.rc(2).check(i.checked,o)}))("keyup",(function(e){return a.Kc(t),a.rc(2).applyFilter(e.target.value)})),a.ec(),a.fc(3,"span"),a.fc(4,"a",44),a.nc("click",(function(){a.Kc(t);const i=e.$implicit;return a.rc(2).getLocation(i)})),a.Tc(5),a.ec(),a.ec(),a.fc(6,"a",45),a.fc(7,"mat-icon"),a.Tc(8,"more_vert"),a.ec(),a.ec(),a.fc(9,"span",46),a.ac(10,"i",47),a.ec(),a.Sc(11,q,3,3,"span",48),a.Sc(12,Z,2,0,"span",48),a.Sc(13,W,3,4,"div",49),a.fc(14,"mat-menu",50,51),a.fc(16,"button",52),a.Tc(17,"Show history(last hour)"),a.ec(),a.fc(18,"button",52),a.Tc(19,"Show history(today)"),a.ec(),a.fc(20,"button",52),a.Tc(21,"Show history(yesterday)"),a.ec(),a.fc(22,"button",52),a.Tc(23,"Follow"),a.ec(),a.fc(24,"button",52),a.Tc(25,"Send command"),a.ec(),a.fc(26,"button",52),a.Tc(27,"Edit"),a.ec(),a.fc(28,"button",52),a.Tc(29,"Sharing"),a.ec(),a.fc(30,"button",52),a.Tc(31,"Alerts"),a.ec(),a.ec(),a.ec(),a.ec()}if(2&t){const t=e.$implicit,i=a.Gc(15),o=a.rc(2);a.Ob(2),a.yc("checked",o.checkState(t.id)),a.Ob(3),a.Uc(t.name),a.Ob(1),a.yc("matMenuTriggerFor",i),a.Ob(3),a.yc("ngClass",a.Ec(7,K,!(null!=o.deviceDataIndex[t.deviceid]&&o.deviceDataIndex[t.deviceid].speed),(null==o.deviceDataIndex[t.deviceid]?null:o.deviceDataIndex[t.deviceid].speed)>0,0==(null==o.deviceDataIndex[t.deviceid]?null:o.deviceDataIndex[t.deviceid].valid))),a.Ob(2),a.yc("ngIf",t.deviceid),a.Ob(1),a.yc("ngIf",!t.deviceid),a.Ob(1),a.yc("ngIf",o.deviceDataIndex)}}function J(t,e){if(1&t){const t=a.gc();a.fc(0,"div"),a.fc(1,"div",13),a.fc(2,"mat-form-field",14),a.fc(3,"input",39),a.nc("keyup",(function(e){return a.Kc(t),a.rc().applyFilter(e.target.value)})),a.ec(),a.ec(),a.fc(4,"button",16),a.fc(5,"mat-icon"),a.Tc(6,"list"),a.ec(),a.ec(),a.fc(7,"button",16),a.fc(8,"mat-icon"),a.Tc(9,"add"),a.ec(),a.ec(),a.ec(),a.fc(10,"div"),a.fc(11,"mat-accordion"),a.fc(12,"mat-nav-list"),a.fc(13,"mat-expansion-panel",40),a.fc(14,"mat-expansion-panel-header"),a.fc(15,"mat-checkbox",41),a.nc("click",(function(e){return a.Kc(t),e.stopPropagation()}))("keydown",(function(e){return a.Kc(t),e.stopPropagation()}))("change",(function(e){a.Kc(t);const i=a.rc();return i.checkByCustomer(e.checked,i.customer)})),a.Tc(16),a.ec(),a.ec(),a.Sc(17,V,32,11,"div",19),a.ec(),a.ec(),a.ec(),a.ec(),a.ec()}if(2&t){const t=a.rc();a.Ob(3),a.yc("checked",t.box),a.Ob(10),a.yc("expanded",!1),a.Ob(2),a.yc("checked",t.checkStateC(1)),a.Ob(1),a.Vc(" ",null==t.customer[0]?null:t.customer[0].name," "),a.Ob(1),a.yc("ngForOf",t.customerDevices)}}function H(t,e){1&t&&(a.fc(0,"th",67),a.Tc(1,"Time"),a.ec())}function Q(t,e){if(1&t){const t=a.gc();a.fc(0,"td",68),a.fc(1,"a",69),a.nc("click",(function(){a.Kc(t);const i=e.$implicit;return a.rc(2).eventInfo(i)})),a.Tc(2),a.sc(3,"date"),a.ec(),a.ec()}if(2&t){const t=e.$implicit;a.Ob(2),a.Uc(a.uc(3,1,t.eventtime,"medium"))}}function $(t,e){1&t&&(a.fc(0,"th",67),a.Tc(1,"Name"),a.ec())}function X(t,e){if(1&t){const t=a.gc();a.fc(0,"td",68),a.fc(1,"a",69),a.nc("click",(function(){a.Kc(t);const i=e.$implicit;return a.rc(2).eventInfo(i)})),a.Tc(2),a.ec(),a.ec()}if(2&t){const t=a.rc(2);a.Ob(2),a.Uc(null==t.customerDevices[0]?null:t.customerDevices[0].name)}}function Y(t,e){1&t&&(a.fc(0,"th",67),a.Tc(1,"Events"),a.ec())}function tt(t,e){if(1&t){const t=a.gc();a.fc(0,"td",68),a.fc(1,"a",69),a.nc("click",(function(){a.Kc(t);const i=e.$implicit;return a.rc(2).eventInfo(i)})),a.Tc(2),a.ec(),a.ec()}if(2&t){const t=e.$implicit;a.Ob(2),a.Uc(t.type)}}function et(t,e){1&t&&a.ac(0,"th",67)}function it(t,e){if(1&t&&(a.fc(0,"td",68),a.fc(1,"a",70),a.fc(2,"mat-icon"),a.Tc(3,"more_vert"),a.ec(),a.ec(),a.ec()),2&t){a.rc();const t=a.Gc(15);a.Ob(1),a.yc("matMenuTriggerFor",t)}}function ot(t,e){1&t&&a.ac(0,"tr",71)}function nt(t,e){1&t&&a.ac(0,"tr",72)}function st(t,e){if(1&t&&(a.fc(0,"mat-tab",55),a.fc(1,"table",56),a.dc(2,57),a.Sc(3,H,2,0,"th",58),a.Sc(4,Q,4,4,"td",59),a.cc(),a.dc(5,60),a.Sc(6,$,2,0,"th",58),a.Sc(7,X,3,1,"td",59),a.cc(),a.dc(8,61),a.Sc(9,Y,2,0,"th",58),a.Sc(10,tt,3,1,"td",59),a.cc(),a.dc(11,62),a.Sc(12,et,1,0,"th",58),a.Sc(13,it,4,1,"td",59),a.cc(),a.fc(14,"mat-menu",50,51),a.fc(16,"button",63),a.Tc(17,"Alert"),a.ec(),a.fc(18,"button",64),a.Tc(19," Delete "),a.ec(),a.ec(),a.Sc(20,ot,1,0,"tr",65),a.Sc(21,nt,1,0,"tr",66),a.ec(),a.ec()),2&t){const t=a.rc();a.Ob(1),a.yc("dataSource",t.dataEvents),a.Ob(19),a.yc("matHeaderRowDef",t.displayedColumns2),a.Ob(1),a.yc("matRowDefColumns",t.displayedColumns2)}}function rt(t,e){if(1&t&&(a.fc(0,"mat-option",83),a.Tc(1),a.ec()),2&t){const t=e.$implicit;a.yc("value",t.id),a.Ob(1),a.Vc(" ",t.name," ")}}function at(t,e){if(1&t){const t=a.gc();a.fc(0,"div",73),a.fc(1,"form",22),a.fc(2,"mat-form-field",74),a.fc(3,"mat-label"),a.Tc(4,"Device"),a.ec(),a.fc(5,"mat-select",75,76),a.nc("ngModelChange",(function(e){return a.Kc(t),a.rc().selected=e})),a.fc(7,"input",77),a.nc("keyup",(function(e){return a.Kc(t),a.rc().applyFilter(e.target.value)})),a.ec(),a.fc(8,"a",78),a.fc(9,"mat-icon",69),a.nc("click",(function(){return a.Kc(t),a.Gc(6).close()})),a.Tc(10,"clear"),a.ec(),a.ec(),a.Sc(11,rt,2,2,"mat-option",26),a.ec(),a.ec(),a.fc(12,"mat-form-field"),a.ac(13,"input",79),a.ac(14,"owl-date-time",null,80),a.ec(),a.fc(16,"mat-form-field"),a.ac(17,"input",81),a.ac(18,"owl-date-time",null,82),a.ec(),a.ec(),a.fc(20,"button",37),a.nc("click",(function(){return a.Kc(t),a.rc().loadHistory()})),a.Tc(21," Load History "),a.ec(),a.ec()}if(2&t){const t=a.Gc(15),e=a.Gc(19),i=a.rc();a.Ob(1),a.yc("formGroup",i.myform),a.Ob(4),a.yc("ngModel",i.selected),a.Ob(6),a.yc("ngForOf",i.devicesArray),a.Ob(2),a.yc("owlDateTime",t)("owlDateTimeTrigger",t),a.Ob(4),a.yc("owlDateTime",e)("owlDateTimeTrigger",e)}}function ct(t,e){1&t&&(a.fc(0,"mat-card",84),a.ac(1,"mat-progress-spinner",85),a.ec())}function lt(t,e){1&t&&(a.fc(0,"div"),a.Tc(1," No Records Found! "),a.ec())}function ut(t,e){if(1&t){const t=a.gc();a.fc(0,"div",42),a.fc(1,"div",86),a.fc(2,"mat-checkbox",87),a.nc("change",(function(e){a.Kc(t);const i=a.rc();return i.check(e.checked,i.val)})),a.ec(),a.fc(3,"span"),a.fc(4,"a",88),a.Tc(5),a.ec(),a.ec(),a.ec(),a.ec()}if(2&t){const t=e.$implicit;a.Ob(2),a.yc("checked",1),a.Ob(3),a.Uc(t.name)}}function ht(t,e){if(1&t&&(a.fc(0,"mat-option",83),a.Tc(1),a.ec()),2&t){const t=e.$implicit;a.yc("value",t.value),a.Ob(1),a.Vc(" ",t.value," ")}}function pt(t,e){if(1&t){const t=a.gc();a.fc(0,"div",42),a.fc(1,"div",86),a.fc(2,"mat-checkbox",87),a.nc("change",(function(e){a.Kc(t);const i=a.rc();return i.check(e.checked,i.val)})),a.ec(),a.fc(3,"span"),a.fc(4,"a",88),a.Tc(5),a.ec(),a.ec(),a.ec(),a.ec()}if(2&t){const t=e.$implicit;a.Ob(2),a.yc("checked",1),a.Ob(3),a.Uc(t.name)}}function dt(t,e){if(1&t&&(a.fc(0,"mat-option",83),a.Tc(1),a.ec()),2&t){const t=e.$implicit;a.yc("value",t.value),a.Ob(1),a.Vc(" ",t.value," ")}}function mt(t,e){if(1&t){const t=a.gc();a.fc(0,"li",89),a.fc(1,"a",69),a.nc("click",(function(){a.Kc(t);const i=e.$implicit;return a.rc().iconAdding(i.value)})),a.ac(2,"img",90),a.ec(),a.ec()}if(2&t){const t=e.$implicit,i=a.rc();a.yc("ngClass",t.value===i.activeIcon?"active":"none"),a.Ob(2),a.Ac("src","/assets/client/map_icons/",t.value,".png",a.Lc)}}function ft(t,e){1&t&&(a.fc(0,"mat-card",84),a.ac(1,"mat-progress-spinner",85),a.ec())}let gt=(()=>{class t{constructor(t,e,i,o,n,s,r,a,c){this.fb=t,this.route=e,this.customerService=i,this.deviceService=o,this.cusmapService=n,this.dateFormatService=s,this.geofenceService=r,this.ref=a,this.dialog=c,this.deviceCurrentData=[],this.deviceData=[],this.deviceDataIndex=[],this.DeviceItem=[],this.DeviceItemCus=[],this.devicelog=[],this.devicelogMatch=[],this.poiShow=1,this.selectedTabIndex=0,this.pois=[],this.geofences=[],this.act=!0,this.inact=!1,this.activeTab=1,this.activeIcon=1,this.dataSource=new R.k([]),this.dataEvents=new R.k([]),this.categories=[{id:1,value:1},{id:0,value:2},{id:0,value:3},{id:0,value:4},{id:0,value:5}],this.displayedColumns2=["time","device_id","event","more"],this.isLoading=!0}ngOnInit(){this.myform=this.fb.group({id:[],from_date:[""],to_date:[""],status:[""],customer_id:[""],d:[""]}),this.poiForm=this.fb.group({name:[],description:[""],group:[],poi_icon:[],coordinates:[""]}),this.geofenceForm=this.fb.group({name:[],group:[],area:[""]}),this.route.paramMap.subscribe(t=>{this.Id=t.get("id"),this.getCustomerDevices(this.Id)}),this.getAllEvents(),this.cusmapService.deviceDetailsCatch.subscribe(t=>{t&&(this.deviceData=[],this.deviceData.push(t),this.deviceData.forEach((t,e)=>{this.deviceDataIndex[t.deviceid]=this.deviceData[e]}))}),this.cusmapService.poiTabDataCatch.subscribe(t=>{t&&(this.activeTab=0,this.selectedTabIndex=t,this.getAllPoi())}),this.cusmapService.geoTabDataCatch.subscribe(t=>{t&&(this.activeTab=0,this.selectedTabIndex=t,4==t&&this.getAllGeofence())}),this.cusmapService.poiLatLngCatch.subscribe(t=>{t&&(this.poiLatLng=t,console.log(t))})}ngAfterContentChecked(){this.ref.detectChanges()}getCustomerDevices(t){this.customerService.getCustomerByUserId(t).subscribe(t=>{this.customer=t,console.log(this.customer)}),this.customerService.DeviceIdByUser(t).subscribe(t=>{this.isLoading=!1,this.deviceId=t,console.log(t),this.selected=this.deviceId[0].deviceid,console.log(this.selected);var e=[];this.deviceId.forEach(t=>{e.push(t.deviceid)}),this.customerService.DeviceByDeviceId({id:e}).subscribe(t=>{this.devicesArray=t,this.customerDevices=t,t.forEach((t,e)=>{this.devicelog.push(t.id)})}),console.log(this.devicelog)})}objectTab(t){var e=t.index;2==e&&setTimeout(()=>{const t=new Date;var e=new Date(t.getFullYear(),t.getMonth(),t.getDate());this.myform.patchValue({from_date:e,to_date:new Date})},100),0!=e&&1!=e||this.cusmapService.tabIndex({id:1})}applyFilter(t){this.customerDevices=this.customerDevices.filter(e=>e.name.toLowerCase().indexOf(t)>-1)}applyDevices(t){this.customerDevices=this.filterDevices.filter(e=>e.name.toLowerCase().indexOf(t)>-1)}check(t,e){if(t){console.log(e),this.devicelogMatch.push(e.id),console.log(this.devicelogMatch.length),console.log(this.devicelog.length);var i=this.devicelogMatch.length;console.log(i),i===this.devicelog.length&&this.DeviceItemCus.push(1),this.deviceService.getDeviceById(e.id).subscribe(t=>{this.deviceCurrentData=[],console.log(t),this.deviceCurrentData.push(t),this.deviceService.getDevicePositionByPositionId({id:this.deviceCurrentData[0].positionid}).subscribe(e=>{console.log(e),this.deviceDataT=e,this.deviceCurrentData=this.deviceCurrentData.map(t=>Object.assign(t,this.deviceDataT.find(e=>e.deviceid==t.id))),this.customerDevices=this.customerDevices.map(t=>Object.assign(t,this.deviceDataT.find(e=>e.deviceid==t.id))),console.log(t),this.customerDevices.forEach((t,e)=>{console.log("test"),this.deviceDataIndex[t.deviceid]=this.customerDevices[e]}),this.cusmapService.deviceDataExchange(this.deviceCurrentData)})})}else e.deviceid&&(e.id=e.deviceid),console.log(this.devicelogMatch),this.devicelogMatch=this.devicelogMatch.filter(t=>t!==e.id),console.log(this.devicelogMatch),this.DeviceItem=this.DeviceItem.filter(t=>t!==e.id),this.DeviceItemCus=this.DeviceItemCus.filter(t=>1!==t),this.cusmapService.deviceRemove([e])}checkByCustomer(t,e){if(t){this.DeviceItemCus.push(1),console.log(this.devicelog),this.devicelogMatch=this.devicelog;var i={id:this.devicelog};console.log(this.devicelogMatch),console.log(i),this.customerService.DeviceByCustomerUserWithPosition(i).subscribe(t=>{var e=t,i=[];e.forEach((t,e)=>{console.log(t),i.push(t.positionid)}),this.customerService.DevicePositionByPositionId({id:i}).subscribe(t=>{var i=t;console.log(e),console.log(this.customerDevices),this.customerDevices=e.map(t=>Object.assign(t,i.find(e=>e.deviceid==t.id))),console.log(this.customerDevices),this.customerDevices.forEach((t,e)=>{this.DeviceItem.push(t.id)}),this.customerDevices.forEach((t,e)=>{this.deviceDataIndex[t.deviceid]=this.customerDevices[e]}),this.cusmapService.deviceDataExchange(this.customerDevices)})})}else this.customerDevices.forEach(t=>{this.DeviceItem=this.DeviceItem.filter(e=>e!==t.deviceid)}),this.devicelogMatch=[],this.DeviceItemCus=this.DeviceItemCus.filter(t=>1!==t),this.cusmapService.deviceRemove(this.customerDevices)}checkState(t){if(this.customerDevices)return this.DeviceItem.indexOf(t)>-1}checkStateC(t){if(this.customerDevices)return this.DeviceItemCus.indexOf(t)>-1}getAllEvents(){this.deviceService.getAllEvents().subscribe(t=>{this.Events=t,this.dataEvents=new R.k(t)})}loadHistory(){this.isLoading=!0;const t={id:this.myform.value.id,from_date:this.dateFormatService.dateTime("datetime",this.myform.value.from_date),to_date:this.dateFormatService.dateTime("datetime",this.myform.value.to_date)};console.log(this.myform.value),this.deviceService.getHistoryPostionBySearch(t).subscribe(t=>{console.log("test history"),console.log(t),this.historyData=t,this.isLoading=!1,this.cusmapService.deviceHistory(t)})}getLocation(t){t.deviceid&&(t.id=t.deviceid),console.log(t.id),this.deviceService.getDeviceCurrentPositionById(t.id).subscribe(t=>{this.locationData=t,this.cusmapService.deviceLocation(this.locationData),this.cusmapService.detailsDataExchange(this.locationData)})}eventInfo(t){this.deviceService.getEventPositionById(t.id).subscribe(t=>{console.log(t),this.cusmapService.eventExchange(t)})}getAllPoi(){this.deviceService.getAllPois().subscribe(t=>{this.pois=t})}getAllGeofence(){this.geofenceService.getAllGeofence().subscribe(t=>{this.geofences=t})}goPoiAddPage(){this.selectedTabIndex=7,this.cusmapService.poiDrawExchange(1)}addPoi(){this.cusmapService.poiDrawExchange(0),this.poiForm.value.coordinates={lat:this.poiLatLng.lat,lng:this.poiLatLng.lng},this.poiForm.value.poi_icon=this.activeIcon,this.userData=JSON.parse(localStorage.getItem("userData")),this.poiForm.value.created_by=1,this.deviceService.addPois(this.poiForm.value).subscribe(t=>{this.getAllPoi(),this.selectedTabIndex=6})}goAfterPoiList(){this.getAllPoi(),this.selectedTabIndex=6,this.cusmapService.poiDrawExchange(0)}object(){this.activeTab=1,this.selectedTabIndex=0,this.cusmapService.poiDrawExchange(0)}event(){this.activeTab=2,this.selectedTabIndex=1,this.cusmapService.poiDrawExchange(0)}history(){this.activeTab=3,this.selectedTabIndex=2,this.cusmapService.poiDrawExchange(0)}iconAdding(t){this.cusmapService.poiDrawExchange(t),this.activeIcon=t}geofenceAdd(){this.selectedTabIndex=5}openAlertModal(){const t=new s.d;t.disableClose=!0,t.width="800px",t.height="580px",this.dialog.open(F,{width:"800px",height:"560px"}).afterClosed().subscribe(t=>{})}}return t.\u0275fac=function(e){return new(e||t)(a.Zb(c.e),a.Zb(n.a),a.Zb(U.a),a.Zb(M.a),a.Zb(O.a),a.Zb(u.a),a.Zb(l.a),a.Zb(a.i),a.Zb(s.b))},t.\u0275cmp=a.Tb({type:t,selectors:[["app-side-menu"]],decls:102,vars:17,consts:[[1,"container"],["fxLayout","row",1,"menu"],["fxFlex","33%","color","primary",1,"btn-block",3,"ngClass","click"],[1,"content"],[1,"tabs",3,"selectedIndex","selectedIndexChange","selectedTabChange"],["allTabs",""],["label","Objects"],[4,"ngIf"],["label","Events",4,"ngIf"],["label","History"],["class","historytab",4,"ngIf"],["style","display:flex; justify-content: center; align-items: center",4,"ngIf"],["label","Alerts",1,"tabhide"],[1,"search-div"],[1,"filter"],["matInput","","placeholder","search","autocomplete","off",3,"keyup"],[1,"btn"],[1,"btn",3,"click"],["label","Geogence",1,"tabhide"],["class","item",4,"ngFor","ngForOf"],["label","Geofence Add"],[1,"poiInsertInfo"],[3,"formGroup"],[1,"poiField"],["matInput","","placeholder","Name","formControlName","name","autocomplete","off","required",""],["formControlName","group"],[3,"value",4,"ngFor","ngForOf"],[1,"action_div"],["mat-raised-button","","color","primary",1,"btn-block"],[1,"cancel_span"],["mat-stroked-button","","color","primary",1,"btn-block"],["label","Poi",1,"tabhide"],["label","Poi Add"],["matInput","","placeholder","Description","formControlName","description","autocomplete","off"],[1,"mapicon"],[1,"poiiconlabel"],[3,"ngClass",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",1,"btn-block",3,"click"],["mat-stroked-button","","color","primary",1,"btn-block",3,"click"],["matInput","","placeholder","search","autocomplete","off",3,"checked","keyup"],[1,"space",2,"clear","both",3,"expanded"],[3,"checked","click","keydown","change"],[1,"item"],[1,"name",3,"checked","change","keyup"],[1,"devicename",3,"click"],[1,"b2",3,"matMenuTriggerFor"],[1,"b21",3,"ngClass"],["aria-hidden","true",1,"fa","fa-circle"],["class","b213",4,"ngIf"],["class","movingtime",4,"ngIf"],[1,"dropdown-content"],["hospital","matMenu"],["mat-menu-item","","routerLink","/",1,"menubt"],[1,"b213"],[1,"movingtime"],["label","Events"],["mat-table","","matTableExporter","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","time"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","device_id"],["matColumnDef","event"],["matColumnDef","more"],["mat-menu-item","","routerLink","/"],["mat-menu-item","","routerLink","info/map"],["class","header-row","mat-header-row","",4,"matHeaderRowDef"],["class","row","mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"click"],[3,"matMenuTriggerFor"],["mat-header-row","",1,"header-row"],["mat-row","",1,"row"],[1,"historytab"],[1,"half"],["formControlName","id",3,"ngModel","ngModelChange"],["sl",""],["matInput","","placeholder","search","autocomplete","off",1,"filterBox",3,"keyup"],[1,"closeButton"],["matInput","","formControlName","from_date","placeholder","From Time",3,"owlDateTime","owlDateTimeTrigger"],["dt1",""],["matInput","","formControlName","to_date","placeholder","To Time",3,"owlDateTime","owlDateTimeTrigger"],["dt2",""],[3,"value"],[2,"display","flex","justify-content","center","align-items","center"],["color","primary","mode","indeterminate"],[1,"poiItem"],[3,"checked","change"],[1,"poiName"],[3,"ngClass"],[3,"src"]],template:function(t,e){1&t&&(a.fc(0,"div",0),a.fc(1,"div",1),a.fc(2,"ul"),a.fc(3,"li",2),a.nc("click",(function(){return e.object()})),a.fc(4,"a"),a.Tc(5," Objects"),a.ec(),a.ec(),a.fc(6,"li",2),a.nc("click",(function(){return e.event()})),a.fc(7,"a"),a.Tc(8,"Events"),a.ec(),a.ec(),a.fc(9,"li",2),a.nc("click",(function(){return e.history()})),a.fc(10,"a"),a.Tc(11,"History"),a.ec(),a.ec(),a.ec(),a.ec(),a.fc(12,"div",3),a.fc(13,"mat-tab-group",4,5),a.nc("selectedIndexChange",(function(t){return e.selectedTabIndex=t}))("selectedTabChange",(function(t){return e.objectTab(t)})),a.fc(15,"mat-tab",6),a.Sc(16,J,18,5,"div",7),a.ec(),a.Sc(17,st,22,3,"mat-tab",8),a.fc(18,"mat-tab",9),a.Sc(19,at,22,7,"div",10),a.fc(20,"div"),a.Sc(21,ct,2,0,"mat-card",11),a.ec(),a.Sc(22,lt,2,0,"div",7),a.ec(),a.fc(23,"mat-tab",12),a.fc(24,"div",13),a.fc(25,"mat-form-field",14),a.fc(26,"input",15),a.nc("keyup",(function(t){return e.applyFilter(t.target.value)})),a.ec(),a.ec(),a.fc(27,"button",16),a.fc(28,"mat-icon"),a.Tc(29,"list"),a.ec(),a.ec(),a.fc(30,"a"),a.fc(31,"button",17),a.nc("click",(function(){return e.openAlertModal()})),a.fc(32,"mat-icon"),a.Tc(33,"add"),a.ec(),a.ec(),a.ec(),a.ec(),a.ec(),a.fc(34,"mat-tab",18),a.fc(35,"div",13),a.fc(36,"mat-form-field",14),a.fc(37,"input",15),a.nc("keyup",(function(t){return e.applyFilter(t.target.value)})),a.ec(),a.ec(),a.fc(38,"button",16),a.fc(39,"mat-icon"),a.Tc(40,"list"),a.ec(),a.ec(),a.fc(41,"a"),a.fc(42,"button",17),a.nc("click",(function(){return e.geofenceAdd()})),a.fc(43,"mat-icon"),a.Tc(44,"add"),a.ec(),a.ec(),a.ec(),a.ec(),a.Sc(45,ut,6,2,"div",19),a.ec(),a.fc(46,"mat-tab",20),a.fc(47,"div",21),a.fc(48,"p"),a.Tc(49,"Please draw geofence on map"),a.ec(),a.ec(),a.fc(50,"form",22),a.fc(51,"mat-form-field",23),a.ac(52,"input",24),a.ec(),a.fc(53,"mat-form-field",23),a.fc(54,"mat-label"),a.Tc(55,"Group"),a.ec(),a.fc(56,"mat-select",25),a.Sc(57,ht,2,2,"mat-option",26),a.ec(),a.ec(),a.ec(),a.fc(58,"div",27),a.fc(59,"button",28),a.Tc(60," Save "),a.ec(),a.ac(61,"span",29),a.fc(62,"button",30),a.Tc(63," Cancel "),a.ec(),a.ec(),a.ec(),a.fc(64,"mat-tab",31),a.fc(65,"div",13),a.fc(66,"mat-form-field",14),a.fc(67,"input",15),a.nc("keyup",(function(t){return e.applyFilter(t.target.value)})),a.ec(),a.ec(),a.fc(68,"button",16),a.fc(69,"mat-icon"),a.Tc(70,"list"),a.ec(),a.ec(),a.fc(71,"a"),a.fc(72,"button",17),a.nc("click",(function(){return e.goPoiAddPage()})),a.fc(73,"mat-icon"),a.Tc(74,"add"),a.ec(),a.ec(),a.ec(),a.ec(),a.Sc(75,pt,6,2,"div",19),a.ec(),a.fc(76,"mat-tab",32),a.fc(77,"div",21),a.fc(78,"p"),a.Tc(79,"Please click on map to place the marker"),a.ec(),a.ec(),a.fc(80,"form",22),a.fc(81,"mat-form-field",23),a.ac(82,"input",24),a.ec(),a.fc(83,"mat-form-field",23),a.ac(84,"textarea",33),a.ec(),a.fc(85,"mat-form-field",23),a.fc(86,"mat-label"),a.Tc(87,"Group"),a.ec(),a.fc(88,"mat-select",25),a.Sc(89,dt,2,2,"mat-option",26),a.ec(),a.ec(),a.fc(90,"div",34),a.fc(91,"mat-label",35),a.Tc(92,"Marker Icon"),a.ec(),a.fc(93,"ul"),a.Sc(94,mt,3,2,"li",36),a.ec(),a.ec(),a.ec(),a.fc(95,"div",27),a.fc(96,"button",37),a.nc("click",(function(){return e.addPoi()})),a.Tc(97," Save "),a.ec(),a.ac(98,"span",29),a.fc(99,"button",38),a.nc("click",(function(){return e.goAfterPoiList()})),a.Tc(100," Cancel "),a.ec(),a.ec(),a.ec(),a.ec(),a.ec(),a.ec(),a.Sc(101,ft,2,0,"mat-card",11)),2&t&&(a.Ob(3),a.yc("ngClass",1===e.activeTab?"active":"none"),a.Ob(3),a.yc("ngClass",2===e.activeTab?"active":"none"),a.Ob(3),a.yc("ngClass",3===e.activeTab?"active":"none"),a.Ob(4),a.yc("selectedIndex",e.selectedTabIndex),a.Ob(3),a.yc("ngIf",e.customerDevices),a.Ob(1),a.yc("ngIf",e.customerDevices),a.Ob(2),a.yc("ngIf",e.customerDevices),a.Ob(2),a.yc("ngIf",e.isLoading),a.Ob(1),a.yc("ngIf",""==e.historyData),a.Ob(23),a.yc("ngForOf",e.geofences),a.Ob(5),a.yc("formGroup",e.geofenceForm),a.Ob(7),a.yc("ngForOf",e.categories),a.Ob(18),a.yc("ngForOf",e.pois),a.Ob(5),a.yc("formGroup",e.poiForm),a.Ob(9),a.yc("ngForOf",e.categories),a.Ob(5),a.yc("ngForOf",e.categories),a.Ob(7),a.yc("ngIf",e.isLoading))},directives:[P.b,P.a,o.k,I.a,E.b,E.a,o.m,p.c,d.b,h.a,o.l,c.v,c.o,c.g,c.c,c.n,c.f,c.t,p.g,m.a,g.b,B.a,G.d,B.c,B.d,z.a,A.c,A.d,A.a,n.d,R.j,R.c,R.e,R.b,R.g,R.i,R.d,R.a,R.f,R.h,f.b,f.d,f.a,v.o,N.a,j.a],pipes:[o.f,o.e],styles:[".container[_ngcontent-%COMP%]{width:100%}table[_ngcontent-%COMP%]{width:95%!important} .mat-tab-label,  .mat-tab-label-active{min-width:0!important;padding:10px!important;margin:10px!important}.filter[_ngcontent-%COMP%]{margin-left:5px!important}.btn[_ngcontent-%COMP%]{width:40px!important;margin-top:5px;border:0;background-color:#2c82d8;margin-left:5px}.mat-header-cell[_ngcontent-%COMP%]{height:10px!important}.mat-column-select[_ngcontent-%COMP%]{width:20%!important}.mat-column-name[_ngcontent-%COMP%]{width:50%!important}.mat-column-identifier[_ngcontent-%COMP%]{width:20%!important}.mat-column-more[_ngcontent-%COMP%]{width:10%!important}a[_ngcontent-%COMP%]{cursor:pointer}mat-menu[_ngcontent-%COMP%]{margin-left:50px!important;position:absolute}.dropdown-content[_ngcontent-%COMP%]{display:none;position:absolute;background-color:#f9f9f9;min-width:160px;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);z-index:20}.cdk-overlay-container[_ngcontent-%COMP%]{position:fixed!important;z-index:3000!important}.filterBox[_ngcontent-%COMP%]{width:150px;height:25px;margin-left:10px;margin-top:5px;margin-bottom:5px;border-radius:10px 10px 10px 10px;border:2px solid #000}.closeButton[_ngcontent-%COMP%]{margin-top:20px}.space[_ngcontent-%COMP%]{margin-bottom:2px}.group[_ngcontent-%COMP%]{font-size:14px;font-weight:500}.item[_ngcontent-%COMP%]{margin-bottom:10px;margin-right:2px}.b1[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]{font-size:12px}.b1[_ngcontent-%COMP%]{margin-left:20%}.devicename[_ngcontent-%COMP%]{margin-left:20px}.clock[_ngcontent-%COMP%]{width:70%!important}.b2[_ngcontent-%COMP%]{float:right;flex:1 1 auto;color:#0078a8!important}.b21[_ngcontent-%COMP%]{color:#ff0!important}.b21[_ngcontent-%COMP%], .b212[_ngcontent-%COMP%]{float:right;width:10px;flex:1 1 auto}.b212[_ngcontent-%COMP%]{color:#034a10!important}.b213[_ngcontent-%COMP%]{margin-right:3px}.b213[_ngcontent-%COMP%], .b321[_ngcontent-%COMP%]{float:right;flex:1 1 auto}.b321[_ngcontent-%COMP%]{width:10px;color:red!important}.movingtime[_ngcontent-%COMP%]{font-size:9px}.historytab[_ngcontent-%COMP%], .movingtime[_ngcontent-%COMP%]{margin-left:10%}.menubt[_ngcontent-%COMP%]{line-height:0;font-size:12px;height:30px}.tabhide[_ngcontent-%COMP%]{display:none!important} .mat-tab-label-History{width:0!important}.mat-tab-header-pagination[_ngcontent-%COMP%]{display:none}.poiItem[_ngcontent-%COMP%]{margin-top:10px;margin-left:20px;font-size:14px}.poiName[_ngcontent-%COMP%]{margin-left:10px}  .tabs .mat-tab-list .mat-tab-labels{display:none}.poiField[_ngcontent-%COMP%]{width:80%;margin-left:10%}.poiInsertInfo[_ngcontent-%COMP%]{height:40px;margin-top:3%;margin-left:5%;margin-right:5%;background-color:#d9edf7}.poiInsertInfo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;padding-top:10px;font-size:14px;color:#31708f}.option_icon[_ngcontent-%COMP%]{width:25%;display:inline}.action_div[_ngcontent-%COMP%]{margin-top:5%}.action_div[_ngcontent-%COMP%], .cancel_span[_ngcontent-%COMP%]{margin-left:10%}.content[_ngcontent-%COMP%]{width:100%}ul[_ngcontent-%COMP%]{list-style-type:none;margin:0;padding:0;overflow:hidden;background-color:#eee}li[_ngcontent-%COMP%]{float:left}li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;color:#000;text-align:center;padding:12px 31.5px;text-decoration:none}li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:not(.active){background-color:#fff}li[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]:after{color:#2c82d8;background-color:#04aa6d}.mapicon[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style-type:none;margin:0;padding:0;overflow:hidden;background-color:#eee}.mapicon[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;color:#000;text-align:center;padding:12px 14.5px;text-decoration:none}.mapicon[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.ative[_ngcontent-%COMP%]:after{background-color:#2cd8d8}.active[_ngcontent-%COMP%]{color:#2cd8d8!important;background-color:#fff}.inactiveTab[_ngcontent-%COMP%]{color:#000;background-color:eee}.poiiconlabel[_ngcontent-%COMP%]{margin-left:10%;color:#555;margin-bottom:5%}.btn[_ngcontent-%COMP%]{cursor:pointer}"]}),t})();i("Bn1M");var vt=i("zkoq");function bt(t,e){1&t&&(a.fc(0,"h3",11),a.fc(1,"mat-icon"),a.Tc(2,"near_me"),a.ec(),a.Tc(3,"Name"),a.ec())}function yt(t,e){if(1&t&&(a.fc(0,"h3",11),a.fc(1,"mat-icon"),a.Tc(2,"near_me"),a.ec(),a.Tc(3),a.fc(4,"span",15),a.ac(5,"i",16),a.Tc(6,"Active"),a.ec(),a.ec()),2&t){const t=a.rc();a.Ob(3),a.Vc("",null==t.deviceName?null:t.deviceName.name," ")}}function _t(t,e){if(1&t){const t=a.gc();a.fc(0,"a",17),a.fc(1,"mat-icon",18),a.nc("click",(function(){a.Kc(t);const e=a.rc();return e.findLocation(e.deviceData)})),a.Tc(2,"visibility"),a.ec(),a.ec()}if(2&t){const t=a.rc();a.zc("href",t.url,a.Lc)}}let xt=(()=>{class t{constructor(t){this.cusmapService=t,this.link="http://www.google.com/maps/place/"}ngOnInit(){this.map=r.map("mapidd",{center:[23.774252395907105,90.41607082790188],zoom:17,zoomControl:!1,attributionControl:!1}),r.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(this.map),console.log(this.url),this.cusmapService.detailsDataCatch.subscribe(t=>{if(t){this.deviceId=t[0].deviceid;var e={lat:t[0].latitude,lng:t[0].longitude};r.Control.Geocoder.nominatim().reverse(e,this.map.options.crs.scale(this.map.getZoom()),t=>{t[0]&&(this.address=t[0].name)}),this.url=this.link+t.latitude+","+t.longitude,this.deviceData=t[0],this.deviceName=t[0],this.attribute=JSON.parse(this.deviceData.attributes)}}),this.cusmapService.deviceDetailsCatch.subscribe(t=>{if(t&&t.deviceid==this.deviceId){var e={lat:t.latitude,lng:t.longitude};r.Control.Geocoder.nominatim().reverse(e,this.map.options.crs.scale(this.map.getZoom()),t=>{t[0]&&(this.address=t[0].name)}),this.url=this.link+t.latitude+","+t.longitude,this.deviceData=t,this.attribute=JSON.parse(this.deviceData.attributes)}})}findLocation(t){}}return t.\u0275fac=function(e){return new(e||t)(a.Zb(O.a))},t.\u0275cmp=a.Tb({type:t,selectors:[["app-bottom-details"]],decls:128,vars:21,consts:[["fxLayout","row",1,"container"],["id","mapidd"],["fxFlex","30%"],[1,"heading"],["class","deviceName",4,"ngIf"],["cols","1","rowHeight","20px"],[1,"pos"],[1,"mag"],["target","_blank",3,"href",4,"ngIf"],[1,"vertical"],["fxFlex","70%"],[1,"deviceName"],["cols","3","rowHeight","20px"],[1,"mag2"],["fxFlex","15%"],[1,"status"],["aria-hidden","true",1,"fa","fa-circle"],["target","_blank",3,"href"],[1,"eyeicon",3,"click"]],template:function(t,e){1&t&&(a.fc(0,"div",0),a.ac(1,"div",1),a.fc(2,"div",2),a.fc(3,"div",3),a.Sc(4,bt,4,0,"h3",4),a.Sc(5,yt,7,1,"h3",4),a.ec(),a.ac(6,"hr"),a.fc(7,"mat-grid-list",5),a.fc(8,"mat-grid-tile",6),a.fc(9,"mat-label",7),a.fc(10,"b"),a.Tc(11," Address: "),a.ec(),a.ec(),a.Tc(12),a.sc(13,"slice"),a.Sc(14,_t,3,1,"a",8),a.ec(),a.fc(15,"mat-grid-tile",6),a.fc(16,"mat-label",7),a.fc(17,"b"),a.Tc(18," Time:"),a.ec(),a.ec(),a.Tc(19),a.sc(20,"date"),a.ec(),a.fc(21,"mat-grid-tile",6),a.fc(22,"mat-label",7),a.fc(23,"b"),a.Tc(24," Stop Duration:"),a.ec(),a.ec(),a.ec(),a.fc(25,"mat-grid-tile",6),a.fc(26,"mat-label",7),a.fc(27,"b"),a.Tc(28," Driver:"),a.ec(),a.ec(),a.ec(),a.ec(),a.ec(),a.ac(29,"div",9),a.fc(30,"div",10),a.fc(31,"h3",11),a.fc(32,"mat-icon"),a.Tc(33,"sensors"),a.ec(),a.Tc(34,"Sensor"),a.ec(),a.ac(35,"hr"),a.fc(36,"mat-grid-list",12),a.fc(37,"mat-grid-tile"),a.fc(38,"mat-icon"),a.Tc(39,"tag"),a.ec(),a.fc(40,"mat-label",13),a.fc(41,"b"),a.Tc(42,"Alert:"),a.ec(),a.ec(),a.Tc(43),a.ec(),a.fc(44,"mat-grid-tile"),a.fc(45,"mat-icon"),a.Tc(46,"slow_motion_video"),a.ec(),a.fc(47,"mat-label",13),a.fc(48,"b"),a.Tc(49," Motion:"),a.ec(),a.ec(),a.Tc(50),a.ec(),a.fc(51,"mat-grid-tile"),a.fc(52,"mat-icon"),a.Tc(53,"vpn_key"),a.ec(),a.fc(54,"mat-label",13),a.fc(55,"b"),a.Tc(56," Ignition:"),a.ec(),a.ec(),a.Tc(57),a.ec(),a.fc(58,"mat-grid-tile"),a.fc(59,"mat-icon"),a.Tc(60,"signal_cellular_alt"),a.ec(),a.fc(61,"mat-label",13),a.fc(62,"b"),a.Tc(63," GSM:"),a.ec(),a.ec(),a.Tc(64),a.ec(),a.fc(65,"mat-grid-tile"),a.fc(66,"mat-icon"),a.Tc(67,"battery_charging_full"),a.ec(),a.fc(68,"mat-label",13),a.fc(69,"b"),a.Tc(70," Battery Level:"),a.ec(),a.ec(),a.Tc(71),a.ec(),a.fc(72,"mat-grid-tile"),a.fc(73,"mat-icon"),a.Tc(74,"invert_colors"),a.ec(),a.fc(75,"mat-label",13),a.fc(76,"b"),a.Tc(77," Route Color:"),a.ec(),a.ec(),a.Tc(78," On "),a.ec(),a.fc(79,"mat-grid-tile"),a.fc(80,"mat-icon"),a.Tc(81,"satellite"),a.ec(),a.fc(82,"mat-label",13),a.fc(83,"b"),a.Tc(84," Satellite:"),a.ec(),a.ec(),a.Tc(85),a.ec(),a.fc(86,"mat-grid-tile"),a.fc(87,"mat-icon"),a.Tc(88,"villa"),a.ec(),a.fc(89,"mat-label",13),a.fc(90,"b"),a.Tc(91,"Doors:"),a.ec(),a.ec(),a.Tc(92," Opened "),a.ec(),a.fc(93,"mat-grid-tile"),a.fc(94,"mat-icon"),a.Tc(95,"drag_handle"),a.ec(),a.fc(96,"mat-label"),a.fc(97,"b"),a.Tc(98,"Distance:"),a.ec(),a.ec(),a.Tc(99," Opened "),a.ec(),a.fc(100,"mat-grid-tile"),a.fc(101,"mat-icon"),a.Tc(102,"moped"),a.ec(),a.fc(103,"mat-label",13),a.fc(104,"b"),a.Tc(105," Engin Hours:"),a.ec(),a.ec(),a.Tc(106),a.ec(),a.fc(107,"mat-grid-tile"),a.fc(108,"mat-icon"),a.Tc(109,"battery_saver"),a.ec(),a.fc(110,"mat-label"),a.fc(111,"b"),a.Tc(112," Battery Charging:"),a.ec(),a.ec(),a.Tc(113),a.ec(),a.fc(114,"mat-grid-tile"),a.fc(115,"mat-icon"),a.Tc(116,"speed"),a.ec(),a.fc(117,"mat-label",13),a.fc(118,"b"),a.Tc(119," Speed:"),a.ec(),a.ec(),a.Tc(120),a.ec(),a.ec(),a.ec(),a.ac(121,"div",9),a.fc(122,"div",14),a.fc(123,"h3",11),a.fc(124,"mat-icon"),a.Tc(125,"settings"),a.ec(),a.Tc(126,"Services"),a.ec(),a.ac(127,"hr"),a.ec(),a.ec()),2&t&&(a.Ob(4),a.yc("ngIf",!e.deviceData),a.Ob(1),a.yc("ngIf",e.deviceData),a.Ob(7),a.Vc(" ",(null==e.address?null:e.address.length)>20?a.vc(13,14,e.address,0,20)+"..":e.address," "),a.Ob(2),a.yc("ngIf",e.address),a.Ob(5),a.Vc(" ",a.uc(20,18,null==e.deviceData?null:e.deviceData.servertime,"medium")," "),a.Ob(24),a.Vc(" ",null==e.deviceData?null:e.deviceData.contact," "),a.Ob(7),a.Vc(" ",null==e.attribute?null:e.attribute.motion," "),a.Ob(7),a.Vc(" ",null==e.attribute?null:e.attribute.ignition," "),a.Ob(7),a.Vc(" ",null==e.deviceData?null:e.deviceData.speed," "),a.Ob(7),a.Vc(" ",null==e.attribute?null:e.attribute.batteryLevel," "),a.Ob(14),a.Vc(" ",null==e.attribute?null:e.attribute.sat," "),a.Ob(21),a.Vc(" ",null==e.deviceData?null:e.deviceData.speed," "),a.Ob(7),a.Vc(" ",null==e.deviceData?null:e.deviceData.model," "),a.Ob(7),a.Vc(" ",null==e.attribute?null:e.attribute.speed," "))},directives:[P.b,P.a,o.m,vt.a,vt.c,p.g,h.a],pipes:[o.t,o.e],styles:[".container[_ngcontent-%COMP%]{width:100%;background-color:#fff;overflow:auto}.f[_ngcontent-%COMP%]{width:30%;float:left}.f[_ngcontent-%COMP%], .s[_ngcontent-%COMP%]{height:100%;background-color:#deb887}.s[_ngcontent-%COMP%]{width:70%!important}.vertical[_ngcontent-%COMP%]{width:3px;background-color:grey}.pos[_ngcontent-%COMP%] >   figure, mat-grid-tile[_ngcontent-%COMP%]  figure{justify-content:flex-start!important}.mag[_ngcontent-%COMP%]{margin-right:15%}.mag2[_ngcontent-%COMP%]{margin-right:5%}.eyeicon[_ngcontent-%COMP%]{margin-left:3%}.deviceName[_ngcontent-%COMP%]{text-align:left}.status[_ngcontent-%COMP%]{font-size:small;float:right}"]}),t})(),Ct=(()=>{class t{constructor(t,e){this.cusmapService=t,this.fb=e,this.speedControl=[{value:1},{value:2},{value:3},{value:4},{value:5},{value:6}],this.selected=1}ngOnInit(){this.myform=this.fb.group({motion:[]})}start(){this.cusmapService.deviceMove({id:100})}stop(){this.cusmapService.motionStop({id:103})}toggle(){console.log("toggle"),this.cusmapService.deviceToggle({id:101})}onChange(t){this.cusmapService.motionControl(t)}}return t.\u0275fac=function(e){return new(e||t)(a.Zb(O.a),a.Zb(c.e))},t.\u0275cmp=a.Tb({type:t,selectors:[["app-history-info"]],decls:15,vars:0,consts:[[1,"container"],["label","Speed"],[1,"top_margin"],[1,"a"],[3,"click"],["label","Altitude"],["label","GSM"],["label","Battery"],["label","Ignition"]],template:function(t,e){1&t&&(a.fc(0,"div",0),a.fc(1,"mat-tab-group"),a.fc(2,"mat-tab",1),a.fc(3,"div",2),a.fc(4,"a",3),a.fc(5,"mat-icon",4),a.nc("click",(function(){return e.start()})),a.Tc(6,"play_arrow"),a.ec(),a.ec(),a.fc(7,"a",3),a.fc(8,"mat-icon",4),a.nc("click",(function(){return e.toggle()})),a.Tc(9,"pause"),a.ec(),a.ec(),a.ec(),a.ac(10,"div"),a.ec(),a.ac(11,"mat-tab",5),a.ac(12,"mat-tab",6),a.ac(13,"mat-tab",7),a.ac(14,"mat-tab",8),a.ec(),a.ec())},directives:[E.b,E.a,h.a],styles:[".container[_ngcontent-%COMP%]{width:100%}.a[_ngcontent-%COMP%]{float:left}.space[_ngcontent-%COMP%]{width:20%}"]}),t})();function St(t,e){if(1&t&&(a.fc(0,"div",31),a.fc(1,"a",32),a.ac(2,"img",33),a.ac(3,"span",34),a.ec(),a.ec()),2&t){a.rc();const t=a.Gc(17);a.Ob(1),a.yc("matMenuTriggerFor",t)}}function Lt(t,e){if(1&t&&(a.fc(0,"a",7),a.fc(1,"mat-icon",35),a.Tc(2,"person_outline"),a.ec(),a.ac(3,"span",34),a.ec()),2&t){a.rc();const t=a.Gc(40);a.yc("matMenuTriggerFor",t)}}const Tt=function(t,e){return{show:t,hide:e}},Ot=function(t,e){return{geofenceActive:t,geofenceInactive:e}},wt=function(t,e){return{poiActive:t,poiInactive:e}},Mt=function(t,e){return{tailActive:t,tailInactive:e}},kt=[{path:"info/:id",component:(()=>{class t{constructor(t,e,i,o,n,s,r,a,c){this.mediaObserver=t,this.cusmapService=e,this.loginService=i,this.routing=o,this.deviceService=n,this.dateFormatService=s,this.geofenceService=r,this.snackBar=a,this.dialog=c,this.address="bangladesh",this.devices=[],this.marker=[],this.markerArray=[],this.engineArray=[],this.parkArray=[],this.storeLatlng=[],this.timeArray=[],this.fixtimeArray=[],this.deviceIdArray=[],this.line=[],this.setIntervalOption=0,this.polyline=[],this.s=!0,this.h=!1,this.poiActive=!1,this.poiInactive=!0,this.poiStatus=1,this.geoActive=!1,this.geoInactive=!0,this.geoStatus=1,this.tailActive=!1,this.tailInactive=!0,this.str="1",this.getStrMap=[],this.getStrMapF=[],this.checkValue=1,this.poiIcon=1,this.poiSetStatus=0}ngOnInit(){this.mediaSub=this.mediaObserver.media$.subscribe(t=>{this.deviceXs="xs"===t.mqAlias}),this.myIcon=r.icon({iconUrl:"./assets/client/images/bike.png",iconSize:[30,60],iconAnchor:[12,39],color:"green",className:"icon"}),this.myIcon2=r.icon({iconUrl:"./assets/client/images/car2.png",iconSize:[40,50],iconAnchor:[12,39],color:"green",className:"icon"}),this.myIcon3=r.icon({iconUrl:"./assets/client/images/car.png",iconSize:[30,50],iconAnchor:[15,33],color:"green",className:"icon",markerColor:"red"}),this.myIcon3_online=r.icon({iconUrl:"./assets/client/images/car_online.png",iconSize:[30,50],iconAnchor:[15,33],color:"green",className:"icon",markerColor:"red"}),this.myIcon4=r.icon({iconUrl:"./assets/client/images/zip.png",iconAnchor:[25,63],color:"green",markerColor:"red",className:"u-turn-icon"}),this.myIcon4_online=r.icon({iconUrl:"./assets/client/images/zip_online.png",iconAnchor:[25,63],color:"green",markerColor:"red",className:"u-turn-icon"}),this.map=r.map("mapid",{center:[23.774252395907105,90.41607082790188],zoom:17,zoomControl:!1,attributionControl:!1});var t=r.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(this.map),e=r.tileLayer("http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{center:[33.590241,130.421222],maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]}),i=r.tileLayer("https://{s}.google.com/vt/lyrs=m@221097413,traffic&x={x}&y={y}&z={z}",{center:[33.590241,130.421222],maxZoom:20,subdomains:["mt1","mt2","mt3"]}),o=(t.addTo(this.map),r.layerGroup(this.markerArray),r.layerGroup().addTo(this.map)),n=r.layerGroup().addTo(this.map);r.layerGroup().addTo(this.map),this.baseMaps={OSM:t,"Google Map":e},this.overlayMaps={Objects:o,Tails:n},this.deviceService.getMovingPosition({id:1}).subscribe(t=>{});var s=r.control.layers(this.baseMaps,this.overlayMaps).addTo(this.map);this.cusmapService.poiDrawCatch.subscribe(t=>{var e,i=t,n=this.cusmapService;console.log(t,this.poiSetStatus),t&&this.poiSetStatus?this.map.on("click",(function(t){this.myIcon4=r.icon({iconUrl:`./assets/client/map_icons/${i}.png`,color:"green",className:"icon"}),e&&o.removeLayer(e),(e=r.marker([t.latlng.lat,t.latlng.lng],{icon:this.myIcon4})).addTo(o),n.poiLatLngExchange(t.latlng)})):this.map.off("click")}),this.map.on("baselayerchange",(function(t){"Google Map"==t.name?s.addOverlay(i,"Traffic"):s.removeLayer(i),console.log("Layer name -> ",t.name),console.log("Layer URL -> ",t.layer.options.url),console.log("Layer attribution -> ",t.layer.options.attribution)}));var a=r.control.sidebar("sidebar").addTo(this.map);a.show(),r.easyButton("fa-exchange",(function(t,e){a.toggle()})).addTo(this.map);var c=r.control.bar("menu",{position:"bottom",visible:!1}).addTo(this.map);c.hide(),r.easyButton("fa-exchange",(function(t,e){c.toggle()}),{position:"bottomright"}).addTo(this.map),this.historyBar=r.control.bar("history",{position:"bottom",visible:!1}).addTo(this.map);var l=[];this.cusmapService.deviceDataCatch.subscribe(t=>{t&&(console.log(t),clearInterval(this.myInterval),this.check=1,this.deviceIdArray.includes(t[0].deviceid)||(this.deviceIdArray.push(t[0].deviceid),this.polyline[t[0].deviceid]=r.polyline([]).addTo(this.map),this.fixtime||(console.log("11111"),this.fixtime="2020-08-18T05:42:11.000Z",this.fixtime=this.dateFormatService.dateTime("datetime",this.fixtime)),t[0].fixtime=this.dateFormatService.dateTime("datetime",t[0].fixtime),this.fixtime<t[0].fixtime&&(this.fixtime=t[0].fixtime),t.forEach(t=>{console.log(t.category),"motorcycle"==t.category&&(this.selectedIcon=this.myIcon),"car"==t.category&&(this.selectedIcon=this.myIcon3),"truck"==t.category&&(this.selectedIcon=this.myIcon4),"van"==t.category&&(this.selectedIcon=this.myIcon4),l[t.deviceid]=r.marker([t.latitude,t.longitude],{icon:this.selectedIcon}).bindPopup(t.name+" <br> Address: "+t.contact+" <br> Model: "+t.model+" <br> Phone: "+t.phone+" <br> Type: "+t.category,{closeOnClick:!0,autoClose:!1}).bindTooltip(t.name,{direction:"left",offset:[15,-45],permanent:!1}).addTo(this.map),o.addLayer(l[t.deviceid])})),this.myInterval=setInterval(()=>{var t=11;this.fixtime=this.dateFormatService.dateTime("datetime",this.fixtime),1==this.check&&this.deviceService.getMovingPosition({id:this.deviceIdArray,fixtime:this.fixtime}).subscribe(e=>{e.forEach(e=>{if(t!=e.deviceid)if(t=e.deviceid,"teltonika"==e.protocol){this.fixtime=e.fixtime,this.cusmapService.deviceDetails(e);var i=JSON.parse(e.attributes);console.log("testing============"),l[e.deviceid].setIcon(0!=e.speed?this.myIcon3_online:this.myIcon3),l[e.deviceid].setRotationAngle(e.course/2);const t=(e.latitude-l[e.deviceid].getLatLng().lat)/20,c=(e.longitude-l[e.deviceid].getLatLng().lng)/20;var o=0;a=setInterval(()=>{o+=1;var u=l[e.deviceid].getLatLng().lat+t,h=l[e.deviceid].getLatLng().lng+c;s=this.polyline[e.deviceid].addLatLng(r.latLng(u,h)),n.addLayer(s);let p=this.polyline[e.deviceid].getLatLngs();p.length>100&&(p=p.slice(20,120),s=this.polyline[e.deviceid].setLatLngs(p),n.addLayer(s)),this.marker=l[e.deviceid].setLatLng([u,h]).update().bindPopup("Name: <br> Address: "+void 0+e.latitude+","+e.longitude+" <br> Time: "+e.fixtime+" <br> Satellite: "+i.sat+" <br> Ignition: "+i.ignition+" <br> Motion: "+i.motion,{closeOnClick:!1,autoClose:!1}),o>=20&&(console.log("out"),clearTimeout(a))},240)}else{l[e.deviceid].setIcon(0!=e.speed?this.myIcon4_online:this.myIcon4),this.fixtime=e.fixtime,this.cusmapService.deviceDetails(e),r.layerGroup(),this.markerArray=r.layerGroup(),i=JSON.parse(e.attributes),console.log(e.latitude,e.longitude,l[e.deviceid].getLatLng().lat,l[e.deviceid].getLatLng().lng);const t=(e.latitude-l[e.deviceid].getLatLng().lat)/20,c=(e.longitude-l[e.deviceid].getLatLng().lng)/20;var s,a;r.polyline([],{weight:3,color:1===e.deviceid?"red":"blue",opacity:.5}).addTo(this.map),o=0,a=setInterval(()=>{o+=1;var u=l[e.deviceid].getLatLng().lat+t,h=l[e.deviceid].getLatLng().lng+c;s=this.polyline[e.deviceid].addLatLng(r.latLng(u,h)),n.addLayer(s);let p=this.polyline[e.deviceid].getLatLngs();p.length>100&&(p=p.slice(20,120),s=this.polyline[e.deviceid].setLatLngs(p),n.addLayer(s)),this.marker=l[e.deviceid].setLatLng([u,h]).update().bindPopup("Name: <br> Address: "+void 0+e.latitude+","+e.longitude+" <br> Time: "+e.fixtime+" <br> Satellite: "+i.sat+" <br> Ignition: "+i.ignition+" <br> Motion: "+i.motion,{closeOnClick:!1,autoClose:!1}),20==o&&clearTimeout(a)},250)}})})},5e3))}),this.cusmapService.deviceRemoveFromMap.subscribe(t=>{t&&(t.forEach(t=>{t.deviceid&&(t.id=t.deviceid),this.deviceIdArray=this.deviceIdArray.filter(e=>e!==t.id),console.log(t.id),this.map.removeLayer(l[t.id]),this.polyline[t.id]&&this.map.removeLayer(this.polyline[t.id])}),this.deviceIdArray.length<=0&&(this.check=0,clearInterval(this.myInterval)))}),this.cusmapService.deviceLocationCatch.subscribe(t=>{t&&this.map.flyTo([t[0].latitude,t[0].longitude],17,{duration:1})}),this.cusmapService.detailsDataCatch.subscribe(t=>{t&&c.show()}),this.cusmapService.eventCatch.subscribe(t=>{if(t){var e,i={lat:t[0].latitude,lng:t[0].longitude};r.Control.Geocoder.nominatim().reverse(i,this.map.options.crs.scale(this.map.getZoom()),t=>{e=t[0].name}),r.marker([t[0].latitude,t[0].longitude],{icon:this.myIcon4}).addTo(this.map).bindPopup("<b>"+t[0].name+"</b> <br> Address: "+e+" <br> Latitude: "+t[0].latitude+" <br> Longitude: "+t[0].longitude+" <br> Altitude: "+t[0].altitude+" <br> Speed: "+t[0].speed+" <br> Time: "+t[0].eventtime,{closeOnClick:!0,autoClose:!1}).openPopup(),this.map.panTo(new r.LatLng(t[0].latitude,t[0].longitude))}}),this.cusmapService.deviceHistoryCatch.subscribe(t=>{if(console.log(t),t){this.map.removeLayer(o),c.hide(),this.historyBar.show();var e=r.polyline([]).addTo(this.map);this.positions=t,this.storeLatlng=[],""!=this.positions&&(this.map.setView(new r.LatLng(this.positions[0].latitude,this.positions[0].longitude),13),this.positions.forEach((t,i)=>{let o=new Date(t.servertime),n=new Date(t.fixtime);this.timeArray.push(o),this.fixtimeArray.push(n);var s=(this.timeArray[i]-this.fixtimeArray[i])/6e4;s>20&&(this.engine=r.marker([t.latitude,t.longitude],{icon:this.myIcon}).bindPopup(t.deviceid+" <br> Address: "+t.latitude+" <br> Model: "+t.longitude+" <br> Servertime: "+t.servertime+" <br> Speed: "+t.speed+" <br> Power: "+t.course,{closeOnClick:!1,autoClose:!1}).openPopup(),this.engineArray.push(this.engine),this.history=r.layerGroup(this.engineArray)),s<20&&s>5&&(this.park=r.marker([t.latitude,t.longitude],{icon:this.myIcon2}).bindPopup(t.deviceid+" <br> Address: "+void 0+" <br> Latitude: "+t.latitude+" <br> Longitude: "+t.longitude+" <br> Servertime: "+t.servertime+" <br> Altitude: "+t.altitude+" <br> Speed: "+t.speed,{closeOnClick:!1,autoClose:!1}).openPopup().addTo(this.map),this.parkArray.push(this.park),this.parking=r.layerGroup(this.parkArray)),this.route=e.addLatLng(r.latLng(t.latitude,t.longitude)),this.arrow=this.route.arrowheads({size:"12px",color:"red",yawn:40,frequency:10}),this.storeLatlng.push([t.latitude,t.longitude])}),this.overlayMaps={Route:this.route,Engine:this.history,Parking:this.parking},this.parking&&this.parking.addTo(this.map),this.polylineMotion=r.motion.polyline(this.storeLatlng,{color:" "},{auto:!1,duration:3e4,easing:r.Motion.Ease.easeInOutQuart},{removeOnEnd:!1,icon:this.myIcon3}).addTo(this.map))}}),this.cusmapService.deviceMoveCatch.subscribe(t=>{t&&this.polylineMotion.motionStart()}),this.cusmapService.deviceToggleCatch.subscribe(t=>{t&&this.polylineMotion.motionToggle()}),this.cusmapService.motionConCatch.subscribe(t=>{t&&this.polylineMotion.motionSpeed(t)}),this.cusmapService.motionStoponCatch.subscribe(t=>{t&&this.polylineMotion.motionStop()}),this.cusmapService.tabIndexCatch.subscribe(t=>{t&&(this.map.setView(new r.LatLng(23.774252395907105,90.41607082790188),17),this.route&&this.map.removeLayer(this.route),this.parking&&this.map.removeLayer(this.parking),this.history&&this.map.removeLayer(this.history),this.map.addLayer(o),this.historyBar.hide())}),this.cusmapService.trafficCatch.subscribe(t=>{console.log(t),1==t&&(this.t=i.addTo(this.map))});var u,h,p=[];this.cusmapService.poiCatch.subscribe(t=>{console.log(t),t&&(this.poiSetStatus=1,t.forEach(t=>{var e=r.icon({iconUrl:`./assets/client/map_icons/${t.icon_id}.png`,iconAnchor:[0,0],color:"green",className:"icon"}),i=JSON.parse(t.coordinates),o=r.marker([i.lat,i.lng],{icon:e}).bindTooltip(t.name);p.push(o)}),(u=r.layerGroup(p)).addTo(this.map))}),this.cusmapService.poiRemoveCatch.subscribe(t=>{t&&(console.log(t),this.map.removeLayer(u),this.poiSetStatus=0)}),this.cusmapService.geofenceCatch.subscribe(t=>{if(t){var e=[];t.forEach(t=>{if(this.getStr=t.area,console.log(t),this.getStrMap=this.getStr.split(/[,()]/),console.log(this.getStrMap[0].trim()),"POLYGON"==this.getStrMap[0].trim()){this.getStrMap=this.getStrMap.slice(1,-1),this.getStrMap.forEach(t=>{var e=(t=t.split(" ").join(",")).split(","),i=parseFloat(e[0]),o=parseFloat(e[1]);this.getStrMapF.push([i,o])});var i=r.polygon(this.getStrMapF).bindTooltip(t.name,{permanent:!0,direction:"right"}).openTooltip();e.push(i)}if("CIRCLE"==this.getStrMap[0].trim()){this.getStrMap=this.getStrMap.slice(1,-1);var o=this.getStrMap[0].split(" ").join(",").split(","),n=parseFloat(o[0]),s=parseFloat(o[1]),a=parseFloat(this.getStrMap[1]),c=r.circle([n,s],{color:"#68e05b",fillColor:"#bbefcb",fillOpacity:.5,radius:a}).bindTooltip(t.name,{permanent:!0,direction:"right"}).openTooltip();e.push(c)}}),(h=r.layerGroup(e)).addTo(this.map)}}),this.cusmapService.geofenceRemoveCatch.subscribe(t=>{t&&this.map.removeLayer(h)})}traffic(t){console.log(t),this.cusmapService.trafficExchange(t),this.checkValue=2}geofence(t){1==t?(this.geoActive=!0,this.geoInactive=!1,this.geofenceService.getAllGeofence().subscribe(t=>{this.cusmapService.geofenceExchange(t),this.geofences=t}),this.geoStatus=2):(this.geoActive=!1,this.geoInactive=!0,this.cusmapService.geofenceRemoveExchange(1),this.geoStatus=1)}getAllPoi(t){1==t?(this.poiActive=!0,this.poiInactive=!1,this.deviceService.getAllPois().subscribe(t=>{this.cusmapService.poiExchange(t)}),this.poiStatus=2):(this.poiActive=!1,this.poiInactive=!0,this.cusmapService.poiRemoveExchange(1),this.poiStatus=1)}goAlertTab(){this.cusmapService.geoTabDataExchange(3)}goPoiTab(){this.cusmapService.poiTabExchange(6)}goGeofenceTab(t){this.cusmapService.geoTabDataExchange(t)}openSnackBar(){this.snackBar.open("Successfully added!!","Close",{duration:5e3,verticalPosition:"bottom",horizontalPosition:"end"})}openReportModal(){const t=new s.d;t.disableClose=!0,t.width="800px",t.height="580px",this.dialog.open(L,{width:"800px",height:"560px"}).afterClosed().subscribe(t=>{})}logout(){this.loginService.logout().subscribe(t=>{this.check=0,sessionStorage.removeItem("accessToken"),sessionStorage.removeItem("refreshToken"),this.routing.navigate(["/"])})}}return t.\u0275fac=function(e){return new(e||t)(a.Zb(T.g),a.Zb(O.a),a.Zb(w.a),a.Zb(n.c),a.Zb(M.a),a.Zb(u.a),a.Zb(l.a),a.Zb(k.a),a.Zb(s.b))},t.\u0275cmp=a.Tb({type:t,selectors:[["app-map-info"]],decls:72,vars:19,consts:[["id","t","fxLayout","row","fxLayout.xs","column","color","primary",1,"mi",3,"ngClass"],["fxFlex","73%","fxLayout","row","fxLayout.xs","100%"],["fxFlex","80%"],["src","assets/client/images/traccar.png","width","100","alt","avatar"],["fxLayout","row","fxFlex","30%",4,"ngIf"],["fxFlex","22%","fxLayout.xs","100%"],[1,"position"],["mat-button","",1,"col",3,"matMenuTriggerFor"],["matTooltip","Tools",1,"mainmenubt"],["mat-button","",1,"col"],["matTooltip","Setup"],["matTooltip","Chat"],["menu","matMenu"],["mat-menu-item","",1,"matbt",3,"click"],[1,"toolsIcon"],["mat-menu-item","",1,"matbt"],["class","col","mat-button","",3,"matMenuTriggerFor",4,"ngIf"],["account","matMenu"],["routerLink","authorization/users/user-profile","mat-menu-item",""],["routerLink","authorization/users/change-password","mat-menu-item",""],["mat-menu-item","",3,"click"],["id","mapid",2,"width","100%","height","90%"],[1,"geofenceButton",3,"ngClass","click"],["matTooltip","Geofences","matTooltipPosition","left"],[1,"poiButton",3,"ngClass","click"],["matTooltip","POI","matTooltipPosition","left"],[1,"tailButton",3,"ngClass","click"],["matTooltip","Tails","matTooltipPosition","left"],["id","sidebar",2,"width","100%","height","100%"],["id","menu",2,"height","200px"],["id","history",2,"height","150px"],["fxLayout","row","fxFlex","30%"],["id","r","mat-button","",3,"matMenuTriggerFor"],["src","assets/client/images/avatar.png","width","35","alt","avatar",1,"logout-image"],[1,"align-middle"],["matTooltip","My Account"]],template:function(t,e){if(1&t&&(a.fc(0,"div",0),a.fc(1,"div",1),a.fc(2,"div",2),a.ac(3,"img",3),a.ec(),a.Sc(4,St,4,1,"div",4),a.ec(),a.fc(5,"div",5),a.fc(6,"div",6),a.fc(7,"button",7),a.fc(8,"mat-icon",8),a.Tc(9,"build"),a.ec(),a.ec(),a.fc(10,"button",9),a.fc(11,"mat-icon",10),a.Tc(12,"settings"),a.ec(),a.ec(),a.fc(13,"button",9),a.fc(14,"mat-icon",11),a.Tc(15,"chat"),a.ec(),a.ec(),a.fc(16,"mat-menu",null,12),a.fc(18,"button",13),a.nc("click",(function(){return e.goGeofenceTab(3)})),a.fc(19,"mat-icon",14),a.Tc(20,"notifications"),a.ec(),a.Tc(21,"Alerts"),a.ec(),a.fc(22,"button",13),a.nc("click",(function(){return e.goGeofenceTab(4)})),a.fc(23,"mat-icon",14),a.Tc(24,"fence"),a.ec(),a.Tc(25,"Geofencing"),a.ec(),a.fc(26,"button",15),a.fc(27,"mat-icon",14),a.Tc(28,"alt_route"),a.ec(),a.Tc(29,"Routes"),a.ec(),a.fc(30,"button",13),a.nc("click",(function(){return e.openReportModal()})),a.fc(31,"mat-icon",14),a.Tc(32,"signal_cellular_alt"),a.ec(),a.Tc(33,"Reports"),a.ec(),a.fc(34,"button",13),a.nc("click",(function(){return e.goPoiTab()})),a.fc(35,"mat-icon",14),a.Tc(36,"room"),a.ec(),a.Tc(37,"POI"),a.ec(),a.ec(),a.Sc(38,Lt,4,1,"a",16),a.fc(39,"mat-menu",null,17),a.fc(41,"a",18),a.fc(42,"mat-icon"),a.Tc(43,"account_circle"),a.ec(),a.fc(44,"span"),a.Tc(45,"Profile"),a.ec(),a.ec(),a.fc(46,"a",19),a.fc(47,"mat-icon"),a.Tc(48,"settings"),a.ec(),a.fc(49,"span"),a.Tc(50,"Change Pass "),a.ec(),a.ec(),a.fc(51,"a",20),a.nc("click",(function(){return e.logout()})),a.fc(52,"mat-icon"),a.Tc(53,"exit_to_app"),a.ec(),a.fc(54,"span"),a.Tc(55,"Logout"),a.ec(),a.ec(),a.ec(),a.ec(),a.ec(),a.ec(),a.fc(56,"div",21),a.fc(57,"button",22),a.nc("click",(function(){return e.geofence(e.geoStatus)})),a.fc(58,"mat-icon",23),a.Tc(59,"fence"),a.ec(),a.ec(),a.fc(60,"button",24),a.nc("click",(function(){return e.getAllPoi(e.poiStatus)})),a.fc(61,"mat-icon",25),a.Tc(62,"room"),a.ec(),a.ec(),a.fc(63,"button",26),a.nc("click",(function(){return e.getAllPoi(e.poiStatus)})),a.fc(64,"mat-icon",27),a.Tc(65,"trending_up"),a.ec(),a.ec(),a.ec(),a.fc(66,"div",28),a.ac(67,"app-side-menu"),a.ec(),a.fc(68,"div",29),a.ac(69,"app-bottom-details"),a.ec(),a.fc(70,"div",30),a.ac(71,"app-history-info"),a.ec()),2&t){const t=a.Gc(17);a.yc("ngClass",a.Dc(7,Tt,e.s,e.h)),a.Ob(4),a.yc("ngIf",e.deviceXs),a.Ob(3),a.yc("matMenuTriggerFor",t),a.Ob(31),a.yc("ngIf",!e.deviceXs),a.Ob(19),a.yc("ngClass",a.Dc(10,Ot,e.geoActive,e.geoInactive)),a.Ob(3),a.yc("ngClass",a.Dc(13,wt,e.poiActive,e.poiInactive)),a.Ob(3),a.yc("ngClass",a.Dc(16,Mt,e.tailActive,e.tailInactive))}},directives:[P.b,o.k,I.a,P.a,o.m,g.b,A.c,h.a,D.a,A.d,A.a,n.e,gt,xt,Ct,g.a],styles:['h2[_ngcontent-%COMP%]{margin-top:3%}.mi[_ngcontent-%COMP%]{z-index:4000;width:100%!important;background-color:#fff;float:left}.space[_ngcontent-%COMP%]{flex:1 1 auto}.col[_ngcontent-%COMP%]{width:15%;border:0;color:#d9d9d9;background-color:#fff}.colm[_ngcontent-%COMP%]{margin-left:2%;color:#fff}.map[_ngcontent-%COMP%]{width:100%}a[_ngcontent-%COMP%]{cursor:pointer}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:25px 30px!important}.tab[_ngcontent-%COMP%]{overflow:hidden;border:1px solid #ccc;background-color:#e63e3e}.tab[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:inherit;float:left;border:none;outline:none;cursor:pointer;padding:14px 16px;transition:.3s}.tab[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#ddd}.tab[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#ccc}#bottommenu[_ngcontent-%COMP%]{width:900px!important}.easy-button-button.disabled[_ngcontent-%COMP%]{display:none}.position[_ngcontent-%COMP%]{margin-top:2%;margin-left:10%}.admin_button[_ngcontent-%COMP%]{margin-top:.5%}.leaflet-marker-pane[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{transition:transform .3s linear}#acButton[_ngcontent-%COMP%]{position:absolute;height:30px;top:100px;right:20px;z-index:4000}.geofenceButton[_ngcontent-%COMP%]{top:100px}.geofenceButton[_ngcontent-%COMP%], .tailButton[_ngcontent-%COMP%]{position:absolute;height:30px;right:10px;z-index:1000}.tailButton[_ngcontent-%COMP%]{top:170px}.poiButton[_ngcontent-%COMP%]{top:135px;z-index:1000}.poiButton[_ngcontent-%COMP%], .trafficButton[_ngcontent-%COMP%]{position:absolute;height:30px;right:10px}.trafficButton[_ngcontent-%COMP%]{top:170px;z-index:4000}.show[_ngcontent-%COMP%]{visibility:visible}.hide[_ngcontent-%COMP%], .show[_ngcontent-%COMP%]{position:relative}.hide[_ngcontent-%COMP%]{visibility:hidden;opacity:0}.trafficActive[_ngcontent-%COMP%]{border:0;background-color:#2c82d8;color:#fff}.trafficInactive[_ngcontent-%COMP%]{border:0;background-color:#fff;color:#555}.poiActive[_ngcontent-%COMP%]{border:0;background-color:#2c82d8;color:#fff}.poiInactive[_ngcontent-%COMP%]{border:0;background-color:#fff;color:#555}.tailActive[_ngcontent-%COMP%]{border:0;background-color:#2c82d8;color:#fff}.tailInactive[_ngcontent-%COMP%]{border:0;background-color:#fff;color:#555}.geofenceActive[_ngcontent-%COMP%]{border:0;background-color:#2c82d8;color:#fff}.geofenceInactive[_ngcontent-%COMP%]{border:0;background-color:#fff;color:#555}.map_button[_ngcontent-%COMP%]{cursor:pointer}mat-icon[_ngcontent-%COMP%]{background-color:2px solid #afabab}.matbt[_ngcontent-%COMP%]{line-height:0;font-size:12px;height:30px}.toolsIcon[_ngcontent-%COMP%]{font-size:14px;margin-right:0}.mat-menu-item[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{height:16px;margin-right:0;vertical-align:middle}.mainmenubt[_ngcontent-%COMP%]{font-size:14px}.mainmenubt[_ngcontent-%COMP%]:hover{color:#2c82d8}.boxButton[_ngcontent-%COMP%]{position:absolute;height:30px;top:205px;right:10px;z-index:4000}.container[_ngcontent-%COMP%]{top:205px;display:block;position:relative;padding-left:35px;margin-bottom:12px;cursor:pointer;font-size:22px;-webkit-user-select:none;user-select:none}.container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;opacity:0;cursor:pointer;height:0;width:0}.checkmark[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:25px;width:25px;background-color:#eee}.container[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%] ~ .checkmark[_ngcontent-%COMP%]{background-color:#ccc}.container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]{background-color:#2196f3}.checkmark[_ngcontent-%COMP%]:after{content:"";position:absolute;display:none}.container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]:after{display:block}.container[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]:after{left:9px;top:5px;width:5px;height:10px;border:solid #fff;border-width:0 3px 3px 0;transform:rotate(45deg)}.u-turn-icon[_ngcontent-%COMP%]{transform:rotate(20deg)!important}']}),t})()}];let Pt=(()=>{class t{}return t.\u0275mod=a.Xb({type:t}),t.\u0275inj=a.Wb({factory:function(e){return new(e||t)},imports:[[n.f.forChild(kt)],n.f]}),t})();var It=i("jAig"),At=i("YUcS"),Dt=i("xoCY");let Rt=(()=>{class t{}return t.\u0275mod=a.Xb({type:t}),t.\u0275inj=a.Wb({factory:function(e){return new(e||t)},imports:[[o.c,Pt,It.a,At.a,Dt.a,Dt.b,c.s,c.i]]}),t})()},owmp:function(t,e,i){!function(t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var e,i,o,n=function(t,e){return(180*Math.atan2(e.y-t.y,e.x-t.x)/Math.PI+90+360)%360},s=function(t,e){var i=t.value;return t.isInPixels?i/e:i};function r(t){if("string"==typeof t&&-1!==t.indexOf("%"))return{value:parseFloat(t)/100,isInPixels:!1};var e=t?parseFloat(t):0;return{value:e,isInPixels:e>0}}e=L.Marker.prototype._initIcon,i=L.Marker.prototype._setPos,o="msTransform"===L.DomUtil.TRANSFORM,L.Marker.addInitHook((function(){var t=this.options.icon&&this.options.icon.options&&this.options.icon.options.iconAnchor;t&&(t=t[0]+"px "+t[1]+"px"),this.options.rotationOrigin=this.options.rotationOrigin||t||"center bottom",this.options.rotationAngle=this.options.rotationAngle||0,this.on("drag",(function(t){t.target._applyRotation()}))})),L.Marker.include({_initIcon:function(){e.call(this)},_setPos:function(t){i.call(this,t),this._applyRotation()},_applyRotation:function(){this.options.rotationAngle&&(this._icon.style[L.DomUtil.TRANSFORM+"Origin"]=this.options.rotationOrigin,o?this._icon.style[L.DomUtil.TRANSFORM]="rotate("+this.options.rotationAngle+"deg)":this._icon.style[L.DomUtil.TRANSFORM]+=" rotateZ("+this.options.rotationAngle+"deg)")},setRotationAngle:function(t){return this.options.rotationAngle=t,this.update(),this},setRotationOrigin:function(t){return this.options.rotationOrigin=t,this.update(),this}}),t.Symbol=t.Symbol||{},t.Symbol.Dash=t.Class.extend({options:{pixelSize:10,pathOptions:{}},initialize:function(e){t.Util.setOptions(this,e),this.options.pathOptions.clickable=!1},buildSymbol:function(e,i,o,n,s){var r=this.options,a=Math.PI/180;if(r.pixelSize<=1)return t.polyline([e.latLng,e.latLng],r.pathOptions);var c=o.project(e.latLng),l=-(e.heading-90)*a,u=t.point(c.x+r.pixelSize*Math.cos(l+Math.PI)/2,c.y+r.pixelSize*Math.sin(l)/2),h=c.add(c.subtract(u));return t.polyline([o.unproject(u),o.unproject(h)],r.pathOptions)}}),t.Symbol.dash=function(e){return new t.Symbol.Dash(e)},t.Symbol.ArrowHead=t.Class.extend({options:{polygon:!0,pixelSize:10,headAngle:60,pathOptions:{stroke:!1,weight:2}},initialize:function(e){t.Util.setOptions(this,e),this.options.pathOptions.clickable=!1},buildSymbol:function(e,i,o,n,s){return this.options.polygon?t.polygon(this._buildArrowPath(e,o),this.options.pathOptions):t.polyline(this._buildArrowPath(e,o),this.options.pathOptions)},_buildArrowPath:function(e,i){var o=Math.PI/180,n=i.project(e.latLng),s=-(e.heading-90)*o,r=this.options.headAngle/2*o,a=s+r,c=s-r,l=t.point(n.x-this.options.pixelSize*Math.cos(a),n.y+this.options.pixelSize*Math.sin(a)),u=t.point(n.x-this.options.pixelSize*Math.cos(c),n.y+this.options.pixelSize*Math.sin(c));return[i.unproject(l),e.latLng,i.unproject(u)]}}),t.Symbol.arrowHead=function(e){return new t.Symbol.ArrowHead(e)},t.Symbol.Marker=t.Class.extend({options:{markerOptions:{},rotate:!1},initialize:function(e){t.Util.setOptions(this,e),this.options.markerOptions.clickable=!1,this.options.markerOptions.draggable=!1},buildSymbol:function(e,i,o,n,s){return this.options.rotate&&(this.options.markerOptions.rotationAngle=e.heading+(this.options.angleCorrection||0)),t.marker(e.latLng,this.options.markerOptions)}}),t.Symbol.marker=function(e){return new t.Symbol.Marker(e)},t.PolylineDecorator=t.FeatureGroup.extend({options:{patterns:[]},initialize:function(e,i){t.FeatureGroup.prototype.initialize.call(this),t.Util.setOptions(this,i),this._map=null,this._paths=this._initPaths(e),this._bounds=this._initBounds(),this._patterns=this._initPatterns(this.options.patterns)},_initPaths:function(e,i){var o,n,s=this;return o=e,Array.isArray(o)&&((n=o[0])instanceof t.LatLng||Array.isArray(n)&&2===n.length&&"number"==typeof n[0])?[i?e.concat([e[0]]):e]:e instanceof t.Polyline?this._initPaths(e.getLatLngs(),e instanceof t.Polygon):Array.isArray(e)?e.reduce((function(t,e){return t.concat(s._initPaths(e,i))}),[]):[]},_initPatterns:function(t){return t.map(this._parsePatternDef)},setPatterns:function(t){this.options.patterns=t,this._patterns=this._initPatterns(this.options.patterns),this.redraw()},setPaths:function(t){this._paths=this._initPaths(t),this._bounds=this._initBounds(),this.redraw()},_parsePatternDef:function(t,e){return{symbolFactory:t.symbol,offset:r(t.offset),endOffset:r(t.endOffset),repeat:r(t.repeat)}},onAdd:function(t){this._map=t,this._draw(),this._map.on("moveend",this.redraw,this)},onRemove:function(e){this._map.off("moveend",this.redraw,this),this._map=null,t.FeatureGroup.prototype.onRemove.call(this,e)},_initBounds:function(){var e=this._paths.reduce((function(t,e){return t.concat(e)}),[]);return t.latLngBounds(e)},getBounds:function(){return this._bounds},_buildSymbols:function(t,e,i){var o=this;return i.map((function(n,s){return e.buildSymbol(n,t,o._map,s,i.length)}))},_getDirectionPoints:function(e,i){var o=this;return e.length<2?[]:function(t,e){var i=function(t){return t.reduce((function(t,e,i,o){if(i>0&&!function(t,e){return t.x===e.x&&t.y===e.y}(e,o[i-1])){var s=o[i-1],r=t.length>0?t[t.length-1].distB:0,a=(u=(l=e).x-(c=s).x,h=l.y-c.y,Math.sqrt(u*u+h*h));t.push({a:s,b:e,distA:r,distB:r+a,heading:n(s,e)})}var c,l,u,h;return t}),[])}(t),o=i.length;if(0===o)return[];var r=i[o-1].distB,a=s(e.offset,r),c=s(e.endOffset,r),l=r*s(e.repeat,r),u=c>0?r*c:0,h=[],p=a>0?r*a:0;do{h.push(p),p+=l}while(l>0&&p<r-u);var d=0,m=i[0];return h.map((function(t){for(;t>m.distB&&d<o-1;)d++,m=i[d];return{pt:(e=m.a,n=m.b,s=(t-m.distA)/(m.distB-m.distA),n.x!==e.x?{x:e.x+s*(n.x-e.x),y:e.y+s*(n.y-e.y)}:{x:e.x,y:e.y+(n.y-e.y)*s}),heading:m.heading};var e,n,s}))}(e.map((function(t){return o._map.project(t)})),i).map((function(e){return{latLng:o._map.unproject(t.point(e.pt)),heading:e.heading}}))},redraw:function(){this._map&&(this.clearLayers(),this._draw())},_getPatternLayers:function(e){var i=this,o=this._map.getBounds().pad(.1);return this._paths.map((function(n){var s=i._getDirectionPoints(n,e).filter((function(t){return o.contains(t.latLng)}));return t.featureGroup(i._buildSymbols(n,e.symbolFactory,s))}))},_draw:function(){var e=this;this._patterns.map((function(t){return e._getPatternLayers(t)})).forEach((function(i){e.addLayer(t.featureGroup(i))}))}}),t.polylineDecorator=function(e,i){return new t.PolylineDecorator(e,i)}}(i("4R65"))},qLfE:function(t,e){var i,o,n;i=L.Marker.prototype._initIcon,o=L.Marker.prototype._setPos,n="msTransform"===L.DomUtil.TRANSFORM,L.Marker.addInitHook((function(){var t=this.options.icon&&this.options.icon.options&&this.options.icon.options.iconAnchor;t&&(t=t[0]+"px "+t[1]+"px"),this.options.rotationOrigin=this.options.rotationOrigin||t||"center bottom",this.options.rotationAngle=this.options.rotationAngle||0,this.on("drag",(function(t){t.target._applyRotation()}))})),L.Marker.include({_initIcon:function(){i.call(this)},_setPos:function(t){o.call(this,t),this._applyRotation()},_applyRotation:function(){this.options.rotationAngle&&(this._icon.style[L.DomUtil.TRANSFORM+"Origin"]=this.options.rotationOrigin,n?this._icon.style[L.DomUtil.TRANSFORM]="rotate("+this.options.rotationAngle+"deg)":this._icon.style[L.DomUtil.TRANSFORM]+=" rotateZ("+this.options.rotationAngle+"deg)")},setRotationAngle:function(t){return this.options.rotationAngle=t,this.update(),this},setRotationOrigin:function(t){return this.options.rotationOrigin=t,this.update(),this}})}}]);