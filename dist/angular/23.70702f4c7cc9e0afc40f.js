(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{ZHqx:function(e,t,i){"use strict";i.r(t),i.d(t,"UserModule",(function(){return Pe}));var o=i("ofXK"),n=i("tyNb"),c=i("fXoL"),s=i("bSwM"),a=i("3Pt+");function r(e,t){if(1&e){const e=c.gc();c.fc(0,"li"),c.fc(1,"mat-checkbox",6),c.nc("ngModelChange",(function(i){return c.Hc(e),t.$implicit.completed=i}))("change",(function(t){return c.Hc(e),c.rc().updateAllComplete(t.checked)})),c.Qc(2),c.ec(),c.ec()}if(2&e){const e=t.$implicit;c.Ob(1),c.yc("ngModel",e.completed)("color",e.color),c.Ob(1),c.Sc(" ",e.name," ")}}let l=(()=>{class e{constructor(){this.task={name:"Indeterminate",completed:!1,color:"primary",subtasks:[{name:"Primary",completed:!1,color:"primary"},{name:"Accent",completed:!1,color:"accent"},{name:"Warn",completed:!1,color:"warn"}]},this.allComplete=!1}updateAllComplete(e){console.log("testing"),this.allComplete=null!=this.task.subtasks&&this.task.subtasks.every(e=>e.completed)}someComplete(){return null!=this.task.subtasks&&this.task.subtasks.filter(e=>e.completed).length>0&&!this.allComplete}setAll(e){this.allComplete=e,null!=this.task.subtasks&&this.task.subtasks.forEach(t=>t.completed=e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Tb({type:e,selectors:[["app-test"]],decls:12,vars:6,consts:[[1,"example-section"],[1,"example-margin"],[1,"example-margin",3,"disabled"],[1,"example-list-section"],[1,"example-margin",3,"checked","color","indeterminate","change"],[4,"ngFor","ngForOf"],[3,"ngModel","color","ngModelChange","change"]],template:function(e,t){1&e&&(c.fc(0,"section",0),c.fc(1,"mat-checkbox",1),c.Qc(2,"Check me!"),c.ec(),c.fc(3,"mat-checkbox",2),c.Qc(4,"Disabled"),c.ec(),c.ec(),c.fc(5,"section",0),c.fc(6,"span",3),c.fc(7,"mat-checkbox",4),c.nc("change",(function(e){return t.setAll(e.checked)})),c.Qc(8),c.ec(),c.ec(),c.fc(9,"span",3),c.fc(10,"ul"),c.Pc(11,r,3,3,"li",5),c.ec(),c.ec(),c.ec()),2&e&&(c.Ob(3),c.yc("disabled",!0),c.Ob(4),c.yc("checked",t.allComplete)("color",t.task.color)("indeterminate",t.someComplete()),c.Ob(1),c.Sc(" ",t.task.name," "),c.Ob(3),c.yc("ngForOf",t.task.subtasks))},directives:[s.a,o.l,a.m,a.p],styles:[".example-section[_ngcontent-%COMP%]{margin:12px 0}.example-margin[_ngcontent-%COMP%]{margin:0 12px}ul[_ngcontent-%COMP%]{list-style-type:none;margin-top:4px}"]}),e})();var h=i("4R65"),m=(i("iR4+"),i("b1UB"),i("CvBG"),i("mD1w"),i("HMfJ"),i("am+x"),i("I8tt"),i("eapw"),i("+0xr")),d=i("0IaG"),u=i("i+38"),p=i("CjG4"),f=i("dNgK"),g=i("NFeN"),b=i("Wp6s"),v=i("kmnG"),y=i("qFsG"),_=i("bTqV");function x(e,t){1&e&&(c.fc(0,"div"),c.fc(1,"p",11),c.Qc(2," Current Password Not Valid"),c.ec(),c.ec())}function O(e,t){1&e&&(c.fc(0,"div"),c.fc(1,"p",11),c.Qc(2," Has Been Changed Successfully"),c.ec(),c.ec())}let k=(()=>{class e{constructor(e,t,i,o,n){this.dialogRef=e,this.dialog=t,this.userService=i,this.fb=o,this.snackBar=n}ngOnInit(){this.myform=this.fb.group({oldPassword:["",[a.s.required]],password:["",[a.s.required]],confirm_password:["",[a.s.required,Object(u.a)("password")]],user_id:[""]})}changePassword(){this.userData=JSON.parse(localStorage.getItem("userData")),this.myform.value.user_id=this.userData.id,this.userService.changePassword(this.myform.value).subscribe(e=>{this.openSnackBar()},e=>{this.show1=!0}),console.log(this.myform.value)}openSnackBar(){this.snackBar.open("Reset Successfully!!","Close",{duration:2e3,verticalPosition:"top",horizontalPosition:"end"})}close(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(c.Zb(d.f),c.Zb(d.b),c.Zb(p.a),c.Zb(a.e),c.Zb(f.a))},e.\u0275cmp=c.Tb({type:e,selectors:[["app-changepass-popup"]],decls:27,vars:4,consts:[[1,"table-title"],[3,"click"],[1,"customStyle"],[3,"formGroup"],[1,"full"],["matInput","","type","password","placeholder","Current Password","formControlName","oldPassword","autocomplete","off","required",""],["matInput","","type","password","placeholder","New Password","formControlName","password","autocomplete","off","required",""],["type","password","matInput","","placeholder","Confirm New Password","formControlName","confirm_password","autocomplete","off","compare","password","required",""],[4,"ngIf"],["mat-stroked-button","","color","primary",1,"btn-block",3,"disabled","click"],["mat-stroked-button","","color","primary",1,"btn-block",3,"click"],[1,"red"]],template:function(e,t){1&e&&(c.fc(0,"div",0),c.fc(1,"h3"),c.Qc(2,"Password Change Form"),c.ec(),c.fc(3,"span"),c.fc(4,"a"),c.fc(5,"mat-icon",1),c.nc("click",(function(){return t.close()})),c.Qc(6,"close"),c.ec(),c.ec(),c.ec(),c.ec(),c.fc(7,"mat-card",2),c.fc(8,"mat-card-content"),c.fc(9,"form",3),c.fc(10,"mat-form-field",4),c.ac(11,"input",5),c.ec(),c.fc(12,"mat-form-field",4),c.ac(13,"input",6),c.ec(),c.fc(14,"mat-form-field",4),c.ac(15,"input",7),c.fc(16,"mat-error"),c.Qc(17," password does not match "),c.ec(),c.ec(),c.ec(),c.ec(),c.Pc(18,x,3,0,"div",8),c.fc(19,"mat-card-actions"),c.fc(20,"button",9),c.nc("click",(function(){return t.changePassword()})),c.Qc(21," Submit "),c.ec(),c.fc(22,"button",10),c.nc("click",(function(){return t.close()})),c.Qc(23," Close "),c.ec(),c.fc(24,"p"),c.Qc(25,"Note: Field marked with * is Mandatory"),c.ec(),c.ec(),c.Pc(26,O,3,0,"div",8),c.ec()),2&e&&(c.Ob(9),c.yc("formGroup",t.myform),c.Ob(9),c.yc("ngIf",t.show1),c.Ob(2),c.yc("disabled",!t.myform.valid),c.Ob(6),c.yc("ngIf",t.show))},directives:[g.a,b.a,b.c,a.t,a.n,a.g,v.c,y.b,a.c,a.m,a.f,a.r,v.b,o.m,b.b,_.b],styles:["h3[_ngcontent-%COMP%]{float:left;margin-right:70%;margin-left:5%}.customStyle[_ngcontent-%COMP%]{width:90%;border-radius:10px 10px 10px 10px;box-shadow:5px 10px 15px #1a237e}.customStyle[_ngcontent-%COMP%]   .title-style[_ngcontent-%COMP%]{color:#1a237e;text-align:center!important;margin-bottom:15px}.customStyle[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{color:red;margin-left:30px}.customStyle[_ngcontent-%COMP%]   .error_message[_ngcontent-%COMP%]{color:red;margin-left:20px;margin-top:-10px;font-size:12px}.mat-stroked-button[_ngcontent-%COMP%]{width:120px;border:1px solid #00f}.sidenav-content[_ngcontent-%COMP%]{height:120%}.red[_ngcontent-%COMP%]{color:#00f;font-size:16px}.reda[_ngcontent-%COMP%]{color:red}p[_ngcontent-%COMP%]{font-size:10px}.dd[_ngcontent-%COMP%]{width:120px;height:25px;margin-left:10px;margin-top:5px;margin-bottom:10px;text-align:left}a[_ngcontent-%COMP%]{cursor:pointer;margin-top:20px}.closeButton[_ngcontent-%COMP%]{width:30px;height:30px;margin-left:5px;cursor:pointer}"]}),e})(),C=(()=>{class e{constructor(e,t){this.dialogRef=e,this.dialog=t}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(c.Zb(d.f),c.Zb(d.b))},e.\u0275cmp=c.Tb({type:e,selectors:[["app-userprofile-popup"]],decls:2,vars:0,template:function(e,t){1&e&&(c.fc(0,"p"),c.Qc(1,"userprofile-popup works!"),c.ec())},styles:[""]}),e})();var P=i("pD6V"),w=i("XCAU"),M=i("2Vo4");let D=(()=>{class e{constructor(){this.movingDataSent=new M.a(""),this.c=new M.a(""),this.r=new M.a(""),this.devices=new M.a(""),this.deviceGroup=new M.a(""),this.history=new M.a(""),this.selectedDeviceDataSend=new M.a(""),this.start=new M.a(""),this.toggle=new M.a(""),this.indexHistory=new M.a(""),this.indexDetails=new M.a(""),this.detailsDataSend=new M.a(""),this.movingDataCatch=this.movingDataSent.asObservable(),this.remove=this.r.asObservable(),this.s=this.c.asObservable(),this.deviesMove=this.devices.asObservable(),this.deviceGroupRemove=this.deviceGroup.asObservable(),this.selectedDeviceDataCatch=this.selectedDeviceDataSend.asObservable(),this.historyData=this.history.asObservable(),this.startDevice=this.start.asObservable(),this.toggleDevice=this.toggle.asObservable(),this.indexHistoryView=this.indexHistory.asObservable(),this.indexDetailsView=this.indexDetails.asObservable(),this.detailsDataCatch=this.detailsDataSend.asObservable()}devicePosition(e){console.log(e),this.movingDataSent.next(e)}updateLocation(e){console.log(e),this.c.next(e)}removeData(e){this.r.next(e)}DeviceMoveUpdate(e){this.devices.next(e)}DeviceGroupDelete(e){this.deviceGroup.next(e)}selectedDeviceDataExchange(e){this.selectedDeviceDataSend.next(e)}historyShow(e){this.history.next(e)}move(e){this.start.next(e)}toggleMove(e){this.toggle.next(e)}hideWithIndexHistory(e){this.indexHistory.next(e)}showWithIndexDetails(e){this.indexDetails.next(e)}detailsDataExchange(e){this.detailsDataSend.next(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=c.Vb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var S=i("tmcy"),L=i("3cRz"),I=i("XiUz"),T=i("STbY"),Q=i("M5z4"),A=i("Ofeh"),F=i("wZkO"),E=i("7EHt"),H=i("d3UM"),z=i("z17N"),U=i("FKr1"),G=i("Xa2L");function N(e,t){if(1&e&&(c.fc(0,"span",39),c.Qc(1),c.sc(2,"number"),c.ec()),2&e){const e=c.rc().$implicit,t=c.rc(3);c.Ob(1),c.Sc("",c.tc(2,1,1.852*(null==t.deviceCheckDataIndex[e.deviceid]?null:t.deviceCheckDataIndex[e.deviceid].speed))," km")}}function R(e,t){if(1&e&&(c.fc(0,"div",40),c.Qc(1),c.sc(2,"date"),c.ec()),2&e){const e=c.rc().$implicit,t=c.rc(3);c.Ob(1),c.Sc(" ",c.uc(2,1,null==t.deviceCheckDataIndex[e.deviceid]?null:t.deviceCheckDataIndex[e.deviceid].servertime,"medium")," ")}}function Z(e,t){if(1&e){const e=c.gc();c.fc(0,"div"),c.fc(1,"div",30),c.fc(2,"mat-checkbox",31),c.nc("change",(function(i){c.Hc(e);const o=t.$implicit,n=c.rc(3);return n.check(i.checked,n.devicesIndex[o.deviceid])}))("keyup",(function(t){return c.Hc(e),c.rc(3).filterItem(t.target.value)})),c.ec(),c.fc(3,"a",32),c.nc("click",(function(){c.Hc(e);const i=t.$implicit,o=c.rc(3);return o.getLocation(o.devicesIndex[i.deviceid])})),c.Qc(4),c.ec(),c.fc(5,"a",33),c.fc(6,"mat-icon"),c.Qc(7,"more_vert"),c.ec(),c.ec(),c.fc(8,"span",34),c.ac(9,"i",35),c.ec(),c.Pc(10,N,3,3,"span",36),c.Pc(11,R,3,4,"div",37),c.fc(12,"mat-menu",13,14),c.fc(14,"button",38),c.Qc(15,"Track"),c.ec(),c.fc(16,"button",38),c.Qc(17," Sharing "),c.ec(),c.ec(),c.ec(),c.ec()}if(2&e){const e=t.$implicit,i=c.Fc(13),o=c.rc(3);c.Ob(2),c.yc("checked",o.checkState(e.deviceid)),c.Ob(2),c.Rc(null==o.devicesIndex[e.deviceid]?null:o.devicesIndex[e.deviceid].name),c.Ob(1),c.yc("matMenuTriggerFor",i),c.Ob(5),c.yc("ngIf",o.deviceCheckDataIndex),c.Ob(1),c.yc("ngIf",o.deviceCheckDataIndex)}}function B(e,t){if(1&e){const e=c.gc();c.fc(0,"mat-expansion-panel",27),c.fc(1,"mat-expansion-panel-header"),c.fc(2,"mat-checkbox",28),c.nc("click",(function(t){return c.Hc(e),t.stopPropagation()}))("keydown",(function(t){return c.Hc(e),t.stopPropagation()}))("change",(function(i){c.Hc(e);const o=t.$implicit;return c.rc(2).checkAllByGroup(i.checked,o.customer_id)})),c.Qc(3),c.ec(),c.ec(),c.Pc(4,Z,18,5,"div",29),c.ec()}if(2&e){const e=t.$implicit,i=c.rc(2);c.yc("expanded",!1),c.Ob(2),c.yc("value",e.customer_id),c.Ob(1),c.Sc(" ",e.name," "),c.Ob(1),c.yc("ngForOf",i.permission[e.customer_id])}}function j(e,t){if(1&e){const e=c.gc();c.fc(0,"div"),c.fc(1,"div",21),c.fc(2,"mat-form-field",22),c.fc(3,"input",23),c.nc("keyup",(function(t){return c.Hc(e),c.rc().filterItem(t.target.value)})),c.ec(),c.ec(),c.fc(4,"button",24),c.Qc(5," + "),c.ec(),c.fc(6,"button",24),c.Qc(7," - "),c.ec(),c.ec(),c.fc(8,"div"),c.fc(9,"form",25),c.fc(10,"mat-accordion"),c.Pc(11,B,5,4,"mat-expansion-panel",26),c.ec(),c.ec(),c.ec(),c.ec()}if(2&e){const e=c.rc();c.Ob(3),c.yc("checked",e.box),c.Ob(6),c.yc("formGroup",e.myform),c.Ob(2),c.yc("ngForOf",e.customers)}}function q(e,t){1&e&&(c.fc(0,"th",41),c.Qc(1,"Time"),c.ec())}function $(e,t){if(1&e){const e=c.gc();c.fc(0,"td",42),c.fc(1,"a",43),c.nc("click",(function(){c.Hc(e);const i=t.$implicit;return c.rc().eventInfo(i)})),c.Qc(2),c.sc(3,"date"),c.ec(),c.ec()}if(2&e){const e=t.$implicit;c.Ob(2),c.Rc(c.uc(3,1,e.eventtime,"medium"))}}function V(e,t){1&e&&(c.fc(0,"th",41),c.Qc(1,"Name"),c.ec())}function W(e,t){if(1&e){const e=c.gc();c.fc(0,"td",42),c.fc(1,"a",43),c.nc("click",(function(){c.Hc(e);const i=t.$implicit;return c.rc().eventInfo(i)})),c.Qc(2),c.ec(),c.ec()}if(2&e){const e=t.$implicit,i=c.rc();c.Ob(2),c.Rc(null==i.devicesIndex[e.deviceid]?null:i.devicesIndex[e.deviceid].name)}}function X(e,t){1&e&&(c.fc(0,"th",41),c.Qc(1,"Events"),c.ec())}function J(e,t){if(1&e){const e=c.gc();c.fc(0,"td",42),c.fc(1,"a",43),c.nc("click",(function(){c.Hc(e);const i=t.$implicit;return c.rc().eventInfo(i)})),c.Qc(2),c.ec(),c.ec()}if(2&e){const e=t.$implicit;c.Ob(2),c.Rc(e.type)}}function Y(e,t){1&e&&c.ac(0,"th",41)}function K(e,t){if(1&e&&(c.fc(0,"td",42),c.fc(1,"a",44),c.fc(2,"mat-icon"),c.Qc(3,"more_vert"),c.ec(),c.ec(),c.ec()),2&e){c.rc();const e=c.Fc(20);c.Ob(1),c.yc("matMenuTriggerFor",e)}}function ee(e,t){1&e&&c.ac(0,"tr",45)}function te(e,t){1&e&&c.ac(0,"tr",46)}function ie(e,t){if(1&e&&(c.fc(0,"mat-option",60),c.Qc(1),c.ec()),2&e){const e=t.$implicit;c.yc("value",e.id),c.Ob(1),c.Sc(" ",e.name," ")}}function oe(e,t){1&e&&(c.fc(0,"mat-card",61),c.ac(1,"mat-progress-spinner",62),c.ec())}function ne(e,t){1&e&&(c.fc(0,"div"),c.Qc(1," No Records Found! "),c.ec())}function ce(e,t){if(1&e){const e=c.gc();c.fc(0,"div",47),c.fc(1,"form",25),c.fc(2,"mat-form-field",48),c.fc(3,"mat-label"),c.Qc(4,"Device"),c.ec(),c.fc(5,"mat-select",49,50),c.nc("ngModelChange",(function(t){return c.Hc(e),c.rc().selected=t})),c.fc(7,"input",51),c.nc("keyup",(function(t){return c.Hc(e),c.rc().applyFilter(t.target.value)})),c.ec(),c.fc(8,"a",52),c.fc(9,"mat-icon",43),c.nc("click",(function(){return c.Hc(e),c.Fc(6).close()})),c.Qc(10,"clear"),c.ec(),c.ec(),c.Pc(11,ie,2,2,"mat-option",53),c.ec(),c.ec(),c.fc(12,"mat-form-field"),c.ac(13,"input",54),c.ac(14,"owl-date-time",null,55),c.ec(),c.fc(16,"mat-form-field"),c.ac(17,"input",56),c.ac(18,"owl-date-time",null,57),c.ec(),c.ec(),c.fc(20,"button",58),c.nc("click",(function(){return c.Hc(e),c.rc().loadHistory()})),c.Qc(21," Load History "),c.ec(),c.fc(22,"div"),c.Pc(23,oe,2,0,"mat-card",59),c.ec(),c.Pc(24,ne,2,0,"div",4),c.ec()}if(2&e){const e=c.Fc(15),t=c.Fc(19),i=c.rc();c.Ob(1),c.yc("formGroup",i.myform),c.Ob(4),c.yc("ngModel",i.selected),c.Ob(6),c.yc("ngForOf",i.devices),c.Ob(2),c.yc("owlDateTime",e)("owlDateTimeTrigger",e),c.Ob(4),c.yc("owlDateTime",t)("owlDateTimeTrigger",t),c.Ob(6),c.yc("ngIf",i.isLoading),c.Ob(1),c.yc("ngIf",""==i.historyData)}}let se=(()=>{class e{constructor(e,t,i,o,n,c,s){this.fb=e,this.deviceService=t,this.mapService=i,this.customerService=o,this.loginService=n,this.dateFormatService=c,this.cusmapService=s,this.reCheck=!1,this.singleObject=[],this.deleteObject=[],this.groupDevice=[],this.box=!0,this.DeviceItem=[],this.DeviceView=[],this.DeviceRemove=[],this.reserve=[],this.isOpen=!1,this.customerData=[],this.permission=[],this.checkPermi=[],this.allDevices=[],this.devicesIndex=[],this.deviceCheckDataIndex=[],this.dataSource=new m.k([]),this.displayedColumns=["time","device_id","event","more"],this.status=[{id:1,value:"Active"},{id:0,value:"Inactive"}],this.selected=1}ngOnInit(){this.myform=this.fb.group({id:[],from_date:[""],to_date:[""],status:[""],customer_id:[""],d:[""]}),this.getAllCustomer(),this.getAllDevice(),this.getAllEvents(),this.loginService.customerPermission.subscribe(e=>{e&&(console.log(e),this.customers=[e],console.log(e.customer_id),this.customerService.DeviceByCustomerWithPosition(e.customer_id).subscribe(t=>{console.log(t),t&&(this.permission[e.customer_id]=t,console.log(this.permission[e.customer_id]),t.forEach(e=>{this.allDevices.push(e.deviceid),console.log(this.allDevices)}))}))}),this.mapService.detailsDataCatch.subscribe(e=>{e&&(this.deviceCheckData=e,this.deviceCheckData.forEach((e,t)=>{this.deviceCheckDataIndex[e.deviceid]=this.deviceCheckData[t]}))})}getAllCustomer(){this.customerService.getAllCustomerList().subscribe(e=>{this.customers=e,this.nameDisp=e,this.customerData.push(e),this.customers.forEach(e=>{this.customerService.DeviceByCustomer(e.customer_id).subscribe(t=>{t&&(this.permission[e.customer_id]=t,this.checkPermi[e.customer_id]=t,t.forEach(e=>{this.allDevices.push(e.deviceid)}))})})})}getAllCustomerWithDevices(){this.customerService.getAllCustomerListJoinWithDevices().subscribe(e=>{this.customerjoindevices=e})}getAllDevice(){this.deviceService.getAllDevices().subscribe(e=>{this.devices=e,this.devices.forEach((e,t)=>{}),this.devices.forEach((e,t)=>{this.devicesIndex[e.id]=this.devices[t]})})}getAllEvents(){this.deviceService.getAllEvents().subscribe(e=>{this.Events=e,this.dataSource=new m.k(e)})}checkState(e){if(this.devices)return this.DeviceItem.indexOf(e)>-1}check(e,t){e?(console.log(t),this.singleObject.push(t),this.deviceService.getDeviceCurrentPositionById(t.id).subscribe(e=>{this.deviceCheckData=e,this.deviceCheckData.forEach((e,t)=>{this.deviceCheckDataIndex[e.deviceid]=this.deviceCheckData[t],console.log(this.deviceCheckDataIndex[e.deviceid].servertime)}),this.mapService.devicePosition(e)})):(this.deleteObject.push(t),this.mapService.removeData([t]))}applyFilter(e){this.dataSource.filter=e.trim().toLowerCase()}filterItem(e){console.log(e),this.customers=this.nameDisp.filter(t=>t.name.toLowerCase().indexOf(e)>-1)}applyDevices(e){this.devices=this.filterDevices.filter(t=>t.name.toLowerCase().indexOf(e)>-1)}getLocation(e){console.log(e),this.deviceService.getDeviceCurrentPositionById(e.id).subscribe(t=>{console.log(e.id),console.log(t),this.mapService.updateLocation(t),this.mapService.selectedDeviceDataExchange(t)})}objectTab(e){var t=e.index;if(2==t){this.mapService.hideWithIndexHistory({id:2});const e=new Date;var i=new Date(e.getFullYear(),e.getMonth(),e.getDate());this.myform.patchValue({from_date:i,to_date:new Date})}0!=t&&1!=t||this.mapService.showWithIndexDetails({id:1})}checkAllByGroup(e,t){console.log(t),e?this.customerService.DeviceByCustomerWithPosition(t).subscribe(e=>{e.length>0&&(console.log(e),this.mapService.devicePosition(e),e.forEach((t,i)=>{this.deviceCheckDataIndex[t.deviceid]=e[i]}),e.forEach((e,t)=>{this.groupDevice.push(e);var i=this.devices.find(t=>t.id===e.deviceid);console.log(i),this.DeviceItem.push(i.id),this.DeviceView.push(i),this.reserve.push({customer_id:e.assign_customer_id,id:e.deviceid,name:i.name})}))}):(console.log(this.reserve),this.reserve.forEach((e,i)=>{e.customer_id==t&&(this.DeviceItem=this.DeviceItem.filter(t=>t!==e.id),this.mapService.removeData([e]))}),console.log(this.DeviceRemove))}loadHistory(){this.isLoading=!0;var e=this.dateFormatService.dateTime("datetime",this.myform.value.from_date),t=this.dateFormatService.dateTime("datetime",this.myform.value.to_date);this.deviceService.getHistoryPostionBySearch({from_date:e,to_date:t}).subscribe(e=>{console.log(e),this.isLoading=!1,this.mapService.historyShow(e)})}eventInfo(e){this.deviceService.getEventPositionById(e.id).subscribe(e=>{console.log(e),this.cusmapService.eventExchange(e)})}}return e.\u0275fac=function(t){return new(t||e)(c.Zb(a.e),c.Zb(w.a),c.Zb(D),c.Zb(Q.a),c.Zb(A.a),c.Zb(S.a),c.Zb(L.a))},e.\u0275cmp=c.Tb({type:e,selectors:[["app-slide-menu"]],decls:29,vars:5,consts:[[1,"container"],[3,"selectedTabChange"],["allTabs",""],["label","Objects"],[4,"ngIf"],["label","Events"],["mat-table","","matTableExporter","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","time"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","device_id"],["matColumnDef","event"],["matColumnDef","more"],[1,"dropdown-content"],["hospital","matMenu"],["mat-menu-item","","routerLink","/"],["mat-menu-item","","routerLink","info/map"],["class","header-row","mat-header-row","",4,"matHeaderRowDef"],["class","row","mat-row","",4,"matRowDef","matRowDefColumns"],["label","History"],["class","historytab",4,"ngIf"],[1,"search-div"],[1,"filter"],["matInput","","placeholder","search","autocomplete","off",3,"checked","keyup"],[1,"btn"],[3,"formGroup"],["class","space","style","clear:both",3,"expanded",4,"ngFor","ngForOf"],[1,"space",2,"clear","both",3,"expanded"],["formControlName","customer_id",1,"group",3,"value","click","keydown","change"],[4,"ngFor","ngForOf"],[1,"item"],[1,"name",3,"checked","change","keyup"],[1,"devicename",3,"click"],[1,"b2",3,"matMenuTriggerFor"],[1,"b21"],["aria-hidden","true",1,"fa","fa-circle"],["class","b213",4,"ngIf"],["class","movingtime",4,"ngIf"],["mat-menu-item",""],[1,"b213"],[1,"movingtime"],["mat-header-cell",""],["mat-cell",""],[3,"click"],[3,"matMenuTriggerFor"],["mat-header-row","",1,"header-row"],["mat-row","",1,"row"],[1,"historytab"],[1,"half"],["formControlName","id",3,"ngModel","ngModelChange"],["sl",""],["matInput","","placeholder","search","autocomplete","off",1,"filterBox",3,"keyup"],[1,"closeButton"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","from_date","placeholder","Date Time",3,"owlDateTime","owlDateTimeTrigger"],["dt1",""],["matInput","","formControlName","to_date","placeholder","To Time",3,"owlDateTime","owlDateTimeTrigger"],["dt2",""],["mat-raised-button","","color","primary",1,"btn-block",3,"click"],["style","display:flex; justify-content: center; align-items: center",4,"ngIf"],[3,"value"],[2,"display","flex","justify-content","center","align-items","center"],["color","primary","mode","indeterminate"]],template:function(e,t){1&e&&(c.fc(0,"div",0),c.fc(1,"mat-tab-group",1,2),c.nc("selectedTabChange",(function(e){return t.objectTab(e)})),c.fc(3,"mat-tab",3),c.Pc(4,j,12,3,"div",4),c.ec(),c.fc(5,"mat-tab",5),c.fc(6,"table",6),c.dc(7,7),c.Pc(8,q,2,0,"th",8),c.Pc(9,$,4,4,"td",9),c.cc(),c.dc(10,10),c.Pc(11,V,2,0,"th",8),c.Pc(12,W,3,1,"td",9),c.cc(),c.dc(13,11),c.Pc(14,X,2,0,"th",8),c.Pc(15,J,3,1,"td",9),c.cc(),c.dc(16,12),c.Pc(17,Y,1,0,"th",8),c.Pc(18,K,4,1,"td",9),c.cc(),c.fc(19,"mat-menu",13,14),c.fc(21,"button",15),c.Qc(22,"Alert"),c.ec(),c.fc(23,"button",16),c.Qc(24," Delete "),c.ec(),c.ec(),c.Pc(25,ee,1,0,"tr",17),c.Pc(26,te,1,0,"tr",18),c.ec(),c.ec(),c.fc(27,"mat-tab",19),c.Pc(28,ce,25,9,"div",20),c.ec(),c.ec(),c.ec()),2&e&&(c.Ob(4),c.yc("ngIf",t.dataSource),c.Ob(2),c.yc("dataSource",t.dataSource),c.Ob(19),c.yc("matHeaderRowDef",t.displayedColumns),c.Ob(1),c.yc("matRowDefColumns",t.displayedColumns),c.Ob(2),c.yc("ngIf",t.devices))},directives:[F.b,F.a,o.m,m.j,m.c,m.e,m.b,T.d,T.a,n.d,m.g,m.i,v.c,y.b,a.t,a.n,a.g,E.a,o.l,E.c,E.d,s.a,a.m,a.f,T.c,g.a,m.d,m.a,m.f,m.h,v.g,H.a,a.c,z.b,z.d,z.a,_.b,U.o,b.a,G.a],pipes:[o.f,o.e],styles:[".container[_ngcontent-%COMP%]{width:100%}table[_ngcontent-%COMP%]{width:95%!important} .mat-tab-label,  .mat-tab-label-active{min-width:0!important;padding:10px!important;margin:10px!important}.filter[_ngcontent-%COMP%]{margin-left:5px!important}.btn[_ngcontent-%COMP%]{width:30px!important;background-color:#00f;margin-left:5px}.mat-header-cell[_ngcontent-%COMP%]{height:10px!important}.mat-column-select[_ngcontent-%COMP%]{width:20%!important}.mat-column-name[_ngcontent-%COMP%]{width:50%!important}.mat-column-identifier[_ngcontent-%COMP%]{width:20%!important}.mat-column-more[_ngcontent-%COMP%]{width:10%!important}a[_ngcontent-%COMP%]{cursor:pointer}mat-menu[_ngcontent-%COMP%]{margin-left:50px!important;position:absolute}.dropdown-content[_ngcontent-%COMP%]{display:none;position:absolute;background-color:#f9f9f9;min-width:160px;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);z-index:20}.cdk-overlay-container[_ngcontent-%COMP%]{position:fixed!important;z-index:3000!important}.filterBox[_ngcontent-%COMP%]{width:150px;height:25px;margin-left:10px;margin-top:5px;margin-bottom:5px;border-radius:10px 10px 10px 10px;border:2px solid #000}.closeButton[_ngcontent-%COMP%]{margin-top:20px}.space[_ngcontent-%COMP%]{margin-bottom:2px}.group[_ngcontent-%COMP%]{font-size:14px;font-weight:500}.item[_ngcontent-%COMP%]{margin-bottom:10px;margin-right:2px}.b1[_ngcontent-%COMP%]{font-size:12px;margin-left:20%}.devicename[_ngcontent-%COMP%]{margin-left:20px}.clock[_ngcontent-%COMP%]{width:70%!important}.b2[_ngcontent-%COMP%]{color:#0078a8!important}.b2[_ngcontent-%COMP%], .b21[_ngcontent-%COMP%]{float:right;flex:1 1 auto}.b21[_ngcontent-%COMP%]{width:10px;color:#ff0!important}.b213[_ngcontent-%COMP%]{float:right;flex:1 1 auto;margin-right:3px}.movingtime[_ngcontent-%COMP%]{font-size:9px}.historytab[_ngcontent-%COMP%], .movingtime[_ngcontent-%COMP%]{margin-left:10%}"]}),e})();var ae=i("zkoq");function re(e,t){1&e&&(c.fc(0,"h3",11),c.fc(1,"mat-icon"),c.Qc(2,"near_me"),c.ec(),c.Qc(3,"Name"),c.ec())}function le(e,t){if(1&e&&(c.fc(0,"h3",11),c.fc(1,"mat-icon"),c.Qc(2,"near_me"),c.ec(),c.Qc(3),c.fc(4,"span",15),c.ac(5,"i",16),c.Qc(6,"Active"),c.ec(),c.ec()),2&e){const e=c.rc();c.Ob(3),c.Sc("",e.deviceName," ")}}function he(e,t){if(1&e&&(c.fc(0,"a",17),c.fc(1,"mat-icon",18),c.Qc(2,"visibility"),c.ec(),c.ec()),2&e){const e=c.rc();c.zc("href",e.url,c.Ic)}}let me=(()=>{class e{constructor(e){this.mapService=e,this.link="http://www.google.com/maps/place/"}ngOnInit(){this.map=h.map("mapt",{center:[23.774252395907105,90.41607082790188],zoom:17,zoomControl:!1,attributionControl:!1}),h.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(this.map),this.mapService.selectedDeviceDataCatch.subscribe(e=>{if(e){var t={lat:e[0].latitude,lng:e[0].longitude};h.Control.Geocoder.nominatim().reverse(t,this.map.options.crs.scale(this.map.getZoom()),e=>{this.address=e[0].name,console.log(this.address)}),console.log(e[0]),this.url=this.link+e[0].latitude+","+e[0].longitude,this.deviceData=e[0],this.deviceName=e[0].name,this.attribute=JSON.parse(e[0].attributes),console.log(this.deviceData)}}),this.mapService.detailsDataCatch.subscribe(e=>{if(e){var t={lat:e[0].latitude,lng:e[0].longitude};h.Control.Geocoder.nominatim().reverse(t,this.map.options.crs.scale(this.map.getZoom()),e=>{this.address=e[0].name,console.log(this.address)}),console.log(e[0]),this.url=this.link+e[0].latitude+","+e[0].longitude,this.deviceData=e[0],this.attribute=JSON.parse(e[0].attributes),console.log(this.deviceData)}})}}return e.\u0275fac=function(t){return new(t||e)(c.Zb(D))},e.\u0275cmp=c.Tb({type:e,selectors:[["app-bottom-menu"]],decls:128,vars:21,consts:[["fxLayout","row",1,"container"],["id","mapt"],["fxFlex","30%"],[1,"heading"],["class","deviceName",4,"ngIf"],["cols","1","rowHeight","20px"],[1,"pos"],[1,"mag"],["target","_blank",3,"href",4,"ngIf"],[1,"vertical"],["fxFlex","70%"],[1,"deviceName"],["cols","3","rowHeight","20px"],[1,"mag2"],["fxFlex","15%"],[1,"status"],["aria-hidden","true",1,"fa","fa-circle"],["target","_blank",3,"href"],[1,"eyeicon"]],template:function(e,t){1&e&&(c.fc(0,"div",0),c.ac(1,"div",1),c.fc(2,"div",2),c.fc(3,"div",3),c.Pc(4,re,4,0,"h3",4),c.Pc(5,le,7,1,"h3",4),c.ec(),c.ac(6,"hr"),c.fc(7,"mat-grid-list",5),c.fc(8,"mat-grid-tile",6),c.fc(9,"mat-label",7),c.fc(10,"b"),c.Qc(11," Address: "),c.ec(),c.ec(),c.Qc(12),c.sc(13,"slice"),c.Pc(14,he,3,1,"a",8),c.ec(),c.fc(15,"mat-grid-tile",6),c.fc(16,"mat-label",7),c.fc(17,"b"),c.Qc(18," Time:"),c.ec(),c.ec(),c.Qc(19),c.sc(20,"date"),c.ec(),c.fc(21,"mat-grid-tile",6),c.fc(22,"mat-label",7),c.fc(23,"b"),c.Qc(24," Stop Duration:"),c.ec(),c.ec(),c.ec(),c.fc(25,"mat-grid-tile",6),c.fc(26,"mat-label",7),c.fc(27,"b"),c.Qc(28," Driver:"),c.ec(),c.ec(),c.ec(),c.ec(),c.ec(),c.ac(29,"div",9),c.fc(30,"div",10),c.fc(31,"h3",11),c.fc(32,"mat-icon"),c.Qc(33,"sensors"),c.ec(),c.Qc(34,"Sensor"),c.ec(),c.ac(35,"hr"),c.fc(36,"mat-grid-list",12),c.fc(37,"mat-grid-tile"),c.fc(38,"mat-icon"),c.Qc(39,"tag"),c.ec(),c.fc(40,"mat-label",13),c.fc(41,"b"),c.Qc(42,"Alert:"),c.ec(),c.ec(),c.Qc(43),c.ec(),c.fc(44,"mat-grid-tile"),c.fc(45,"mat-icon"),c.Qc(46,"slow_motion_video"),c.ec(),c.fc(47,"mat-label",13),c.fc(48,"b"),c.Qc(49," Motion:"),c.ec(),c.ec(),c.Qc(50),c.ec(),c.fc(51,"mat-grid-tile"),c.fc(52,"mat-icon"),c.Qc(53,"vpn_key"),c.ec(),c.fc(54,"mat-label",13),c.fc(55,"b"),c.Qc(56," Ignition:"),c.ec(),c.ec(),c.Qc(57),c.ec(),c.fc(58,"mat-grid-tile"),c.fc(59,"mat-icon"),c.Qc(60,"signal_cellular_alt"),c.ec(),c.fc(61,"mat-label",13),c.fc(62,"b"),c.Qc(63," GSM:"),c.ec(),c.ec(),c.Qc(64),c.ec(),c.fc(65,"mat-grid-tile"),c.fc(66,"mat-icon"),c.Qc(67,"battery_charging_full"),c.ec(),c.fc(68,"mat-label",13),c.fc(69,"b"),c.Qc(70," Battery Level:"),c.ec(),c.ec(),c.Qc(71),c.ec(),c.fc(72,"mat-grid-tile"),c.fc(73,"mat-icon"),c.Qc(74,"invert_colors"),c.ec(),c.fc(75,"mat-label",13),c.fc(76,"b"),c.Qc(77," Route Color:"),c.ec(),c.ec(),c.Qc(78," On "),c.ec(),c.fc(79,"mat-grid-tile"),c.fc(80,"mat-icon"),c.Qc(81,"satellite"),c.ec(),c.fc(82,"mat-label",13),c.fc(83,"b"),c.Qc(84," Satellite:"),c.ec(),c.ec(),c.Qc(85),c.ec(),c.fc(86,"mat-grid-tile"),c.fc(87,"mat-icon"),c.Qc(88,"villa"),c.ec(),c.fc(89,"mat-label",13),c.fc(90,"b"),c.Qc(91,"Doors:"),c.ec(),c.ec(),c.Qc(92," Opened "),c.ec(),c.fc(93,"mat-grid-tile"),c.fc(94,"mat-icon"),c.Qc(95,"drag_handle"),c.ec(),c.fc(96,"mat-label"),c.fc(97,"b"),c.Qc(98,"Distance:"),c.ec(),c.ec(),c.Qc(99," Opened "),c.ec(),c.fc(100,"mat-grid-tile"),c.fc(101,"mat-icon"),c.Qc(102,"moped"),c.ec(),c.fc(103,"mat-label",13),c.fc(104,"b"),c.Qc(105," Engin Hours:"),c.ec(),c.ec(),c.Qc(106),c.ec(),c.fc(107,"mat-grid-tile"),c.fc(108,"mat-icon"),c.Qc(109,"battery_saver"),c.ec(),c.fc(110,"mat-label"),c.fc(111,"b"),c.Qc(112," Battery Charging:"),c.ec(),c.ec(),c.Qc(113),c.ec(),c.fc(114,"mat-grid-tile"),c.fc(115,"mat-icon"),c.Qc(116,"speed"),c.ec(),c.fc(117,"mat-label",13),c.fc(118,"b"),c.Qc(119," Speed:"),c.ec(),c.ec(),c.Qc(120),c.ec(),c.ec(),c.ec(),c.ac(121,"div",9),c.fc(122,"div",14),c.fc(123,"h3",11),c.fc(124,"mat-icon"),c.Qc(125,"settings"),c.ec(),c.Qc(126,"Services"),c.ec(),c.ac(127,"hr"),c.ec(),c.ec()),2&e&&(c.Ob(4),c.yc("ngIf",!t.deviceData),c.Ob(1),c.yc("ngIf",t.deviceData),c.Ob(7),c.Sc(" ",(null==t.address?null:t.address.length)>20?c.vc(13,14,t.address,0,20)+"..":t.address," "),c.Ob(2),c.yc("ngIf",t.address),c.Ob(5),c.Sc(" ",c.uc(20,18,null==t.deviceData?null:t.deviceData.servertime,"medium")," "),c.Ob(24),c.Sc(" ",null==t.deviceData?null:t.deviceData.contact," "),c.Ob(7),c.Sc(" ",null==t.attribute?null:t.attribute.motion," "),c.Ob(7),c.Sc(" ",null==t.attribute?null:t.attribute.ignition," "),c.Ob(7),c.Sc(" ",null==t.deviceData?null:t.deviceData.speed," "),c.Ob(7),c.Sc(" ",null==t.attribute?null:t.attribute.batteryLevel," "),c.Ob(14),c.Sc(" ",null==t.attribute?null:t.attribute.sat," "),c.Ob(21),c.Sc(" ",null==t.deviceData?null:t.deviceData.speed," "),c.Ob(7),c.Sc(" ",null==t.deviceData?null:t.deviceData.model," "),c.Ob(7),c.Sc(" ",null==t.attribute?null:t.attribute.speed," "))},directives:[I.b,I.a,o.m,ae.a,ae.c,v.g,g.a],pipes:[o.t,o.e],styles:[".container[_ngcontent-%COMP%]{background-color:#f5f5f5;width:100%;background-color:#fff}.f[_ngcontent-%COMP%]{width:30%;float:left}.f[_ngcontent-%COMP%], .s[_ngcontent-%COMP%]{height:100%;background-color:#deb887}.s[_ngcontent-%COMP%]{width:70%!important}.vertical[_ngcontent-%COMP%]{width:3px;background-color:grey}.pos[_ngcontent-%COMP%] >   figure, mat-grid-tile[_ngcontent-%COMP%]  figure{justify-content:flex-start!important}.mag[_ngcontent-%COMP%]{margin-right:15%}.mag2[_ngcontent-%COMP%]{margin-right:5%}.eyeicon[_ngcontent-%COMP%]{margin-left:3%}.deviceName[_ngcontent-%COMP%]{text-align:left}.status[_ngcontent-%COMP%]{font-size:small;float:right}"]}),e})(),de=(()=>{class e{constructor(e){this.mapService=e}ngOnInit(){}start(){this.mapService.move({id:100})}toggle(){console.log("toggle"),this.mapService.toggleMove({id:101})}}return e.\u0275fac=function(t){return new(t||e)(c.Zb(D))},e.\u0275cmp=c.Tb({type:e,selectors:[["app-history-menu"]],decls:13,vars:0,consts:[[1,"container"],["label","Speed"],[3,"click"],["label","Altitude"],["label","GSM"],["label","Battery"],["label","Ignition"]],template:function(e,t){1&e&&(c.fc(0,"div",0),c.fc(1,"mat-tab-group"),c.fc(2,"mat-tab",1),c.fc(3,"a"),c.fc(4,"mat-icon",2),c.nc("click",(function(){return t.start()})),c.Qc(5,"play_arrow"),c.ec(),c.ec(),c.fc(6,"a"),c.fc(7,"mat-icon",2),c.nc("click",(function(){return t.toggle()})),c.Qc(8,"pause"),c.ec(),c.ec(),c.ec(),c.ac(9,"mat-tab",3),c.ac(10,"mat-tab",4),c.ac(11,"mat-tab",5),c.ac(12,"mat-tab",6),c.ec(),c.ec())},directives:[F.b,F.a,g.a],styles:[".container[_ngcontent-%COMP%]{width:100%}"]}),e})();const ue=["sidebar"],pe=["myname"],fe=["appDrawer"];function ge(e,t){if(1&e){const e=c.gc();c.fc(0,"div",22),c.fc(1,"span"),c.fc(2,"button",23),c.nc("click",(function(){return c.Hc(e),c.rc().goAdmin()})),c.Qc(3,"Admin"),c.ec(),c.ec(),c.fc(4,"a",24),c.ac(5,"img",25),c.ac(6,"span",26),c.ec(),c.ec()}if(2&e){c.rc();const e=c.Fc(25);c.Ob(4),c.yc("matMenuTriggerFor",e)}}function be(e,t){if(1&e){const e=c.gc();c.fc(0,"div",27),c.fc(1,"button",28),c.nc("click",(function(){return c.Hc(e),c.rc().goAdmin()})),c.Qc(2,"Admin"),c.ec(),c.ec()}}function ve(e,t){if(1&e&&(c.fc(0,"a",29),c.ac(1,"img",25),c.ac(2,"span",26),c.ec()),2&e){c.rc();const e=c.Fc(25);c.yc("matMenuTriggerFor",e)}}const ye=[{path:"info",component:(()=>{class e{constructor(e,t,i,o,n,c,s){this.mediaObserver=e,this.deviceService=t,this.dialog=i,this.mapService=o,this.router=n,this.dateFormatService=c,this.cusmapService=s,this.par=[],this.deviceIdArray=[],this.storeLatlng=[],this.viewHistory=0,this.timeArray=[],this.fixtimeArray=[],this.engineArray=[],this.parkArray=[],this.marker=[],this.markerArray=[],this.markerArrayIndex=[],this.nameArray=[],this.k=[],this.opened=!0,this.sideMode="over",this.dataSource=new m.k([]),this.devices=[],this.fruits=["apple","orange","cherry"]}ngOnInit(){this.mediaSub=this.mediaObserver.media$.subscribe(e=>{this.deviceXs="xs"===e.mqAlias}),this.myIcon=h.icon({iconUrl:"./assets/client/images/mm.png",iconSize:[20,40],iconAnchor:[12,39],color:"green",className:"icon"}),this.myIcon2=h.icon({iconUrl:"./assets/client/images/nn.png",iconSize:[20,40],iconAnchor:[12,39],color:"green",className:"icon"}),this.myIcon3=h.icon({iconUrl:"./assets/client/images/bike.png",iconSize:[40,80],iconAnchor:[12,69],color:"green",className:"icon"}),this.myIcon4=h.icon({iconUrl:"./assets/client/images/nn.png",iconSize:[0,0],iconAnchor:[0,0],color:"green",className:"icon"}),this.map=h.map("mapid",{center:[23.774252395907105,90.41607082790188],zoom:17,zoomControl:!1,attributionControl:!1});var e=h.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(this.map),t=h.tileLayer("http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{center:[33.590241,130.421222],maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]});e.addTo(this.map);var i=h.layerGroup().addTo(this.map);this.baseMaps={OSM:e,"Google Map":t},this.overlayMaps={Objects:i},h.control.layers(this.baseMaps,this.overlayMaps).addTo(this.map);var o=h.control.sidebar("sidebar").addTo(this.map);o.show(),h.easyButton("fa-exchange",(function(e,t){o.toggle()})).addTo(this.map);var n=h.control.bar("menu",{position:"bottom",visible:!1}).addTo(this.map);n.show(),h.easyButton("fa-exchange",(function(e,t){n.toggle()}),{position:"bottomright"}).addTo(this.map),this.historyBar=h.control.bar("history",{position:"bottom",visible:!1}).addTo(this.map);var c=[];h.layerGroup(),this.mapService.movingDataCatch.subscribe(e=>{if(this.updateData=e,e){this.check=1,this.fixtime=e[0].fixtime,e.forEach(e=>{this.deviceIdArray.includes(e.deviceid)||(this.deviceIdArray.push(e.deviceid),c[e.deviceid]=h.marker([e.latitude,e.longitude],{icon:this.myIcon3}).bindPopup(e.name+" <br> Address: "+e.contact+" <br> Model: "+e.model+" <br> Phone: "+e.phone+" <br> Type: "+e.category,{closeOnClick:!1,autoClose:!1}).addTo(this.map),i.addLayer(c[e.deviceid]))});var t=h.polyline([]).addTo(this.map);this.myInterval=setInterval(()=>{this.fixtime=this.dateFormatService.dateTime("datetime",this.fixtime);var e={id:this.deviceIdArray,fixtime:this.fixtime};console.log(this.check),1==this.check&&this.deviceService.getMovingPosition(e).subscribe(e=>{e.forEach(e=>{this.fixtime=e.fixtime,h.layerGroup(),this.markerArray=h.layerGroup(),this.marker=c[e.deviceid].setLatLng([e.latitude,e.longitude]).bindPopup(e.name+" <br> Address: "+e.contact+" <br> Model: "+e.model+" <br> Phone: "+e.phone+" <br> Type: "+e.category,{closeOnClick:!1,autoClose:!1}),e&&(this.line=t.addLatLng(h.latLng(e.latitude,e.longitude)).arrowheads({size:"10px",color:"red",frequency:"endonly"}))})})},5e3)}}),this.overlayMaps={objects:i,"Google Map":t},this.mapService.remove.subscribe(e=>{e&&(console.log(e),e.forEach(e=>{this.deviceIdArray=this.deviceIdArray.filter(t=>t!==e.id),console.log(e.id),this.map.removeLayer(c[e.id]),this.line&&this.map.removeLayer(this.line),console.log(this.deviceIdArray.length),this.deviceIdArray.length<=0&&(console.log("check"),this.check=0,clearInterval(this.myInterval))}))}),this.cusmapService.eventCatch.subscribe(e=>{if(e){var t,i={lat:e[0].latitude,lng:e[0].longitude};h.Control.Geocoder.nominatim().reverse(i,this.map.options.crs.scale(this.map.getZoom()),e=>{t=e[0].name}),h.marker([e[0].latitude,e[0].longitude],{icon:this.myIcon4}).addTo(this.map).bindPopup("<b>"+e[0].name+"</b> <br> Address: "+t+" <br> Latitude: "+e[0].latitude+" <br> Longitude: "+e[0].longitude+" <br> Altitude: "+e[0].altitude+" <br> Speed: "+e[0].speed+" <br> Time: "+e[0].eventtime,{closeOnClick:!0,autoClose:!1}).openPopup(),this.map.panTo(new h.LatLng(e[0].latitude,e[0].longitude))}}),this.mapService.s.subscribe(e=>{e&&this.map.panTo(new h.LatLng(e[0].latitude,e[0].longitude))}),this.mapService.deviesMove.subscribe(e=>{e&&(console.log("test"),console.log(e),e.forEach((e,t)=>{this.marker[e.id]=h.marker([e.latitude,e.longitude],{icon:this.myIcon}).bindPopup(e.id,{closeOnClick:!1,autoClose:!1}),this.markerArrayIndex.push(this.marker[e.id])}),console.log(this.markerArrayIndex),this.cities=h.layerGroup(this.markerArrayIndex),this.cities.addTo(this.map),this.overlayMaps={Objects:this.cities},h.control.layers(this.overlayMaps).addTo(this.map))}),this.mapService.historyData.subscribe(e=>{if(e){this.map.removeLayer(i),console.log("......"),n.hide(),this.historyBar.show(),this.viewHistory=1;var t=h.polyline([]).addTo(this.map);this.positions=e,this.storeLatlng=[],this.map.setView(new h.LatLng(this.positions[0].latitude,this.positions[0].longitude),13),this.positions.forEach((e,i)=>{let o=new Date(e.servertime),n=new Date(e.fixtime);this.timeArray.push(o),this.fixtimeArray.push(n),(this.timeArray[i]-this.fixtimeArray[i])/6e4>20&&(this.engine=h.marker([e.latitude,e.longitude],{icon:this.myIcon}).bindPopup(e.deviceid+" <br> Address: "+e.latitude+" <br> Model: "+e.longitude+" <br> Servertime: "+e.servertime+" <br> Speed: "+e.speed+" <br> Power: "+e.course,{closeOnClick:!0,autoClose:!1}).openPopup(),this.engineArray.push(this.engine),this.history=h.layerGroup(this.engineArray)),this.route=t.addLatLng(h.latLng(e.latitude,e.longitude)),this.arrow=this.route.arrowheads({size:"10px",color:"red",yawn:40,frequency:10}),this.storeLatlng.push([e.latitude,e.longitude])}),this.polylineMotion=h.motion.polyline(this.storeLatlng,{color:" "},{auto:!1,duration:3e4,easing:h.Motion.Ease.easeInOutQuart},{removeOnEnd:!1,icon:this.myIcon3}).addTo(this.map)}}),this.mapService.startDevice.subscribe(e=>{e&&this.polylineMotion.motionStart()}),this.mapService.toggleDevice.subscribe(e=>{e&&this.polylineMotion.motionToggle()}),this.mapService.indexDetailsView.subscribe(e=>{console.log(e),e&&(this.map.setView(new h.LatLng(23.774252395907105,90.41607082790188),17),this.route&&this.map.removeLayer(this.route),this.parking&&this.map.removeLayer(this.parking),this.history&&this.map.removeLayer(this.history),i&&this.map.addLayer(i),this.historyBar.hide())})}getAllPosition(){var e=h.polyline([]).addTo(this.map);this.deviceService.getAllPostion().subscribe(t=>{this.positions=t,this.positions.forEach((t,i)=>{"off"==t.power&&(this.engine=h.marker([t.latitude,t.longitude],{icon:this.myIcon}).bindPopup(t.device_id+" <br> Address: "+t.latitude+" <br> Model: "+t.longitude+" <br> Speed: "+t.speed+" <br> Power: "+t.power,{closeOnClick:!1,autoClose:!1}).openPopup(),this.engineArray.push(this.engine),this.history=h.layerGroup(this.engineArray)),this.timeArray.push(t.timestamp),this.timeArray[i]-this.timeArray[i-1]>10&&(this.park=h.marker([t.latitude,t.longitude],{icon:this.myIcon2}).bindTooltip(t.latitude),this.parkArray.push(this.park),this.parking=h.layerGroup(this.parkArray)),this.route=e.addLatLng(h.latLng(t.latitude,t.longitude)),this.arrow=this.route.arrowheads({fill:!0,frequency:5})}),console.log(this.positions),this.n={Objects:this.history},this.history.addTo(this.map),this.parking.addTo(this.map),this.a={Route:this.route,Engine:this.history,Parking:this.parking},h.control.layers(this.baseMaps,this.a).addTo(this.map)})}getAllDevice(){this.deviceService.getAllDevices().subscribe(e=>{this.devices=e,this.devices.forEach((e,t)=>{this.marker[e.unique_id]=h.marker([e.latitude,e.longitude],{icon:this.myIcon3}).bindPopup(e.name+" <br> Address: "+e.contact+" <br> Model: "+e.model+" <br> Phone: "+e.phone+" <br> Type: "+e.category,{closeOnClick:!1,autoClose:!1}).openPopup().bindTooltip(e.name,{permanent:!0}),this.markerArray.push(this.marker[e.unique_id]),this.names=this.marker[e.unique_id].openPopup()}),this.map.removeLayer(this.markerArray[0]),this.cities=h.layerGroup(this.markerArray),this.overlayMaps={Objects:this.cities},h.control.layers(this.baseMaps,this.overlayMaps).addTo(this.map)})}logout(){sessionStorage.removeItem("accessToken"),sessionStorage.removeItem("refreshToken"),localStorage.removeItem("userData"),sessionStorage.removeItem("rolesData"),this.router.navigate(["/"])}call(){console.log("cbbcbvccccccvvvvvvvvv")}openMenuModal(){this.opened=!0}Action(){}goAdmin(){console.log(this.check),this.check=0,clearInterval(this.myInterval),console.log(this.check),this.router.navigate(["/admin/dashboard"])}openChangePasswordModal(){const e=new d.d;e.disableClose=!0,e.width="600px",e.height="480px",this.dialog.open(k,{width:"580px",height:"460px"}).afterClosed().subscribe(e=>{})}openUserProfileModal(){const e=new d.d;e.disableClose=!0,e.width="600px",e.height="480px",this.dialog.open(C,{width:"580px",height:"460px"}).afterClosed().subscribe(e=>{})}}return e.\u0275fac=function(t){return new(t||e)(c.Zb(P.g),c.Zb(w.a),c.Zb(d.b),c.Zb(D),c.Zb(n.c),c.Zb(S.a),c.Zb(L.a))},e.\u0275cmp=c.Tb({type:e,selectors:[["app-user-info"]],viewQuery:function(e,t){var i;1&e&&(c.Uc(ue,!0),c.Uc(pe,!0),c.Lc(fe,!0)),2&e&&(c.Ec(i=c.oc())&&(t.dal=i.first),c.Ec(i=c.oc())&&(t.input=i.first),c.Ec(i=c.oc())&&(t.appDrawer=i.first))},decls:49,vars:4,consts:[["id","t","fxLayout","row","fxLayout.xs","column","color","primary",1,"mi"],["fxFlex","70%","fxLayout","row","fxLayout.xs","100%"],["fxFlex","80%"],["src","assets/client/images/traccar.png","width","130","alt","avatar"],["fxLayout","row","fxFlex","30%",4,"ngIf"],["class","admin_button",4,"ngIf"],["fxFlex","25%","fxLayout.xs","100%"],[1,"position"],["mat-button","",1,"menu",3,"matMenuTriggerFor"],[1,"col"],["mat-button","",1,"col"],["hospital","matMenu"],["mat-menu-item",""],["mat-button","",3,"matMenuTriggerFor",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",3,"click"],[3,"click"],["id","mapid",2,"width","100%","height","90%"],[1,"leaflet-top","leaflet-left"],["id","sidebar",2,"width","100%","height","100%"],["id","menu",2,"height","150px"],["id","history",2,"height","150px"],["fxLayout","row","fxFlex","30%"],["mat-button","",3,"click"],["id","r","mat-button","",3,"matMenuTriggerFor"],["src","assets/client/images/avatar.png","width","35","alt","avatar",1,"logout-image"],[1,"align-middle"],[1,"admin_button"],["mat-button","",1,"col",3,"click"],["mat-button","",3,"matMenuTriggerFor"]],template:function(e,t){if(1&e&&(c.fc(0,"div",0),c.fc(1,"div",1),c.fc(2,"div",2),c.ac(3,"img",3),c.ec(),c.Pc(4,ge,7,1,"div",4),c.ec(),c.Pc(5,be,3,0,"div",5),c.fc(6,"div",6),c.fc(7,"div",7),c.fc(8,"button",8),c.fc(9,"span",9),c.Qc(10,"Tools"),c.ec(),c.fc(11,"mat-icon",9),c.Qc(12,"arrow_drop_down"),c.ec(),c.ec(),c.fc(13,"button",10),c.Qc(14,"Setup"),c.ec(),c.fc(15,"button",10),c.Qc(16,"Chat"),c.ec(),c.fc(17,"mat-menu",null,11),c.fc(19,"button",12),c.Qc(20,"Alerts"),c.ec(),c.fc(21,"button",12),c.Qc(22," Routes "),c.ec(),c.ec(),c.Pc(23,ve,3,1,"a",13),c.fc(24,"mat-menu",null,14),c.fc(26,"a",15),c.nc("click",(function(){return t.openUserProfileModal()})),c.fc(27,"mat-icon"),c.Qc(28,"account_circle"),c.ec(),c.fc(29,"span"),c.Qc(30,"Profile"),c.ec(),c.ec(),c.fc(31,"a",15),c.nc("click",(function(){return t.openChangePasswordModal()})),c.fc(32,"mat-icon"),c.Qc(33,"settings"),c.ec(),c.fc(34,"span"),c.Qc(35,"Change Pass "),c.ec(),c.ec(),c.fc(36,"a",12),c.fc(37,"mat-icon"),c.Qc(38,"exit_to_app"),c.ec(),c.fc(39,"span",16),c.nc("click",(function(){return t.logout()})),c.Qc(40,"Logout"),c.ec(),c.ec(),c.ec(),c.ec(),c.ec(),c.ec(),c.fc(41,"div",17),c.ac(42,"div",18),c.ec(),c.fc(43,"div",19),c.ac(44,"app-slide-menu"),c.ec(),c.fc(45,"div",20),c.ac(46,"app-bottom-menu"),c.ec(),c.fc(47,"div",21),c.ac(48,"app-history-menu"),c.ec()),2&e){const e=c.Fc(18);c.Ob(4),c.yc("ngIf",t.deviceXs),c.Ob(1),c.yc("ngIf",!t.deviceXs),c.Ob(3),c.yc("matMenuTriggerFor",e),c.Ob(15),c.yc("ngIf",!t.deviceXs)}},directives:[I.b,I.a,o.m,_.b,T.c,g.a,T.d,T.a,se,me,de,_.a],styles:["h2[_ngcontent-%COMP%]{margin-top:3%}.mi[_ngcontent-%COMP%]{width:100%!important;background-color:#3f51b5;float:left}.space[_ngcontent-%COMP%]{flex:1 1 auto}.col[_ngcontent-%COMP%], .colm[_ngcontent-%COMP%]{color:#fff}.colm[_ngcontent-%COMP%]{margin-left:2%}.map[_ngcontent-%COMP%]{width:100%}a[_ngcontent-%COMP%]{cursor:pointer}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:25px 30px!important}.tab[_ngcontent-%COMP%]{overflow:hidden;border:1px solid #ccc;background-color:#e63e3e}.tab[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:inherit;float:left;border:none;outline:none;cursor:pointer;padding:14px 16px;transition:.3s}.tab[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#ddd}.tab[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#ccc}#bottommenu[_ngcontent-%COMP%]{width:900px!important}.easy-button-button.disabled[_ngcontent-%COMP%]{display:none}.position[_ngcontent-%COMP%]{float:right;margin-top:2%;margin-left:10%}.admin_button[_ngcontent-%COMP%]{margin-top:.5%}"]}),e})()},{path:"test",component:l}];let _e=(()=>{class e{}return e.\u0275mod=c.Xb({type:e}),e.\u0275inj=c.Wb({factory:function(t){return new(t||e)},imports:[[n.f.forChild(ye)],n.f]}),e})();var xe=i("jAig"),Oe=i("YUcS"),ke=i("kDqm"),Ce=i("xoCY");let Pe=(()=>{class e{}return e.\u0275mod=c.Xb({type:e}),e.\u0275inj=c.Wb({factory:function(t){return new(t||e)},imports:[[o.c,_e,xe.a,Oe.a,ke.DriverModule,Ce.a,Ce.b,a.q,a.i]]}),e})()},"am+x":function(e,t){L.Motion=L.Motion||{Event:{Started:"motion-started",Paused:"motion-paused",Resumed:"motion-resumed",Section:"motion-section",Ended:"motion-ended"}},L.motion=L.motion||{},L.Motion.Animate={options:{pane:"polymotionPane",attribution:"Leaflet.Motion \xa9 "+(new Date).getFullYear()+" Igor Vladyka"},motionOptions:{auto:!1,easing:function(e){return e},speed:0,duration:0},markerOptions:void 0,initialize:function(e,t,i,o){L.Util.setOptions(this,t),this.motionOptions=L.Util.extend({},this.motionOptions,i||{}),this.markerOptions=L.Util.extend({},o||{}),this._bounds=L.latLngBounds(),this._linePoints=this._convertLatLngs(e),L.Motion.Utils.isFlat(this._linePoints)||(this._linePoints=this._linePoints[0]),this._initializeMarker(),this._latlngs=[],L.Util.stamp(this)},addLatLng:function(e,t){return e=L.Motion.Utils.toLatLng(e),this._linePoints.push(e),this._latlngs.length&&this._latlngs.push(e),this},beforeAdd:function(e){e.getPane(this.options.pane)||(e.createPane(this.options.pane).style.zIndex=599),this._renderer=e.getRenderer(this)},onAdd:function(e){if(this._renderer._initPath(this),this._reset(),this._renderer._addPath(this),this.__marker&&this.markerOptions.showMarker&&this.__marker.addTo(e),this.__marker._icon&&this.__marker._icon.children.length){var t=this.__marker._icon.children[0].getAttribute("motion-base");t&&(this.__marker._icon.children[0].style.transform="rotate("+t+"deg)")}return this.motionOptions.auto&&this.motionStart(),this},onRemove:function(e){this.motionStop(),this.__marker&&e.removeLayer(this.__marker),this._renderer._removePath(this)},_motion:function(e){var t=(new Date).getTime()-e,i=1;if(this.motionOptions.duration&&(i=t/this.motionOptions.duration),i<1){i=this.motionOptions.easing(i,t,0,1,this.motionOptions.duration);var o=L.Motion.Utils.interpolateOnLine(this._map,this._linePoints,i);L.Polyline.prototype.addLatLng.call(this,o.latLng),this._drawMarker(o.latLng),this.__ellapsedTime=t,this.animation=L.Util.requestAnimFrame((function(){this._motion(e)}),this)}else this.motionStop(!0)},_drawMarker:function(e){var t=this.getMarker();if(t){var i=t.getLatLng(),o=this._linePoints[0];if(i.lat===o.lat&&i.lng===o.lng)t.addTo(this._map),t.addEventParent(this);else if(t._icon&&t._icon.children.length){var n=t._icon.children[0].getAttribute("motion-base");if(n){var c=0;n&&!isNaN(+n)&&(c=+n),t._icon.children[0].style.transform="rotate(-"+Math.round(L.Motion.Utils.getAngle(i,e)+c)+"deg)"}}t.setLatLng(e)}},_removeMarker:function(e){this.markerOptions&&this.__marker&&(e&&!this.markerOptions.removeOnEnd||this._map.removeLayer(this.__marker))},_initializeMarker:function(){this.markerOptions&&(this.__marker=L.marker(this._linePoints[0],this.markerOptions))},motionStart:function(){return this._map&&!this.animation&&(this.motionOptions.duration||(this.motionOptions.duration=this.motionOptions.speed?L.Motion.Utils.getDuration(this._map,this._linePoints,this.motionOptions.speed):0),this.setLatLngs([]),this._motion((new Date).getTime()),this.fire(L.Motion.Event.Started,{layer:this},!1)),this},motionStop:function(e){return this.motionPause(),this.setLatLngs(this._linePoints),this.__ellapsedTime=null,this._removeMarker(e),this.fire(L.Motion.Event.Ended,{layer:this},!1),this},motionPause:function(){return this.animation&&(L.Util.cancelAnimFrame(this.animation),this.animation=null,this.fire(L.Motion.Event.Paused,{layer:this},!1)),this},motionResume:function(){return!this.animation&&this.__ellapsedTime&&(this.motionOptions.duration||(this.motionOptions.duration=this.motionOptions.speed?L.Motion.Utils.getDuration(this._map,this._linePoints,this.motionOptions.speed):0),this._motion((new Date).getTime()-this.__ellapsedTime),this.fire(L.Motion.Event.Resumed,{layer:this},!1)),this},motionToggle:function(){return this.animation?this.__ellapsedTime&&this.motionPause():this.__ellapsedTime?this.motionResume():this.motionStart(),this},motionDuration:function(e){var t=this.motionSpeed.duration;return this.motionOptions.duration=e||0,this.animation&&t&&(this.motionPause(),this.__ellapsedTime=this.__ellapsedTime*(t/e),this.motionOptions.duration=e,this.motionResume()),this},motionSpeed:function(e){var t=this.motionOptions.speed;return this.motionOptions.speed=e||0,this.animation&&t&&(this.motionPause(),this.__ellapsedTime=this.__ellapsedTime*(t/e),this.motionOptions.duration=L.Motion.Utils.getDuration(this._map,this._linePoints,this.motionOptions.speed),this.motionResume()),this},getMarker:function(){return this.__marker},getMarkers:function(){return[this.getMarker()]}}},"iR4+":function(e,t){L.Control.SlideMenu=L.Control.extend({options:{position:"topleft",menuposition:"topleft",width:"300px",height:"100%",direction:"horizontal",changeperc:"10",delay:"10",icon:"fa-bars",hidden:!1},initialize:function(e,t){L.Util.setOptions(this,t),this._innerHTML=e,this._isLeftPosition="topleft"==this.options.menuposition||"bottomleft"==this.options.menuposition,this._isTopPosition="topleft"==this.options.menuposition||"topright"==this.options.menuposition,this._isHorizontal="horizontal"==this.options.direction},onAdd:function(e){this._container=L.DomUtil.create("div","leaflet-control-slidemenu leaflet-bar leaflet-control");var t=L.DomUtil.create("a","leaflet-bar-part leaflet-bar-part-single",this._container);if(t.title="Menu",L.DomUtil.create("span","fa "+this.options.icon,t),this._menu=L.DomUtil.create("div","leaflet-menu",e._container),this._menu.style.width=this.options.width,this._menu.style.height=this.options.height,this._isHorizontal){var i=-parseInt(this.options.width,10);this._isLeftPosition?this._menu.style.left="-"+this.options.width:this._menu.style.right="-"+this.options.width,this._isTopPosition?this._menu.style.top="0px":this._menu.style.bottom="0px"}else i=-parseInt(this.options.height,10),this._isLeftPosition?this._menu.style.left="0px":this._menu.style.right="0px",this._isTopPosition?this._menu.style.top="-"+this.options.height:this._menu.style.bottom="-"+this.options.height;var o=L.DomUtil.create("button","leaflet-menu-close-button fa",this._menu);if(this._isHorizontal?this._isLeftPosition?(o.style.float="right",L.DomUtil.addClass(o,"fa-chevron-left")):(o.style.float="left",L.DomUtil.addClass(o,"fa-chevron-right")):this._isTopPosition?(o.style.float="right",L.DomUtil.addClass(o,"fa-chevron-up")):(o.style.float="right",L.DomUtil.addClass(o,"fa-chevron-down")),this._contents=L.DomUtil.create("div","leaflet-menu-contents",this._menu),this._contents.innerHTML=this._innerHTML,this._contents.style.clear="both",this._isHorizontal)var n="x"==this.options.width.slice(-1),c=parseInt(this.options.width,10)*parseInt(this.options.changeperc,10)/100;else n="x"==this.options.height.slice(-1),c=parseInt(this.options.height,10)*parseInt(this.options.changeperc,10)/100;return L.DomEvent.disableClickPropagation(this._menu),L.DomEvent.on(t,"click",L.DomEvent.stopPropagation).on(t,"click",(function(){this._animate(this._menu,i,0,!0,n,c)}),this).on(o,"click",L.DomEvent.stopPropagation).on(o,"click",(function(){this._animate(this._menu,0,i,!1,n,c)}),this),L.DomEvent.on(this._menu,"mouseover",(function(){e.scrollWheelZoom.disable()})),L.DomEvent.on(this._menu,"mouseout",(function(){e.scrollWheelZoom.enable()})),this.options.hidden&&this.hide(),this._container},onRemove:function(e){e._container.removeChild(this._menu),delete this._menu},setContents:function(e){this._innerHTML=e,this._contents.innerHTML=this._innerHTML},_animate:function(e,t,i,o,n,c){this._isHorizontal?this._isLeftPosition?e.style.left=t+(n?"px":"%"):e.style.right=t+(n?"px":"%"):this._isTopPosition?e.style.top=t+(n?"px":"%"):e.style.bottom=t+(n?"px":"%"),t!=i&&setTimeout((function(e){e._animate(e._menu,o?t+c:t-c,i,o,n,c)}),parseInt(this.options.delay),this)},hide:function(){this._container.style.display="none"},show:function(){this._container.style.display="inherit"}}),L.control.slideMenu=function(e,t){return new L.Control.SlideMenu(e,t)}}}]);